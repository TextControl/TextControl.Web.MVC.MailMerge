var TXTextControl=(function(c,a){var b=c._private=c._private||{};
b.BrowserDetect={init:function(){this.browser=this.searchString(this.dataBrowser)||"Other";
this.version=this.searchVersion(navigator.userAgent)||this.searchVersion(navigator.appVersion)||"Unknown";
},searchString:function(d){for(var f=0;
f<d.length;
f++){var e=d[f].string;
this.versionSearchString=d[f].subString;
if(e.indexOf(d[f].subString)!=-1){return d[f].identity;
}}},searchVersion:function(d){var e=d.indexOf(this.versionSearchString);
if(e==-1){return;
}return parseFloat(d.substring(e+this.versionSearchString.length+1));
},dataBrowser:[{string:navigator.userAgent,subString:"Edge",identity:"Edge"},{string:navigator.userAgent,subString:"Chrome",identity:"Chrome"},{string:navigator.userAgent,subString:"MSIE",identity:"Explorer"},{string:navigator.userAgent,subString:"Firefox",identity:"Firefox"},{string:navigator.userAgent,subString:"Safari",identity:"Safari"},{string:navigator.userAgent,subString:"Opera",identity:"Opera"}]};
b.BrowserDetect.init();
return c;
}(TXTextControl||{},j$1_10_2));
var TXTextControl=(function(e,a){var b=e._private=e._private||{};
b.UpdateUIFlag={CanCopy:1,CanPaste:2,CanUndo:4,CanRedo:8,ControlChars:16,Header:32,Footer:64,TableGridLines:128,DocumentTargetMarkers:256,DrawingMarkerLines:512};
b.NumberFormat={None:0,ArabicNumbers:3,Letters:4,CapitalLetters:5,RomanNumbers:6,SmallRomanNumbers:7};
b.FontUnderlineStyle={DoubledWordsOnly:4288,Doubled:4672,SingleWordsOnly:16528,Single:16912,None:20992};
b.InputFormatProperty={AllFrameLines:0,Bold:1,BottomDistance:2,BottomFrameLine:3,BoxFrame:4,BulletCharacter:5,BulletedList:6,Centered:7,FontFamily:8,FontSize:9,HangingIndent:10,InnerHorizontalFrameLines:11,InnerVerticalFrameLines:12,Italic:13,Justified:14,LeftAligned:15,LeftFrameLine:16,LeftIndent:17,LineSpacing:18,NumberedList:19,NumberedListFormat:20,NumberFormats:21,RightAligned:22,RightFrameLine:23,RightIndent:24,LeftToRight:25,RightToLeft:26,Strikeout:27,StructuredList:28,StructuredListFormat:29,StyleName:30,StyleNames:31,Subscript:32,Superscript:33,TextBackColor:34,TextColor:35,TopDistance:36,TopFrameLine:37,Underline:38,UnderlineStyle:39,UnderlineStyles:40};
b.BreakType={NextLine:0,Column:1,Page:2,SectionNextPage:3,SectionContinuous:4};
b.ItemType={HypertextLink:0,DocumentLink:1,TextFrame:2,DocumentTarget:3,Link:4,PageNumber:5,FieldAdapter:6,ApplicationField:7,Chart:8,Barcode:9,Frame:10,MergeBlock:11,HeaderFooter:12,ImagePlaceholder:13,TextField:14,Shape:15,DrawingCanvas:16,};
b.HeaderFooterType={Header:1,FirstPageHeader:2,Footer:4,FirstPageFooter:8,EvenHeader:128,EvenFooter:32768,All:32911};
b.VerticalAlignment={Top:0,Center:1,Bottom:2};
b.HorizontalAlignment={Left:1,Right:2,Center:3,Justify:4};
b.TableAddPosition={Before:1,After:2};
b.inputPositionChangedHandler=function(f){var g=f.detail;
if(g.IsInTable&&(b.appMode==b.ApplicationMode.Normal)){a("#tabTableLayout").show();
b.processTableInfo(g.Table);
}else{if(a("#tabTableLayout").is(":visible")){a("#tabTableLayout").hide();
if(a("#"+a("#tabTableLayout").attr("rel")).is(":visible")){b.switchTabs(a("#tabDefault"));
}}}if(g.FrameSelected&&!g.DrawingActivated&&(b.appMode==b.ApplicationMode.Normal)){a("#tabObjectFormat").show();
b.processFrameInfo(g.Frame);
}else{if(a("#tabObjectFormat").is(":visible")){a("#tabObjectFormat").hide();
if(a("#"+a("#tabObjectFormat").attr("rel")).is(":visible")){b.switchTabs(a("#tabDefault"));
}}}if((g.DrawingSelected||g.DrawingActivated)&&(b.appMode==b.ApplicationMode.Normal)){a("#tabShapeFormat").show();
}else{if(a("#tabShapeFormat").is(":visible")){a("#tabShapeFormat").hide();
if(a("#"+a("#tabShapeFormat").attr("rel")).is(":visible")){b.switchTabs(a("#tabDefault"));
}}}};
b.uiFlagsUpdatedHandler=function(g){var h=g.detail;
if(h&b.UpdateUIFlag.CanCopy){a("#btnCut").removeClass("ui-state-disabled");
a("#btnCopy").removeClass("ui-state-disabled");
}else{a("#btnCut").addClass("ui-state-disabled");
a("#btnCopy").addClass("ui-state-disabled");
}if(h&b.UpdateUIFlag.CanPaste){a("#mnuItemServerPaste").removeClass("ui-state-disabled");
}else{a("#mnuItemServerPaste").addClass("ui-state-disabled");
}if(h&b.UpdateUIFlag.CanUndo){a("#btnUndo").removeClass("ui-state-disabled");
}else{a("#btnUndo").addClass("ui-state-disabled");
}if(h&b.UpdateUIFlag.CanRedo){a("#btnRedo").removeClass("ui-state-disabled");
}else{a("#btnRedo").addClass("ui-state-disabled");
}if(h&b.UpdateUIFlag.ControlChars){a("#tglBtnControlChars").addClass("ribbon-button-selected");
}else{a("#tglBtnControlChars").removeClass("ribbon-button-selected");
}if(h&b.UpdateUIFlag.Header){a("#mnuItemRemoveHeader").removeClass("ui-state-disabled");
}else{a("#mnuItemRemoveHeader").addClass("ui-state-disabled");
}if(h&b.UpdateUIFlag.Footer){a("#mnuItemRemoveFooter").removeClass("ui-state-disabled");
}else{a("#mnuItemRemoveFooter").addClass("ui-state-disabled");
}if(h&b.UpdateUIFlag.TableGridLines){a("#tglBtnViewGridLines").addClass("ribbon-button-selected");
}else{a("#tglBtnViewGridLines").removeClass("ribbon-button-selected");
}if(h&b.UpdateUIFlag.DocumentTargetMarkers){a("#tglBtnShowBookmarkMarkers").addClass("ribbon-button-selected");
}else{a("#tglBtnShowBookmarkMarkers").removeClass("ribbon-button-selected");
}var f=document.querySelector("#mnuItmDrawingMarkerLines div.small-menu-item-image-wrapper");
if(f){if(h&b.UpdateUIFlag.DrawingMarkerLines){f.classList.add("ribbon-button-selected");
}else{f.classList.remove("ribbon-button-selected");
}}};
function d(){var g="";
var f=(typeof TXSettings!=="undefined")&&TXSettings.IsMVC;
var j=document.getElementById("txPrintFrame");
if(j){document.body.removeChild(j);
}var i=b.isSSLConnection?"https://":"http://";
if(f){g=TXSettings.ConnectionID;
}else{if((typeof TXWebResources!=="undefined")&&TXWebResources.hasOwnProperty("connectionID")){g=TXWebResources.connectionID;
}}if(!g){return;
}var h=f?i+b.getWebAppRootDir()+TXSettings.ApiRoute+"TXPrint":i+b.getWebAppRootDir()+"TXPrintHandler.ashx";
var k=h+"?connectionID="+g;
j=document.createElement("IFRAME");
j.id="txPrintFrame";
j.frameBorder=0;
j.src=k;
document.body.appendChild(j);
}b.print=function(){var f=((b.BrowserDetect.browser==="Explorer")||(b.BrowserDetect.browser==="Other")||(b.BrowserDetect.browser==="Edge"));
if(f){d();
}else{b.sendCommand(b.Command.PrintToPDF,1);
}};
b.printResultReceivedHandler=function(f){var g=f.detail;
if((b.BrowserDetect.browser==="Explorer")||(b.BrowserDetect.browser==="Other")||(b.BrowserDetect.browser==="Edge")){return;
}var h=document.getElementById("txPrintFrame");
if(h){document.body.removeChild(h);
}h=document.createElement("IFRAME");
h.id="txPrintFrame";
h.frameBorder=0;
h.src="data:application/pdf;base64,"+g.documentData;
document.body.appendChild(h);
};
b.hyperlinkClickedHandler=function(f){var g=f.detail;
var h=window.open(g,"_blank");
h.focus();
};
function c(f,m,q){m=m||"";
q=q||512;
var k=atob(f);
var j=[];
for(var o=0;
o<k.length;
o+=q){var p=k.slice(o,o+q);
var l=new Array(p.length);
for(var n=0;
n<p.length;
n++){l[n]=p.charCodeAt(n);
}var h=new Uint8Array(l);
j.push(h);
}var g=new Blob(j,{type:m});
return g;
}return e;
}(TXTextControl||{},j$1_10_2));
var TXTextControl=(function(c,a){var b=c._private=c._private||{};
b.Caret=(function(){function d(e){this.canvas=e;
this.location={X:0,Y:0};
this.size={width:0,height:0};
this.isBlack=false;
this.blinkTimer=null;
this.isVisible=false;
this.divCaret=null;
this.divCaret=document.createElement("div");
this.divCaret.classList.add("caret");
this.divCaret.style.left="1px";
this.divCaret.style.top="1px";
this.canvas.parentNode.appendChild(this.divCaret);
}Object.defineProperty(d.prototype,"bounds",{get:function(){var e={x:this.location.X,y:this.location.Y,width:this.size.width,height:this.size.height};
return e;
},enumerable:true,configurable:true});
d.prototype.setState=function(g){var f=this.isVisible;
this.hide();
var e=Math.max(1,g.Size.Height);
var h=Math.max(1,g.Size.Width);
this.setSize(h,e);
this.setLocation(g.Location);
f=g.Visibility;
if(f){this.show();
}};
d.prototype.blink=function(){if(this.isBlack){this.setOpacity(0);
this.isBlack=false;
}else{this.setOpacity(1);
this.isBlack=true;
}};
d.prototype.show=function(){this.isVisible=true;
this.setOpacity(1);
this.isBlack=true;
clearInterval(this.blinkTimer);
this.blinkTimer=setInterval(this.blink.bind(this),500);
};
d.prototype.hide=function(){if(!this.isVisible){return;
}this.isVisible=false;
clearInterval(this.blinkTimer);
if(this.isBlack){this.setOpacity(0);
this.isBlack=false;
}};
d.prototype.setOpacity=function(e){if(!b.ViewersInvisible){this.divCaret.style.opacity=""+e;
}};
d.prototype.setLocation=function(f){this.location=cloneObject(f);
var e=this.canvas.offsetLeft+f.X;
var g=this.canvas.offsetTop+f.Y;
this.divCaret.style.left=e+"px";
this.divCaret.style.top=g+"px";
};
d.prototype.refreshLocation=function(){this.setLocation(this.location);
};
d.prototype.setSize=function(f,e){this.size.width=f;
this.size.height=e;
this.divCaret.style.width=f+"px";
this.divCaret.style.height=e+"px";
};
d.prototype.isVisible=function(){return this.isVisible;
};
return d;
})();
return c;
}(TXTextControl||{},j$1_10_2));
var TXTextControl=(function(c,a){var b=c._private=c._private||{};
b.ActivationState={Activated:1,Deactivated:2,Disabled:3};
b.HiddenTextField=(function(){var d=-9999;
var e=-1000;
function f(g,h,i){this.canvas=g;
this.componentType=h;
this.owner=i;
this.location={X:0,Y:0};
this.elemInput=null;
this.elemInput=document.createElement("input");
this.elemInput.classList.add("txHiddenTextField");
this.elemInput.setAttribute("autocomplete","off");
this.elemInput.setAttribute("autocorrect","off");
this.elemInput.tabIndex="-1";
var j=this.elemInput.style;
j.position="absolute";
j.left=d+"px";
j.width="10px";
j.height="10px";
j.opacity="0";
j.zIndex=e;
j.pointerEvents="none";
j.margin="0px";
j.border="none";
j.padding="0px";
j.overflow="hidden";
j.color="transparent";
this.elemInput.addEventListener("keypress",b.keyPressHandler);
this.elemInput.addEventListener("keydown",b.keyDownHandler);
this.elemInput.addEventListener("keyup",b.keyUpHandler);
this.elemInput.addEventListener("compositionstart",this.compositionstartHandler.bind(this));
this.elemInput.addEventListener("compositionend",this.compositionendHandler.bind(this));
this.elemInput.addEventListener("blur",this.elemInput_Blur.bind(this));
this.canvas.parentNode.appendChild(this.elemInput);
}Object.defineProperty(f.prototype,"top",{set:function(g){this.elemInput.style.top=g+"px";
},enumerable:true,configurable:true});
Object.defineProperty(f.prototype,"left",{set:function(g){this.elemInput.style.left=g+"px";
},enumerable:true,configurable:true});
f.prototype.compositionstartHandler=function(i){b.inIMEComposition=true;
var j=this.elemInput;
var g=this.owner.caretBounds;
var h=this.owner.canvas;
j.style.left=g.x+h.offsetLeft+"px";
j.style.top=g.y+h.offsetTop+g.height+"px";
j.style.zIndex=1000;
};
f.prototype.compositionendHandler=function(g){b.inIMEComposition=false;
var j=this.elemInput;
j.style.left=d+"px";
for(var h=0;
h<g.data.length;
++h){b.sendCommand(b.Command.ComponentEvent,b.UserInputEventType.KeyPress,0,0,{key:g.data[h],modifierKeys:0});
}};
f.prototype.focus=function(){if(document.activeElement!=this.elemInput){this.elemInput.focus();
}};
f.prototype.blur=function(){if(document.activeElement==this.elemInput){this.elemInput.blur();
}};
f.prototype.elemInput_Blur=function(g){b.sendCommand(b.Command.ComponentActivationState,this.componentType,b.ActivationState.Deactivated);
};
f.prototype.update=function(h,g){if(h!=null){this.elemInput.value=h;
}if(this.elemInput.selectionStart!=g){this.elemInput.setSelectionRange(g,g);
}};
return f;
})();
return c;
}(TXTextControl||{},j$1_10_2));
var TXTextControl=(function(f,a){var b=f._private=f._private||{};
b.modifierKeys=0;
var d={Shift:4,Ctrl:8,Alt:2048,Mask:2060};
b.KeyCode={Backspace:a.ui.keyCode.BACKSPACE,TAB:a.ui.keyCode.TAB,Enter:a.ui.keyCode.ENTER,Shift:16,Control:17,Alt:18,LeftArrow:a.ui.keyCode.LEFT,UpArrow:a.ui.keyCode.UP,RightArrow:a.ui.keyCode.RIGHT,DownArrow:a.ui.keyCode.DOWN,DEL:a.ui.keyCode.DELETE,INS:45,END:a.ui.keyCode.END,HOME:a.ui.keyCode.HOME,PageUp:a.ui.keyCode.PAGE_UP,PageDown:a.ui.keyCode.PAGE_DOWN,Space:a.ui.keyCode.SPACE};
function c(g){var h=0;
if(g.shiftKey){h|=d.Shift;
}if(g.altKey){h|=d.Alt;
}if(g.ctrlKey){h|=d.Ctrl;
}return h;
}function e(h,i){b.modifierKeys=c(h);
var j=h.keyCode||h.which||0;
switch(j){case 171:j=187;
break;
case 173:j=189;
break;
}var g={key:j,modifierKeys:b.modifierKeys};
b.sendCommand(b.Command.ComponentEvent,i,0,0,g);
switch(j){case b.KeyCode.Enter:case b.KeyCode.Backspace:case b.KeyCode.TAB:case b.KeyCode.DEL:case b.KeyCode.END:case b.KeyCode.HOME:case b.KeyCode.LeftArrow:case b.KeyCode.UpArrow:case b.KeyCode.RightArrow:case b.KeyCode.DownArrow:case b.KeyCode.PageUp:case b.KeyCode.PageDown:h.preventDefault();
break;
}}b.keyDownHandler=function(h){b.modifierKeys=c(h);
var i=h.keyCode||h.which||0;
if(b.modifierKeys&d.Ctrl){switch(i){case 43:case 45:case 107:case 109:case 171:case 173:case 187:case 189:h.preventDefault();
break;
}}if(((b.modifierKeys&d.Mask)==(d.Ctrl|d.Shift)&&(i==86))){var g=new b.ClientPasteDialog();
g.showModal();
h.preventDefault();
return;
}else{if((((b.modifierKeys&d.Mask)==d.Ctrl)&&(i==86))||((b.modifierKeys&d.Shift)&&(i==b.KeyCode.INS))){h.preventDefault();
}}e(h,b.UserInputEventType.KeyDown);
};
b.keyUpHandler=function(g){e(g,b.UserInputEventType.KeyUp);
};
b.keyPressHandler=function(g){if((typeof g.charCode!=="undefined")&&(g.charCode===0)){return;
}b.modifierKeys=c(g);
var h=g.charCode||g.keyCode||g.which||0;
if(h){b.sendCommand(b.Command.ComponentEvent,b.UserInputEventType.KeyPress,0,0,{key:h,modifierKeys:b.modifierKeys});
}else{g.preventDefault();
}};
return f;
}(TXTextControl||{},j$1_10_2));
var TXTextControl=(function(j,a){var b=j._private=j._private||{};
b.ComponentType={TextView:0,HorRuler:1,VertRuler:2,StatusBar:3,TxDialog:4};
b.UserInputEventType={KeyDown:0,KeyPress:1,KeyUp:2,MouseMove:3,MouseDown:4,MouseUp:5,MouseDoubleClick:6,MouseWheel:7};
var g={Left:1,Right:2,Middle:16};
var d={IBeam:1,ArrowNE:2,VSplit:3,UpArrow:4,Arrow:5,DownArrow:6,SizeWE:7,SizeNS:8,SizeNWSE:9,SizeNESW:10,SizeAll:11,Cross:12};
var h={MoveAndSizeFrame:1,TableBorderMovingLine:2};
function c(k){return{clientX:k.clientX,clientY:k.clientY,screenX:k.screenX,screenY:k.screenY,identifier:k.identifier,hasLeftDeadzone:k.hasLeftDeadzone};
}var f={touches:{},getItem:function(k){return this.touches["_"+k];
},add:function(l){var k=l.identifier;
this.touches["_"+k]=c(l);
},removeItem:function(k){var l=this.getItem(k);
delete this.touches["_"+k];
return l;
},update:function(l){for(var k=0;
k<l.length;
++k){this.add(l[k]);
}},count:function(){var l=0,k;
for(k in this.touches){if(this.touches.hasOwnProperty(k)){++l;
}}return l;
},clear:function(){this.touches={};
}};
var i=(function(){var l=250,k=500,n=500;
r.State={Initial:0,OneFinger:1,NoFingerAfterOneFinger:2,ImpendingDoubleClickOrObjectGrip:3,ObjectGrip:4};
r.TouchEventType={Start:0,Move:1,End:2};
function r(s){this.state=r.State.Initial;
this.viewer=s;
this.targetElem=s.canvas;
this.touch=null;
this.timeoutID=null;
}function p(w,u,s,v){var t=document.createEvent("MouseEvents");
t.initMouseEvent(u,true,true,window,1,w.screenX,w.screenY,w.clientX,w.clientY,false,false,false,false,s,null);
v.dispatchEvent(t);
}r.prototype.simulateMouseClick=function(t,s){p(t,"mouseover",s,this.targetElem);
p(t,"mousemove",s,this.targetElem);
p(t,"mousedown",s,this.targetElem);
p(t,"mouseup",s,this.targetElem);
p(t,"mousemove",s,this.targetElem);
p(t,"mouseout",s,this.targetElem);
p(t,"click",s,this.targetElem);
};
r.prototype.simulateMouseDoubleClick=function(t,s){p(t,"mouseover",s,this.targetElem);
p(t,"mousemove",s,this.targetElem);
p(t,"mousedown",s,this.targetElem);
p(t,"mouseup",s,this.targetElem);
p(t,"click",s,this.targetElem);
p(t,"mousedown",s,this.targetElem);
p(t,"mouseup",s,this.targetElem);
p(t,"mousemove",s,this.targetElem);
p(t,"mouseout",s,this.targetElem);
p(t,"click",s,this.targetElem);
p(t,"dblclick",s,this.targetElem);
};
r.prototype.reset=function(){if(this.timeoutID){clearTimeout(this.timeoutID);
this.timeoutID=null;
}if(this.touch){p(this.touch,"mouseup",0,this.targetElem);
p(this.touch,"mousemove",0,this.targetElem);
p(this.touch,"mouseout",0,this.targetElem);
this.touch=null;
}this.state=r.State.Initial;
};
function o(){b.ignoreNextTextFocusRequest=true;
this.simulateMouseClick(this.touch,2);
this.timeoutID=this.touch=null;
this.state=r.State.Initial;
}r.prototype.initialState=function(t,s){switch(s){case r.TouchEventType.Start:this.timeoutID=setTimeout(o.bind(this),k);
this.touch=c(t);
this.state=r.State.OneFinger;
break;
default:this.reset();
}};
function m(){this.simulateMouseClick(this.touch,0);
this.timeoutID=this.touch=null;
this.state=r.State.Initial;
}r.prototype.oneFingerState=function(t,s){switch(s){case r.TouchEventType.End:if(this.timeoutID){clearTimeout(this.timeoutID);
}this.timeoutID=setTimeout(m.bind(this),l);
this.touch=c(t);
this.state=r.State.NoFingerAfterOneFinger;
break;
default:this.reset();
}};
function q(s){s=s||this;
p(s.touch,"mouseover",0,s.targetElem);
p(s.touch,"mousemove",0,s.targetElem);
p(s.touch,"mousedown",0,s.targetElem);
s.timeoutID=s.touch=null;
s.state=r.State.ObjectGrip;
}r.prototype.noFingerAfterOneFingerState=function(t,s){switch(s){case r.TouchEventType.Start:if(this.timeoutID){clearTimeout(this.timeoutID);
}this.timeoutID=setTimeout(q.bind(this),n);
this.touch=c(t);
this.state=r.State.ImpendingDoubleClickOrObjectGrip;
break;
default:this.reset();
}};
r.prototype.impendingDoubleClickOrObjectGripState=function(t,s){switch(s){case r.TouchEventType.End:if(this.timeoutID){clearTimeout(this.timeoutID);
this.timeoutID=null;
}this.simulateMouseDoubleClick(t,0);
this.state=r.State.Initial;
break;
case r.TouchEventType.Move:if(this.timeoutID){clearTimeout(this.timeoutID);
this.timeoutID=null;
}q(this);
this.touch=c(t);
break;
default:this.reset();
}};
r.prototype.objectGripState=function(t,s){switch(s){case r.TouchEventType.Move:p(t,"mousemove",0,this.targetElem);
this.touch=c(t);
break;
case r.TouchEventType.End:p(t,"mouseup",0,this.targetElem);
p(t,"mousemove",0,this.targetElem);
p(t,"mouseout",0,this.targetElem);
this.touch=c(t);
this.state=r.State.Initial;
break;
default:this.reset();
}};
r.prototype.processTouch=function(t,s){switch(this.state){case r.State.Initial:this.initialState(t,s);
break;
case r.State.OneFinger:this.oneFingerState(t,s);
break;
case r.State.NoFingerAfterOneFinger:this.noFingerAfterOneFingerState(t,s);
break;
case r.State.ImpendingDoubleClickOrObjectGrip:this.impendingDoubleClickOrObjectGripState(t,s);
break;
case r.State.ObjectGrip:this.objectGripState(t,s);
break;
}};
return r;
})();
var e=20;
b.mouseOwner=null;
b.isPinchZooming=false;
b.ComponentViewer=(function(){var p="1px dashed black",q="lightgray";
function k(r,s,u,t){this.canvas=r;
this.context=r.getContext("2d");
this.mouseButtons=0;
this.imgBuffer=null;
this.shapeDIV=null;
this.shapeBlinkTimer=null;
this.shapeIsBlack=true;
this.hiddenTextField=null;
this.touchStateMachine=b.isTouchDevice?new i(this):null;
this.dialogNestingDepth=t||0;
this.caret=new b.Caret(r);
if((s==b.ComponentType.TextView)||(s==b.ComponentType.TxDialog)){this.hiddenTextField=new b.HiddenTextField(r,s,this);
}this.componentType=s;
this.dialogType=u||b.TXDialogType.Unknown;
this.cursorType=null;
this.shapeDIV=document.createElement("div");
this.shapeDIV.classList.add("txShapeDIV");
this.shapeDIV.style.top="1px";
this.shapeDIV.style.left="-9999px";
this.context.canvas.parentNode.appendChild(this.shapeDIV);
this.canvasClientBoundRect=null;
r.addEventListener("mousedown",this.canvas_MouseDown.bind(this));
r.addEventListener("mouseup",this.canvas_MouseUp.bind(this));
r.addEventListener("click",this.canvas_Click.bind(this));
this.shapeDIV.addEventListener("mouseup",this.canvas_MouseUp.bind(this));
r.addEventListener("mousemove",this.canvas_MouseMove.bind(this));
r.addEventListener("dblclick",this.canvas_DoubleClick.bind(this));
r.addEventListener("DOMMouseScroll",this.canvas_MouseWheel.bind(this));
r.addEventListener("mousewheel",this.canvas_MouseWheel.bind(this));
r.addEventListener("contextmenu",function(v){v.preventDefault();
});
if(b.isTouchDevice){r.addEventListener("touchstart",this.canvas_TouchStart.bind(this));
r.addEventListener("touchend",this.canvas_TouchEnd.bind(this));
r.addEventListener("touchcancel",this.canvas_TouchCancel.bind(this));
r.addEventListener("touchleave",this.canvas_TouchEnd.bind(this));
r.addEventListener("touchmove",this.canvas_TouchMove.bind(this));
}document.addEventListener("componentCursorChanged",this.cursorChanged.bind(this));
if(this.componentType==b.ComponentType.TextView){document.addEventListener("drawShapeMessageReceived",this.drawShape.bind(this));
}}Object.defineProperty(k.prototype,"width",{get:function(){return this.canvas.width;
},set:function(r){this.canvas.width=r;
},enumerable:true,configurable:true});
Object.defineProperty(k.prototype,"height",{get:function(){return this.canvas.height;
},set:function(r){this.canvas.height=r;
},enumerable:true,configurable:true});
Object.defineProperty(k.prototype,"left",{get:function(){return this.canvas.offsetLeft;
},set:function(r){this.canvas.style.left=r+"px";
},enumerable:true,configurable:true});
Object.defineProperty(k.prototype,"top",{get:function(){return this.canvas.offsetTop;
},set:function(r){this.canvas.style.top=r+"px";
},enumerable:true,configurable:true});
Object.defineProperty(k.prototype,"caretBounds",{get:function(){return this.caret.bounds;
},enumerable:true,configurable:true});
k.prototype.setCaretState=function(r){if(b.isTouchDevice&&!b.inIMEComposition&&r.Visibility&&this.hiddenTextField){this.hiddenTextField.top=r.Location.Y+this.canvas.offsetTop;
}this.caret.setState(r);
};
k.prototype.setImage=function(t,r){var u=this;
r=r||false;
var s=new Image();
s.onload=function(){if(r){u.canvas.width=s.naturalWidth;
u.canvas.height=s.naturalHeight;
}u.context.clearRect(0,0,s.naturalWidth,s.naturalHeight);
u.context.drawImage(s,0,0,s.naturalWidth,s.naturalHeight);
b.sendCommand(b.Command.ImageLoaded,u.componentType,u.dialogType,u.dialogNestingDepth);
};
s.src=t;
};
k.prototype.updateImageRegions=function(t){var s=this,u=0,r=t.length;
t.forEach(function(w){var v=new Image();
v.onload=function(){s.context.clearRect(w.pos.X,w.pos.Y,v.naturalWidth,v.naturalHeight);
s.context.drawImage(v,w.pos.X,w.pos.Y,v.naturalWidth,v.naturalHeight);
if(r==++u){b.sendCommand(b.Command.ImageLoaded,s.componentType,s.dialogType,s.dialogNestingDepth);
}};
v.src=w.imageDataURL;
});
};
k.prototype.moveAndUpdateContent=function(s,u){var v=this,t=0,r=u.length;
if(!this.canvas.width||!this.canvas.height){return;
}this.context.drawImage(this.canvas,s.X,s.Y,this.canvas.width,this.canvas.height);
u.forEach(function(x){var w=new Image();
w.onload=function(){v.context.clearRect(x.pos.X,x.pos.Y,w.naturalWidth,w.naturalHeight);
v.context.drawImage(w,x.pos.X,x.pos.Y,w.naturalWidth,w.naturalHeight);
if(r==++t){b.sendCommand(b.Command.ImageLoaded,v.componentType,v.dialogType,v.dialogNestingDepth);
}};
w.src=x.imageDataURL;
});
};
k.prototype.show=function(){this.canvas.style.display="block";
};
k.prototype.hide=function(){this.canvas.style.display="none";
};
k.prototype.showCaret=function(){this.caret.show();
};
k.prototype.hideCaret=function(){this.caret.hide();
};
k.prototype.refreshCaretLocation=function(){this.caret.refreshLocation();
};
k.prototype.bufferContent=function(){if(!this.canvas.width||!this.canvas.height){this.imgBuffer=null;
return;
}this.imgBuffer=this.context.getImageData(0,0,this.canvas.width,this.canvas.height);
};
k.prototype.drawBufferedContent=function(){if(!this.imgBuffer){return;
}this.context.putImageData(this.imgBuffer,0,0);
delete this.imgBuffer;
};
k.prototype.canvas_MouseDown=function(s){if(!b.mouseOwner){b.mouseOwner=this;
}else{if(b.mouseOwner!=this){b.mouseOwner.canvas_MouseDown(s);
return;
}}var t=this.getMousePos(s),r={mousePos:{X:Math.round(t.x),Y:Math.round(t.y)},modifierKeys:b.modifierKeys,buttons:this.mouseButtonToMouseButtonFlag(s.which)};
b.sendCommand(b.Command.ComponentEvent,b.UserInputEventType.MouseDown,this.componentType,0,r);
if(s.which==1){this.mouseButtons|=g.Left;
}if(s.which==2){this.mouseButtons|=g.Middle;
}if(s.which==3){this.mouseButtons|=g.Right;
}s.preventDefault();
};
k.prototype.canvas_MouseUp=function(s){if(b.mouseOwner&&(b.mouseOwner!=this)){b.mouseOwner.canvas_MouseUp(s);
return;
}b.lastMouseUpEvent=s;
var t=this.getMousePos(s),r={mousePos:{X:Math.round(t.x),Y:Math.round(t.y)},modifierKeys:b.modifierKeys,buttons:this.mouseButtonToMouseButtonFlag(s.which)};
b.sendCommand(b.Command.ComponentEvent,b.UserInputEventType.MouseUp,this.componentType,0,r);
if(s.which==1){this.mouseButtons&=~g.Left;
}if(s.which==2){this.mouseButtons&=~g.Middle;
}if(s.which==3){this.mouseButtons&=~g.Right;
}this.canvasClientBoundRect=null;
if(s.which==1){this.hideShape();
}s.preventDefault();
};
k.prototype.canvas_Click=function(r){this.focus();
};
k.prototype.canvas_MouseMove=function(s){if(b.mouseOwner&&(b.mouseOwner!=this)){b.mouseOwner.canvas_MouseMove(s);
return;
}var t=this.getMousePos(s),r={mousePos:{X:Math.round(t.x),Y:Math.round(t.y)},modifierKeys:b.modifierKeys,buttons:this.mouseButtons};
b.sendCommand(b.Command.ComponentEvent,b.UserInputEventType.MouseMove,this.componentType,0,r);
s.preventDefault();
};
k.prototype.canvas_DoubleClick=function(s){var t=this.getMousePos(s),r={mousePos:{X:Math.round(t.x),Y:Math.round(t.y)},modifierKeys:b.modifierKeys,};
b.sendCommand(b.Command.ComponentEvent,b.UserInputEventType.MouseDoubleClick,this.componentType,0,r);
s.preventDefault();
};
k.prototype.canvas_TouchStart=function(r){b.hideAllOtherMenus();
b.fileMenu.hide();
var s=r.changedTouches;
if((s.length==1)&&(f.count()==0)){this.canvasClientBoundRect=this.canvas.getBoundingClientRect();
this.touchStateMachine.processTouch(s[0],i.TouchEventType.Start);
}else{this.touchStateMachine.reset();
}f.update(s);
if(r.cancelable){r.preventDefault();
}};
k.prototype.canvas_TouchDragTextView=function(s){var t=f.getItem(s.identifier);
if(this.componentType==b.ComponentType.TextView){var r={X:t.clientX-s.clientX,Y:t.clientY-s.clientY};
r=b.pointPixelToTwips(r,b.zoom);
b.scrollDelta(r);
}};
k.prototype.canvas_TouchPinchTextView=function(D){b.isPinchZooming=true;
var B=D[0],E=f.getItem(B.identifier);
var C,F;
if(D.length==2){C=D[1],F=f.getItem(C.identifier);
}else{for(var A in f.touches){if(A!=("_"+B.identifier)){F=C=f.touches[A];
break;
}}}var y={X:E.clientX,Y:E.clientY},z={X:F.clientX,Y:F.clientY},u=l(z,y),s=n(y,z);
y={X:B.clientX,Y:B.clientY},z={X:C.clientX,Y:C.clientY};
var t=l(z,y),r=n(y,z);
var x={X:Math.round(s.X-r.X),Y:Math.round(s.Y-r.Y)};
var v=Math.sqrt(x.X*x.X+x.Y*x.Y);
if(v>0){x=b.pointPixelToTwips(x,b.zoom);
b.scrollDelta(x);
}var w=t/u;
b.zoom=Math.round(b.zoom*w);
b.sendCommand(b.Command.Zoom,b.zoom);
};
function o(u){var r=u.changedTouches;
var w=[];
for(var v=0;
v<r.length;
++v){var s=r[v];
var x=f.getItem(s.identifier);
if(x.hasLeftDeadzone){s.hasLeftDeadzone=true;
w.push(s);
}else{var t=m(x,s);
if(t>=e){s.hasLeftDeadzone=true;
w.push(s);
}}}return w;
}k.prototype.canvas_TouchMove=function(r){if(!f.count()){if(this.touchStateMachine.state!=i.State.Initial){this.touchStateMachine.reset();
}return;
}var s=o(r);
if(s.length){switch(this.touchStateMachine.state){case i.State.ObjectGrip:case i.State.ImpendingDoubleClickOrObjectGrip:this.touchStateMachine.processTouch(s[0],i.TouchEventType.Move);
break;
default:switch(this.componentType){case b.ComponentType.TextView:this.canvas_TouchMoveTextView(s);
break;
}this.touchStateMachine.reset();
}f.update(s);
}if(r.cancelable){r.preventDefault();
}};
k.prototype.canvas_TouchMoveTextView=function(r){switch(f.count()){case 1:this.canvas_TouchDragTextView(r[0]);
break;
case 2:this.canvas_TouchPinchTextView(r);
break;
}};
k.prototype.canvas_TouchEnd=function(r){b.isPinchZooming=false;
var u=r.changedTouches;
if(u.length==1){this.touchStateMachine.processTouch(u[0],i.TouchEventType.End);
}for(var s=0;
s<u.length;
++s){var t=u[s];
f.removeItem(t.identifier);
}if(r.cancelable){r.preventDefault();
}};
k.prototype.canvas_TouchCancel=function(r){var u=r.changedTouches;
if(u.length==1){this.touchStateMachine.processTouch(u[0],i.TouchEventType.End);
}for(var s=0;
s<u.length;
++s){var t=u[s];
f.removeItem(t.identifier);
}if(r.cancelable){r.preventDefault();
}};
function l(t,u){var r=u.X-t.X;
var s=u.Y-t.Y;
return Math.sqrt((r*r)+(s*s));
}function m(t,u){var r={X:t.clientX,Y:t.clientY},s={X:u.clientX,Y:u.clientY};
return l(s,r);
}function n(r,s){return{X:(r.X+s.X)/2,Y:(r.Y+s.Y)/2};
}k.prototype.canvas_MouseWheel=function(t){var s=(t.wheelDelta||-(t.detail*40)),u=this.getMousePos(t),r={mousePos:{X:Math.round(u.x),Y:Math.round(u.y)},modifierKeys:b.modifierKeys,delta:s};
b.sendCommand(b.Command.ComponentEvent,b.UserInputEventType.MouseWheel,this.componentType,0,r);
t.preventDefault();
};
k.prototype.cursorChanged=function(s){var t=s.detail;
var r;
if(t.target!=this.componentType){return;
}if(t.dialogType!=this.dialogType){return;
}if(this.mouseButtons&g.Left){return;
}this.cursorType=t.cursorType;
switch(t.cursorType){case d.IBeam:this.canvas.style.cursor="text";
break;
case d.ArrowNE:if((b.BrowserDetect.browser==="Explorer")||(b.BrowserDetect.browser==="Other")||(b.BrowserDetect.browser==="Edge")){if(typeof TXWebResources!=="undefined"){r="url("+TXWebResources.m_srcCursors_markline_cur+"), default";
}else{r="url("+b.getTXFileDir()+"cursors/markline.cur), default";
}}else{r="url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAAYdEVYdFNvZnR3YXJlAHBhaW50Lm5ldCA0LjAuNWWFMmUAAACXSURBVFhH7c/bCoAgEARQ//+njXEmK0qfHJdgD0TuhcZKoKonRAW8We7VwgFntvZRNKFmew/FXtDjyE+RT+hz7KW4N8y44qOob5hzzUMxY9jh6nqKmMMe19c6P9yfEc3tFMfAO9Rtw0xxPVDVngso6gpvXfXxZunTggBntjr7BRQ9/dPwC9goOiYcFB93AQgNTyml9BelHIyxV7cc72i2AAAAAElFTkSuQmCC) 32 0, default";
}this.canvas.style.cursor=r;
break;
case d.VSplit:this.canvas.style.cursor="col-resize";
break;
case d.UpArrow:this.canvas.style.cursor="pointer";
break;
case d.Arrow:this.canvas.style.cursor="default";
break;
case d.DownArrow:if((b.BrowserDetect.browser==="Explorer")||(b.BrowserDetect.browser==="Other")||(b.BrowserDetect.browser==="Edge")){if(typeof TXWebResources!=="undefined"){r="url("+TXWebResources.m_srcCursors_tablecol_cur+"), default";
}else{r="url("+b.getTXFileDir()+"cursors/tablecol.cur), default";
}}else{r="url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAAYdEVYdFNvZnR3YXJlAHBhaW50Lm5ldCA0LjAuNWWFMmUAAABRSURBVFhH7c5BCsAgDETR3P/SSiQjpSi4SVz4H2RRLPyxDG0hnmpEcB4DGPDOgFEK/qn78v/SRGB76QPcbkRJXP4jSuOiEVficjUOAACAM2YdIA+kXMDmcwcAAAAASUVORK5CYII=) 23 11, default";
}this.canvas.style.cursor=r;
break;
case d.SizeWE:this.canvas.style.cursor="ew-resize";
break;
case d.SizeNS:this.canvas.style.cursor="ns-resize";
break;
case d.SizeNWSE:this.canvas.style.cursor="nwse-resize";
break;
case d.SizeNESW:this.canvas.style.cursor="nesw-resize";
break;
case d.SizeAll:this.canvas.style.cursor="move";
break;
case d.Cross:this.canvas.style.cursor="crosshair";
break;
default:this.canvas.style.cursor="default";
break;
}};
k.prototype.shapeBlink=function(){if(this.shapeIsBlack){this.shapeDIV.style.borderColor=q;
this.shapeIsBlack=false;
}else{this.shapeDIV.style.borderColor="black";
this.shapeIsBlack=true;
}};
k.prototype.hideShape=function(){if(this.shapeBlinkTimer){clearTimeout(this.shapeBlinkTimer);
this.shapeDIV.style.borderColor="black";
this.shapeBlinkTimer=null;
this.shapeIsBlack=true;
}this.shapeDIV.style.opacity=0;
this.shapeDIV.style.left="-9999px";
};
k.prototype.drawShape=function(r){if(!(this.mouseButtons&g.Left)){return;
}var s=r.detail;
if(!this.shapeBlinkTimer){this.shapeBlinkTimer=setInterval(this.shapeBlink.bind(this),500);
switch(s.Kind){case h.TableBorderMovingLine:this.shapeDIV.style.border="none";
this.shapeDIV.style.borderLeft=p;
break;
case h.MoveAndSizeFrame:this.shapeDIV.style.border=p;
break;
}this.shapeDIV.style.opacity=1;
}var t=s.Location.X+this.left,u=s.Location.Y+this.top;
this.shapeDIV.style.top=u+"px";
this.shapeDIV.style.left=t+"px";
this.shapeDIV.style.height=s.Size.Height+"px";
this.shapeDIV.style.width=s.Size.Width+"px";
};
k.prototype.focus=function(){if(b.ignoreNextTextFocusRequest){b.ignoreNextTextFocusRequest=false;
return;
}if(!this.hiddenTextField){return;
}if((this.componentType!=b.ComponentType.TextView)&&(this.componentType!=b.ComponentType.TxDialog)){return;
}this.hiddenTextField.focus();
b.sendCommand(b.Command.ComponentActivationState,this.componentType,b.ActivationState.Activated);
};
k.prototype.blur=function(){if(this.hiddenTextField){this.hiddenTextField.blur();
}};
k.prototype.getMousePos=function(r){var s;
if(b.isTouchDevice&&this.canvasClientBoundRect){s=this.canvasClientBoundRect;
}else{s=this.canvas.getBoundingClientRect();
}return{x:r.clientX-s.left,y:r.clientY-s.top};
};
k.prototype.mouseButtonToMouseButtonFlag=function(r){switch(r){case 1:return g.Left;
case 2:return g.Middle;
case 3:return g.Right;
}return 0;
};
return k;
})();
return j;
}(TXTextControl||{},j$1_10_2));
var TXTextControl=(function(v,a){var b=v._private=v._private||{};
b.ScrollbarWidth=15;
b.StatusBarHeight=22;
b.VertRulerWidth=25;
b.HorRulerHeight=25;
b.MinScrollbarHandleLength=30;
b.RibbonBarHeight=114;
b.DefRes=96;
b.ScrollStep=1000;
var i=false;
var m=false;
var h=true;
var l=true;
var k=true;
b.ViewersInvisible=true;
b.ScrollPadding=567;
var j=false;
b.clientSize={Width:0,Height:0};
b.textViewSizeInTwips={Width:0,Height:0};
b.documentSize={Width:0,Height:0};
b.viewLocation={X:-b.ScrollPadding,Y:0};
b.zoom=100;
b.createScrollbars=function(){var D=a("#slider-horizontal");
var E=a("#slider-vertical");
E.on("mousedown",B);
E.on("touchstart",B);
D.on("mousedown",g);
D.on("touchstart",g);
D.slider({orientation:"horizontal",min:-b.ScrollPadding,max:100,value:-b.ScrollPadding,slide:function(F,G){n(G.value);
},start:function(){j=true;
},stop:function(){j=false;
}});
E.slider({orientation:"vertical",min:0,max:100,value:100,slide:function(F,G){var H=E.slider("option","max")-G.value;
o(H);
},start:function(){j=true;
},stop:function(){j=false;
}});
a("#slider-horizontal .ui-slider-handle").unbind("keydown");
a("#slider-vertical .ui-slider-handle").unbind("keydown");
a("#vertical-scrollbar-wrapper").click(A);
a("#horizontal-scrollbar-wrapper").click(f);
a("div.scroll-button").click(r);
};
function n(D){b.sendCommand(b.Command.HScroll,D);
}function o(D){b.sendCommand(b.Command.VScroll,D);
}b.scrollDelta=function(D){b.sendCommand(b.Command.ScrollDelta,D.X,D.Y);
};
b.onContainerResize=function(){b.adaptViewToContainerSize();
};
b.documentSizeChangedHandler=function(D){var E=D.detail;
b.documentSize.Width=E.Width;
b.documentSize.Height=E.Height;
c();
};
b.txZoomedHandler=function(D){var E=D.detail;
if(!b.isPinchZooming){b.zoom=E.zoomFactor;
}t(E.zoomFactor);
c();
};
function y(){if(j){return;
}if(!b.documentSize.Width||!b.documentSize.Height){return;
}var G={Width:b.textViewer.width,Height:b.textViewer.height};
G=s(G,b.zoom);
var D=b.documentSize.Width-G.Width;
var H=b.documentSize.Height-G.Height;
var E=(b.viewLocation.X+b.ScrollPadding)/D;
var F=b.viewLocation.Y/H;
if(i){a("#slider-horizontal").slider("option","value",(E*b.documentSize.Width)-b.ScrollPadding);
}if(m){a("#slider-vertical").slider("option","value",(1-F)*b.documentSize.Height);
}}function x(){var D=h?b.HorRulerHeight:0;
var E=l?b.VertRulerWidth:0;
w(E,D);
z(E,D);
}function w(M,G){var J=a("#slider-horizontal");
var K=a("#horizontal-scrollbar-wrapper");
var D={left:a("#scroll-button-left"),right:a("#scroll-button-right")};
var F=a("#slider-horizontal a.ui-slider-handle");
if(i){K.show();
D.left.show();
D.right.show();
var E=D.left[0].clientWidth;
var I=b.textViewer.width-(2*E);
var H=Math.max(b.MinScrollbarHandleLength,(b.textViewSizeInTwips.Width/b.documentSize.Width)*I);
F.css({width:H,height:b.ScrollbarWidth,top:0,marginLeft:-(H/2)});
J.slider("option","min",-b.ScrollPadding);
J.slider("option","max",b.documentSize.Width-b.ScrollPadding);
J.css({width:b.textViewer.width-H-(2*E),marginLeft:H/2});
var L=b.textViewer.height+b.RibbonBarHeight+G;
K.css({width:I,height:b.ScrollbarWidth,left:E+M,top:L});
D.left.css({left:M,top:L});
D.right.css({left:E+I+M,top:L});
}else{K.hide();
D.left.hide();
D.right.hide();
}}function z(L,G){var J=a("#slider-vertical");
var K=a("#vertical-scrollbar-wrapper");
var E={up:a("#scroll-button-up"),down:a("#scroll-button-down")};
var F=a("#slider-vertical a.ui-slider-handle");
if(m){K.show();
E.up.show();
E.down.show();
var D=E.up[0].clientHeight;
var I=b.textViewer.height-(2*D);
var H=Math.max(b.MinScrollbarHandleLength,(b.textViewSizeInTwips.Height/b.documentSize.Height)*I);
F.css({width:b.ScrollbarWidth,height:H,left:0,marginBottom:-(H/2)});
J.slider("option","min",0);
J.slider("option","max",b.documentSize.Height);
J.css({height:b.textViewer.height-H-(2*D),marginTop:H/2});
K.css({height:I,width:b.ScrollbarWidth,left:b.textViewer.width+L,top:b.RibbonBarHeight+D+G});
E.up.css({left:b.textViewer.width+L,top:b.RibbonBarHeight+G});
E.down.css({left:b.textViewer.width+L,top:b.RibbonBarHeight+D+I+G});
}else{K.hide();
E.up.hide();
E.down.hide();
}}function A(D){var F=a("#vertical-scrollbar-wrapper")[0];
var G=(D.pageY-F.offsetTop)/F.clientHeight;
var E=1-(a("#slider-vertical").slider("option","value")/b.documentSize.Height);
if(!b.isTouchDevice){b.textViewer.focus();
}if(G>E){b.sendCommand(b.Command.ComponentEvent,b.UserInputEventType.KeyDown,b.ComponentType.TextView,0,{key:b.KeyCode.PageDown});
}else{b.sendCommand(b.Command.ComponentEvent,b.UserInputEventType.KeyDown,b.ComponentType.TextView,0,{key:b.KeyCode.PageUp});
}}function f(D){var F=a("#horizontal-scrollbar-wrapper")[0];
var G=(D.pageX-F.offsetLeft)/F.clientWidth;
var E=(a("#slider-horizontal").slider("option","value")+b.ScrollPadding)/b.documentSize.Width;
if(!b.isTouchDevice){b.textViewer.focus();
}if(G>E){b.scrollDelta({X:b.ScrollStep,Y:0});
}else{b.scrollDelta({X:-b.ScrollStep,Y:0});
}}function B(D){var F=a("#slider-vertical");
var E=F.find(".ui-slider-handle");
if(D.target!=E[0]){D.stopImmediatePropagation();
}}function g(D){var F=a("#slider-horizontal");
var E=F.find(".ui-slider-handle");
if(D.target!=E[0]){D.stopImmediatePropagation();
}}function r(D){switch(D.currentTarget.id){case"scroll-button-up":b.scrollDelta({X:0,Y:-b.ScrollStep});
break;
case"scroll-button-down":b.scrollDelta({X:0,Y:b.ScrollStep});
break;
case"scroll-button-left":b.scrollDelta({X:-b.ScrollStep,Y:0});
break;
case"scroll-button-right":b.scrollDelta({X:b.ScrollStep,Y:0});
break;
}}function e(){if(b.ViewersInvisible){var F=document.querySelectorAll("#txTemplateDesignerContainer canvas");
for(var D=0;
D<F.length;
++D){F[D].style.opacity="";
}var E=document.getElementById("txLoaderGif");
E.style.opacity="";
setTimeout(function(){var G=document.getElementById("txTemplateDesignerContainer");
G.removeChild(E);
},500);
b.ViewersInvisible=false;
}}b.imageReceivedHandler=function(D){var F=D.detail;
switch(F.target){case b.ComponentType.TextView:b.textViewer.setImage(F.data);
break;
case b.ComponentType.HorRuler:b.horRulerViewer.setImage(F.data);
break;
case b.ComponentType.VertRuler:b.vertRulerViewer.setImage(F.data);
break;
case b.ComponentType.StatusBar:b.statusBarViewer.setImage(F.data);
if(b.ViewersInvisible){e();
}break;
case b.ComponentType.TxDialog:var E=new CustomEvent("txDialogImageReceived",{detail:F});
document.dispatchEvent(E);
break;
}};
b.imageRegionsUpdatedHandler=function(D){var F=D.detail;
switch(F.target){case b.ComponentType.TextView:b.textViewer.updateImageRegions(F.tiles);
break;
case b.ComponentType.HorRuler:b.horRulerViewer.updateImageRegions(F.tiles);
break;
case b.ComponentType.VertRuler:b.vertRulerViewer.updateImageRegions(F.tiles);
break;
case b.ComponentType.StatusBar:b.statusBarViewer.updateImageRegions(F.tiles);
break;
case b.ComponentType.TxDialog:var E=new CustomEvent("txDialogImageRegionsUpdated",{detail:F});
document.dispatchEvent(E);
break;
}};
b.viewContentMovedAndUpdatedHandler=function(D){var E=D.detail;
switch(E.target){case b.ComponentType.TextView:b.textViewer.moveAndUpdateContent(E.delta,E.images);
break;
}};
b.textViewLocationChangedHandler=function(D){b.viewLocation=D.detail;
y();
};
b.textViewCaretStateChangedHandler=function(D){var E=D.detail;
b.textViewer.setCaretState(E.caretState);
};
function c(){b.textViewSizeInTwips=s({Width:b.textViewer.width,Height:b.textViewer.height});
i=b.isSocketConnected()&&(b.documentSize.Width>b.textViewSizeInTwips.Width);
m=b.isSocketConnected()&&(b.documentSize.Height>b.textViewSizeInTwips.Height);
var F=l?b.VertRulerWidth:0;
var G=h?b.RibbonBarHeight+b.HorRulerHeight:b.RibbonBarHeight;
var E=b.clientSize.Width-(m?b.ScrollbarWidth:0)-F;
var D=b.clientSize.Height-(i?b.ScrollbarWidth:0)-(k?b.StatusBarHeight:0)-G;
b.textViewSizeInTwips=s({Width:E,Height:D});
if((b.textViewer.left!=F)||(b.textViewer.top!=G)||(b.textViewer.width!=E)||(b.textViewer.height!=D)){b.textViewer.bufferContent();
b.textViewer.left=F;
b.textViewer.top=G;
if(b.isSocketConnected()){b.textViewer.width=E;
b.textViewer.height=D;
}b.textViewer.drawBufferedContent();
if(h){b.horRulerViewer.bufferContent();
b.horRulerViewer.top=b.RibbonBarHeight;
if(b.isSocketConnected()){b.horRulerViewer.width=E+(l?b.VertRulerWidth:0)+(m?b.ScrollbarWidth:0);
b.horRulerViewer.height=b.HorRulerHeight;
}b.horRulerViewer.drawBufferedContent();
}if(l){b.vertRulerViewer.bufferContent();
b.vertRulerViewer.top=G;
if(b.isSocketConnected()){b.vertRulerViewer.width=b.VertRulerWidth;
b.vertRulerViewer.height=D+(i?b.ScrollbarWidth:0);
}b.vertRulerViewer.drawBufferedContent();
}if(k){b.statusBarViewer.bufferContent();
b.statusBarViewer.top=b.RibbonBarHeight+D+(h?b.HorRulerHeight:0)+(i?b.ScrollbarWidth:0);
if(b.isSocketConnected()){b.statusBarViewer.width=b.clientSize.Width;
b.statusBarViewer.height=b.StatusBarHeight;
}b.statusBarViewer.drawBufferedContent();
}}C();
x();
y();
}function C(){var G={location:{X:b.textViewer.left,Y:b.textViewer.top-b.RibbonBarHeight},size:{Width:b.textViewer.width,Height:b.textViewer.height}};
var E={visible:h,location:{X:0,Y:b.horRulerViewer.top-b.RibbonBarHeight},size:{Width:b.horRulerViewer.width,Height:b.horRulerViewer.height}};
var H={visible:l,location:{X:0,Y:b.vertRulerViewer.top-b.RibbonBarHeight},size:{Width:b.vertRulerViewer.width,Height:b.vertRulerViewer.height}};
var F={visible:k,location:{X:0,Y:b.statusBarViewer.top-b.RibbonBarHeight},size:{Width:b.statusBarViewer.width,Height:b.statusBarViewer.height}};
var D={textViewerInfo:G,horRulerInfo:E,vertRulerInfo:H,statusBarInfo:F};
b.sendCommand(b.Command.WindowResized,0,0,0,D);
}b.showHorizontalRuler=function(E){if(h==E){return;
}h=E;
if(E){b.horRulerViewer.show();
}else{b.horRulerViewer.hide();
}c();
b.textViewer.refreshCaretLocation();
var D=document.getElementById("chkRulerHor");
if(D){D.checked=E;
}};
b.showVerticalRuler=function(E){if(l==E){return;
}l=E;
if(E){b.vertRulerViewer.show();
}else{b.vertRulerViewer.hide();
}c();
b.textViewer.refreshCaretLocation();
var D=document.getElementById("chkRulerVert");
if(D){D.checked=E;
}};
b.showStatusBar=function(E){if(k==E){return;
}k=E;
if(E){b.statusBarViewer.show();
}else{b.statusBarViewer.hide();
}c();
b.textViewer.refreshCaretLocation();
var D=document.getElementById("chkStatusBar");
if(D){D.checked=E;
}};
function d(){b.textViewer.blur();
b.horRulerViewer.blur();
b.vertRulerViewer.blur();
b.statusBarViewer.blur();
if(b.txDialog){b.txDialog.blur();
}}b.adaptViewToContainerSize=function(){var D=document.getElementById("txTemplateDesignerContainer").parentElement;
var F,E;
if(D.tagName=="BODY"){F=window.innerWidth;
E=window.innerHeight;
}else{F=D.offsetWidth;
E=D.offsetHeight;
}if((b.isTouchDevice)&&((E-b.clientSize.Height)>20)){d();
}b.clientSize={Width:F,Height:E};
c();
b.updateRibbonTabContentOffset();
b.updateRibbonScrollArrows();
b.updateRibbonHideButtonPos();
};
function t(E){var D=null;
E=E||0;
a("#zoomDropDown div.ribbon-button-checkmark").removeClass("ribbon-button-selected");
switch(E){case 25:D=a("#tglBtnZoom_25");
break;
case 50:D=a("#tglBtnZoom_50");
break;
case 75:D=a("#tglBtnZoom_75");
break;
case 100:D=a("#tglBtnZoom_100");
break;
case 150:D=a("#tglBtnZoom_150");
break;
case 200:D=a("#tglBtnZoom_200");
break;
case 400:D=a("#tglBtnZoom_400");
break;
}if(D){D.addClass("ribbon-button-selected");
}}function u(D,E){E=E||b.zoom;
return Math.round(D*b.DefRes*E/144000);
}function p(D,E){E=E||b.zoom;
return Math.round(D*144000/(b.DefRes*E));
}function q(E,D){return{X:u(E.X,D),Y:u(E.Y,D)};
}function s(E,D){return{Width:p(E.Width,D),Height:p(E.Height,D)};
}b.pointPixelToTwips=function(E,D){return{X:p(E.X,D),Y:p(E.Y,D)};
};
return v;
}(TXTextControl||{},j$1_10_2));
var TXTextControl=(function(c,a){var b=c._private=c._private||{};
b.FieldType={MergeField:0,IfField:1,IncludeTextField:2,DateField:3,NextField:4,NextIfField:5,};
b.FieldDisplayMode={ShowFieldText:0,ShowFieldCodes:1,};
b.showFieldPropsDialogHandler=function(){if(b.currentFieldData){b.showFieldDialog(b.currentFieldData.fieldAdapter,b.currentFieldData.mergeFieldType);
}};
b.showFieldDialog=function(e,f){var d;
switch(f){case b.FieldType.MergeField:d=new b.MergeFieldDialog(e);
break;
case b.FieldType.IfField:d=new b.IfFieldDialog(e);
break;
case b.FieldType.DateField:d=new b.DateFieldDialog(e);
break;
case b.FieldType.IncludeTextField:d=new b.IncludeTextFieldDialog(e);
break;
case b.FieldType.NextIfField:d=new b.NextIfFieldDialog(e);
break;
}if(d){d.showModal();
}};
b.selectMasterTable=function(d){b.sendCommand(b.Command.SelectMasterTable,0,0,0,d);
};
return c;
}(TXTextControl||{},j$1_10_2));
var TXTextControl=(function(l,a){var b=l._private=l._private||{};
var g;
b.lastMouseUpEvent=null;
var d={TextSelection:1,TextInputPosition:2,Header:4,NoHeader:8,Footer:16,NoFooter:32,PageMargin:64,PageNumberField:128,SelectedFrame:256,Table:512,TextField:1024,MisspelledWord:2048};
var h="txMenu_";
b.initContextMenus=function(){g=a("#txContextMenu").menu().hide();
g.on("menuselect",i);
};
function f(n){var p=[];
var o=1;
for(var m=0;
m<32;
++m){switch(n&o){case d.Footer:p.push("Footer");
break;
case d.Header:p.push("Header");
break;
case d.MisspelledWord:p.push("MisspelledWord");
break;
case d.NoFooter:p.push("NoFooter");
break;
case d.NoHeader:p.push("NoHeader");
break;
case d.PageMargin:p.push("PageMargin");
break;
case d.PageNumberField:p.push("PageNumberField");
break;
case d.SelectedFrame:p.push("SelectedFrame");
break;
case d.Table:p.push("Table");
break;
case d.TextField:p.push("TextField");
break;
case d.TextInputPosition:p.push("TextInputPosition");
break;
case d.TextSelection:p.push("TextSelection");
break;
}o<<=1;
}return p;
}function j(n,q){var p=h.length;
for(var o=0;
o<n.classList.length;
++o){var m=n.classList[o];
if(m.substring(0,p)===h){n.classList.remove(m);
}}q.forEach(function(r){n.classList.add(h+r);
});
}b.contextMenuDataReceivedHandler=function(m){var r=m.detail;
var q=r.menuItems;
var p=f(r.contextMenuLocation);
var n=document.getElementById("txContextMenu");
c(q,n);
var o=a("#txContextMenu");
o.menu("refresh");
b.calcMenuWidths(n);
j(n,p);
k(b.lastMouseUpEvent);
};
function c(n,m){var o=false;
m.innerHTML="";
n.forEach(function(v){if(!v.Text){o=true;
return;
}var s=document.createElement("li");
s.setAttribute("data-item-id",v.ID);
if(!v.Enabled){s.classList.add("ui-state-disabled");
}m.appendChild(s);
var p=document.createElement("a");
p.href="#!";
if(o){p.style.borderTop="1px solid lightgray";
o=false;
}s.appendChild(p);
var q=document.createElement("div");
q.classList.add("small-menu-item-image-wrapper");
if(v.ImageDataURL){var r=document.createElement("img");
r.src=v.ImageDataURL;
q.appendChild(r);
}else{if(v.Checked){var r=document.createElement("img");
r.src=b.imageResources.small.checkmark;
q.appendChild(r);
q.classList.add("ribbon-button");
q.classList.add("ribbon-button-selected");
}}p.appendChild(q);
q=document.createElement("div");
q.classList.add("small-menu-item-caption-container");
p.appendChild(q);
var t=document.createElement("p");
t.textContent=v.Text;
q.appendChild(t);
if(v.Items.length){var u=document.createElement("ul");
u.classList.add("dropDownMenu");
u.classList.add("contextMenu");
s.appendChild(u);
c(v.Items,u);
}});
}function i(o,q){var n=q.item.context;
var m=n.attributes["data-item-id"];
if(m){var p=parseInt(m.value,10);
b.sendCommand(b.Command.ContextMenuItemClicked,p);
}}b.isInsideElementWithID=function(m,n){if(!m){return false;
}else{if(m.parentElement&&(m.parentElement.id===n)){return true;
}else{return b.isInsideElementWithID(m.parentElement,n);
}}};
function e(m,n){if(!m){return null;
}else{if(m.parentElement&&(m.parentElement.tagName===n)){return m.parentElement;
}else{return e(m.parentElement,n);
}}}b.isPartOfMenuItemWithSubMenu=function(m){var n=e(m,"LI");
if(n&&n.classList.contains("ui-menu-item")){return(n.querySelectorAll("ul").length>0);
}return false;
};
function k(m){b.fileMenu.hide();
b.hideAllMenus_homeTab();
g.show().position({my:"left top",at:"left bottom",of:m,});
a(document).on("click",function(n){if(!(b.isInsideElementWithID(n.target,"txContextMenu")&&b.isPartOfMenuItemWithSubMenu(n.target))){g.hide();
a(document).off(n);
}});
}return l;
}(TXTextControl||{},j$1_10_2));
var TXTextControl=(function(g,a){var b=g._private=g._private||{};
b.ClipboardDataType={None:0,RTF:1,HTML:2,Plain:3,File:4,};
function f(j,i,h){var m="";
var l=false;
var n=j.types;
h=h||false;
if(j.items&&/Files/.test(n)){if(/Files/.test(n)){var k=[].find.call(j.items,function(o){return o.kind==="file";
});
if(k){d(k);
l=true;
}}}else{if(j.files&&j.files.length){e(j.files[0]);
l=true;
}else{if(j.types){if(!l&&/text\/rtf/.test(n)){m=j.getData("text/rtf");
if(m.length>0){b.pasteText(m,b.ClipboardDataType.RTF,h);
l=true;
}}if(!l&&/text\/html/.test(n)){m=j.getData("text/html");
if(m.length>0){b.pasteText(m,b.ClipboardDataType.HTML,h);
l=true;
}}if(i&&!l&&/text\/plain/.test(n)){m=j.getData("text/plain");
if(m.length>0){b.pasteText(m,b.ClipboardDataType.Plain,h);
l=true;
}}if(i&&!l){m=j.getData("Text");
if(m.length>0){b.pasteText(m,b.ClipboardDataType.Plain,h);
l=true;
}}}}}return l;
}b.handleClientPaste=function(i,h){if(typeof h=="undefined"){h=true;
}if(i&&i.clipboardData&&i.clipboardData.items){if(f(i.clipboardData,h)){i.stopPropagation();
i.preventDefault();
return false;
}}return true;
};
b.handleDrop=function(h){h.stopPropagation();
h.preventDefault();
if(h&&h.dataTransfer){f(h.dataTransfer,true,true);
}};
function d(i){var h=i.getAsFile();
e(h);
}function e(h){var i=h.name;
var j=new FileReader();
j.onload=function(k){var l={dataB64:k.target.result,fileName:i};
b.sendCommand(b.Command.ClientPaste,b.ClipboardDataType.File,0,0,l);
};
j.readAsDataURL(h);
}function c(h){switch(h){case b.ClipboardDataType.HTML:return"text/html";
case b.ClipboardDataType.RTF:return"text/rtf";
case b.ClipboardDataType.Plain:return"text/plain";
}return"";
}b.pasteText=function(l,m,i){var k=c(m);
var h=false;
if(i){var j={cancel:false,text:l,textType:m};
b.fireEvent(b.EventName.textDropped,j);
l=j.text;
m=j.textType;
h=j.cancel;
}if(!h){b.sendCommand(b.Command.ClientPaste,m,0,0,l);
}};
return g;
}(TXTextControl||{},j$1_10_2));
var TXTextControl=(function(c,a){var b=c._private=c._private||{};
b.EventName={ribbonTabsLoaded:"ribbonTabsLoaded",textFieldEntered:"textFieldEntered",textFieldLeft:"textFieldLeft",textFieldClicked:"textFieldClicked",textDropped:"textDropped",documentLoaded:"documentLoaded"};
b.eventListeners={};
c.addEventListener=function(e,d){if(!e){throw Error("Wrong number of parameters.");
}if(typeof e!=="string"){throw TypeError('Parameter "eventName" must be of type "string".');
}if(!d){throw Error("Wrong number of parameters.");
}if(typeof d!=="function"){throw TypeError('Parameter "callback" must be of type "function".');
}b.eventListeners[e]=b.eventListeners[e]||[];
var g=b.eventListeners[e];
var f=g.indexOf(d);
if(f==-1){g.push(d);
}};
c.removeEventListener=function(g,d){if(!g){throw Error("Wrong number of parameters.");
}if(typeof g!=="string"){throw TypeError('Parameter "eventName" must be of type "string".');
}if(!d){throw Error("Wrong number of parameters.");
}if(typeof d!=="function"){throw TypeError('Parameter "callback" must be of type "function".');
}if(!b.eventListeners.hasOwnProperty(g)){return;
}var i=b.eventListeners[g];
try{var h=i.indexOf(d);
if(h>-1){i.splice(h,1);
if(i.length==0){delete b.eventListeners[g];
}}}catch(f){}};
b.fireEvent=function(h,g){if(!b.eventListeners.hasOwnProperty(h)){return;
}var k=b.eventListeners[h];
for(var j=0;
j<k.length;
++j){var d=k[j];
try{d(g);
}catch(f){}}};
b.textFieldDataReceivedHandler=function(f){var g=f.detail.item;
var i=f.detail.mouseClick;
var h=b.currentFieldData.textField;
if(g){if(!h||i||(g.fieldName!==h.fieldName)||(g.fieldType!==h.fieldType)||((g.typeName&&h.typeName)&&(g.typeName!==h.typeName))){if(h&&!i){b.fireEvent(b.EventName.textFieldLeft);
}var d=cloneObject(g);
if(i){b.fireEvent(b.EventName.textFieldClicked,d);
}else{b.fireEvent(b.EventName.textFieldEntered,d);
}}}else{if(h){b.fireEvent(b.EventName.textFieldLeft);
}}b.currentFieldData.textField=g;
};
return c;
}(TXTextControl||{},j$1_10_2));
(function(a){if(a.MutationObserver){return;
}function c(d){return window.ShadowDOMPolyfill&&window.ShadowDOMPolyfill.wrapIfNeeded(d)||d;
}function b(d){this._callback=d;
}b.prototype={observe:function(e,d){e=c(e);
if(!d.childList&&!d.attributes&&!d.characterData||d.attributeOldValue&&!d.attributes||d.attributeFilter&&d.attributeFilter.length&&!d.attributes||d.characterDataOldValue&&!d.characterData){throw new SyntaxError();
}}};
a.MutationObserver=b;
})(this);
var TXTextControl=(function(c,a){var b=c._private=c._private||{};
b.HTMLDialog=(function(){function d(){this.dialogData={dialogResult:false};
this.resourcesReceivedHandlerBound=this.resourcesReceivedHandler.bind(this);
this.loadedBound=this.loaded.bind(this);
this.dialogContainerID="dialogContainer"+randomIntFromInterval(10000,99999);
this.isDialogReady=false;
this.closeRequested=false;
}d.prototype.OKHandler=function(e){this.dialogData.dialogResult=true;
this.close(e);
};
d.prototype.close=function(e){if(!this.isDialogReady){this.closeRequested=true;
return;
}this.closing();
b.sendCommand(b.Command.DialogResult,this.DialogInfo.DialogType,0,0,this.dialogData);
a(e).dialog("destroy").remove();
a("#"+this.dialogContainerID).remove();
if(!b.isTouchDevice){b.textViewer.focus();
}};
d.prototype.loaded=function(){document.addEventListener("dialogResourcesReceived",this.resourcesReceivedHandlerBound);
b.sendCommand(b.Command.GetDialogResources,this.DialogInfo.DialogType);
};
d.prototype.resourcesReceivedHandler=function(f){if(f.detail.dialogType==this.DialogInfo.DialogType){this.dialogize(f.detail.stringResources);
document.removeEventListener("dialogResourcesReceived",this.resourcesReceivedHandlerBound);
}};
d.prototype.dialogize=function(f){var e=this;
this.caption=f[this.DialogInfo.TitleResourceName];
a("#"+this.DialogInfo.ElementID).dialog({modal:true,resizable:this.DialogInfo.Resizable||false,width:this.DialogInfo.Width||"auto",height:this.DialogInfo.Height||"auto",dialogClass:this.DialogInfo.DialogClass||"",title:e.caption,buttons:this.DialogInfo.Buttons||{OK:{text:"OK",click:function(){e.OKHandler(this);
},id:"btnOK_"+this.dialogContainerID},Cancel:{text:"Cancel",click:function(){e.close(this);
},id:"btnCancel_"+this.dialogContainerID}},close:function(){e.close(this);
},}).keypress(function(g){if(g.keyCode==a.ui.keyCode.ENTER){e.OKHandler(this);
return false;
}});
this.applyStringResources(f);
this.dialogReady(this);
this.isDialogReady=true;
if(this.closeRequested){this.close(a("#"+this.DialogInfo.ElementID));
}};
d.prototype.setDefaultBtnTexts=function(j){var g=document.getElementById("btnOK_"+this.dialogContainerID);
if(g&&j.hasOwnProperty("BTN_OK")){var i=g.querySelector("span.ui-button-text");
i.textContent=j.BTN_OK;
}var e=document.getElementById("btnCancel_"+this.dialogContainerID);
if(e&&j.hasOwnProperty("BTN_CANCEL")){i=e.querySelector("span.ui-button-text");
i.textContent=j.BTN_CANCEL;
}var h=document.getElementById("btnYes_"+this.dialogContainerID);
if(h&&j.hasOwnProperty("BTN_YES")){i=h.querySelector("span.ui-button-text");
i.textContent=j.BTN_YES;
}var f=document.getElementById("btnNo_"+this.dialogContainerID);
if(f&&j.hasOwnProperty("BTN_NO")){i=f.querySelector("span.ui-button-text");
i.textContent=j.BTN_NO;
}};
d.prototype.showModal=function(){var f=document.getElementById("txTemplateDesignerContainer"),g=document.createElement("div");
g.id=this.dialogContainerID;
f.appendChild(g);
var h="";
if(typeof TXSettings!=="undefined"){h=TXSettings.AppVirtualPath+TXSettings.BasePath;
}var e=a("#"+this.dialogContainerID);
e.load(h+"Dialogs/"+this.DialogInfo.FileName,this.loadedBound);
};
d.prototype.applyStringResources=function(e){};
d.prototype.dialogReady=function(e){};
d.prototype.closing=function(){};
return d;
})();
return c;
}(TXTextControl||{},j$1_10_2));
this.__extends=this.__extends||function(c,d){for(var b in d){if(d.hasOwnProperty(b)){c[b]=d[b];
}}function a(){this.constructor=c;
}a.prototype=d.prototype;
c.prototype=new a();
};
var TXTextControl=(function(c,a){var b=c._private=c._private||{};
b.HyperlinkDialog=(function(d){__extends(e,d);
function e(){d.call(this);
this.DialogInfo={DialogType:b.HTMLDialogType.HyperlinkDialog,ElementID:"hyperlinkDialog",FileName:"HyperlinkDialog.html",TitleResourceName:"HYPLNK_DIALOG_CAPTION",};
}e.prototype.docTargetsReceivedHandler=function(f){var h=f.detail.targets,g=a("#selTarget");
g.empty();
h.forEach(function(j){var i=document.createElement("option");
i.text=j.TargetName;
g.append(i);
});
};
e.prototype.txItemReceivedHandler=function(f){var h=f.detail.itemType,g=f.detail.item;
if(g==null){return;
}switch(h){case b.ItemType.HypertextLink:a("#txtLinkedText").val(g.Text);
a("#txtLinkTarget").val(g.Target);
break;
case b.ItemType.DocumentLink:a("#txtLinkedText").val(g.Text);
a("#txtLinkTarget").val("#"+g.TargetName);
break;
}};
e.prototype.OKHandler=function(f){var g=a("#txtLinkedText").val(),h=a("#txtLinkTarget").val();
if((g.length>0)&&(h.length>0)){b.sendCommand(b.Command.InsertItem,b.ItemType.HypertextLink,0,0,{linkedText:g,linkTarget:h});
}this.close(f);
};
e.prototype.closing=function(f){document.removeEventListener("documentTargetsReceived",this.docTargetsReceivedHandler);
document.removeEventListener("txItemReceived",this.txItemReceivedHandler);
};
e.prototype.dialogReady=function(){document.addEventListener("documentTargetsReceived",this.docTargetsReceivedHandler);
document.addEventListener("txItemReceived",this.txItemReceivedHandler);
b.sendCommand(b.Command.GetDocumentTargets);
b.sendCommand(b.Command.GetItem,b.ItemType.Link);
a("#selTarget").change(function(){var f=a(this).val();
a("#txtLinkTarget").val("#"+f);
});
};
e.prototype.applyStringResources=function(f){a("#HYPLNK_DIALOG_LBL_LINKED_TEXT").text(f.HYPLNK_DIALOG_LBL_LINKED_TEXT);
a("#HYPLNK_DIALOG_GROUP_BOX > legend").text(f.HYPLNK_DIALOG_GROUP_BOX);
a("#HYPLNK_DIALOG_LBL_LINK_TGT").text(f.HYPLNK_DIALOG_LBL_LINK_TGT);
a("#HYPLNK_DIALOG_LBL_SEL_TGT").text(f.HYPLNK_DIALOG_LBL_SEL_TGT);
this.setDefaultBtnTexts(f);
};
return e;
})(b.HTMLDialog);
return c;
}(TXTextControl||{},j$1_10_2));
var TXTextControl=(function(c,a){var b=c._private=c._private||{};
b.InputBoxDialog=(function(){function d(g,f){this.title=g;
this.text=f||"";
this.callback=null;
this.dialogResult=false;
this.loadedBound=this.loaded.bind(this);
this.dialogContainerID="dialogContainer"+randomIntFromInterval(10000,99999);
}d.prototype.OKHandler=function(f){this.text=a("#txtInputBox").val();
this.dialogResult=true;
this.close(f);
};
d.prototype.close=function(g){if(this.callback){if(this.dialogResult){this.callback(this.text);
}}else{var f={text:this.text,dialogResult:this.dialogResult};
b.sendCommand(b.Command.DialogResult,b.HTMLDialogType.InputBoxDialog,0,0,f);
}a(g).dialog("destroy").remove();
a("#"+this.dialogContainerID).remove();
if(!b.isTouchDevice){b.textViewer.focus();
}};
d.prototype.init=function(f){a("#txtInputBox").val(this.text);
};
function e(i){var g=document.getElementById("btnOK_"+i.dialogContainerID);
var h=g.querySelector("span.ui-button-text");
h.textContent=b.variousMessages.defaultButtonTexts.btnOK;
var f=document.getElementById("btnCancel_"+i.dialogContainerID);
h=f.querySelector("span.ui-button-text");
h.textContent=b.variousMessages.defaultButtonTexts.btnCancel;
}d.prototype.loaded=function(){var f=this;
a("#inputBoxDialog").dialog({modal:true,resizable:false,width:"auto",height:110,title:this.title||"Input Box",buttons:{OK:{text:"OK",click:function(){f.OKHandler(this);
},id:"btnOK_"+this.dialogContainerID},Cancel:{text:"Cancel",click:function(){f.close(this);
},id:"btnCancel_"+this.dialogContainerID}},close:function(){f.close(this);
},open:function(){f.init(this);
},}).keypress(function(g){if(g.keyCode==a.ui.keyCode.ENTER){f.OKHandler(this);
return false;
}});
e(this);
};
d.prototype.showModal=function(f){this.callback=f;
var h=document.getElementById("txTemplateDesignerContainer"),i=document.createElement("div");
i.id=this.dialogContainerID;
h.appendChild(i);
var j="";
if(typeof TXSettings!=="undefined"){j=TXSettings.AppVirtualPath+TXSettings.BasePath;
}var g=a("#"+this.dialogContainerID);
g.load(j+"Dialogs/InputBoxDialog.html",this.loadedBound);
};
return d;
})();
return c;
}(TXTextControl||{},j$1_10_2));
var TXTextControl=(function(c,a){var b=c._private=c._private||{};
b.LoadDictionaryDialog=(function(d){__extends(g,d);
function g(h){d.call(this);
this.DialogInfo={DialogType:b.HTMLDialogType.LoadDictionaryDialog,ElementID:"loadDictionaryDialog",FileName:"LoadDictionaryDialog.html",TitleResourceName:"LOAD_DICT_DIALOG_TITLE"};
this.availableDicts=h.AvailableDicts;
this.loadedDicts=h.LoadedDicts;
}function f(n){var m=[];
var j=document.querySelectorAll("#loadDictionaryDialog input[type=checkbox]");
for(var l=0;
l<j.length;
++l){var h=j[l];
if(!h.disabled&&h.checked){var k=h.getAttribute("data-dict-name");
m.push(k);
}}return m;
}g.prototype.closing=function(){if(this.dialogData.dialogResult){this.dialogData.selected=f(this);
}};
function e(h,q){var m=document.getElementById("dictNameCheckBoxContanier");
m.innerHTML="";
for(var p=0;
p<h.length;
++p){var l=h[p];
var k="chkDictName"+p;
var n=document.createElement("input");
n.id=k;
n.setAttribute("type","checkbox");
n.setAttribute("data-dict-name",l);
n.title=l;
n.style.cssFloat="left";
n.style.clear="left";
var j=q.contains(function(i){return(l===i);
});
if(j){n.checked=true;
n.disabled=true;
}m.appendChild(n);
var o=document.createElement("label");
o.setAttribute("for",k);
o.textContent=l;
o.title=l;
o.style.cssFloat="left";
m.appendChild(o);
}}g.prototype.dialogReady=function(h){e(h.availableDicts,h.loadedDicts);
};
g.prototype.applyStringResources=function(h){this.setDefaultBtnTexts(h);
};
return g;
})(b.HTMLDialog);
return c;
}(TXTextControl||{},j$1_10_2));
var TXTextControl=(function(d,a){var b=d._private=d._private||{};
b.TXStreamType={HTMLFormat:4,RichTextFormat:8,PlainText:16,InternalUnicodeFormat:32,MSWord:64,AdobePDF:512,WordprocessingML:1024};
var e={BMP:1,PNG:2,GIF:3,JPG:4,WMF:5,EMF:6,TIF:7};
var c={XML:1};
b.OpenFileDialog=(function(f){__extends(s,f);
function s(w,x){f.call(this);
this.DialogInfo={DialogType:b.HTMLDialogType.OpenFileDialog,ElementID:"openFileDialog",FileName:"OpenFileDialog.html",TitleResourceName:"OPEN_FILE_DIALOG_TITLE"};
this.command=w||b.Command.OpenFile;
this.fileType=x||b.FileType.Document;
this.imageDataURLs={dir:"",file:""};
this.altTexts={fileName:"",dirName:""};
this.dirNames=[];
this.fileNames=[];
this.fileFilters=[];
this.fileFilterAll="";
this.fileListReceivedHandlerBound=this.fileListReceivedHandler.bind(this);
this.fileTypeChangeHandlerBound=this.fileTypeChangeHandler.bind(this);
this.fileNameChangeHandlerBound=this.fileNameChangeHandler.bind(this);
}s.prototype.closing=function(){document.removeEventListener("fileListReceived",this.fileListReceivedHandlerBound);
if(this.dialogData.dialogResult){var x=document.getElementById("txOFDTxtFileName");
var w=x.value;
if(w&&(w!=="")){b.sendCommand(this.command,this.fileType,0,0,w);
}}};
function k(w){while(w&&w.tagName!=="TR"){w=w.parentElement;
}return w;
}function r(x,w){x.dialogData.dialogResult=true;
x.close(a("#"+x.DialogInfo.ElementID));
}function q(w){var x=document.getElementById("txOFDTxtFileName");
x.value="";
b.sendCommand(b.Command.OpenDirectory,0,0,0,w);
}function m(w){switch(w){case e.BMP:return["bmp"];
case e.EMF:return["emf"];
case e.GIF:return["gif"];
case e.JPG:return["jpg","jpeg"];
case e.PNG:return["png"];
case e.TIF:return["tif"];
case e.WMF:return["wmf"];
}return[];
}function g(w){switch(w){case c.XML:return["xml"];
}return[];
}function v(w){switch(w){case b.TXStreamType.MSWord:return["doc"];
case b.TXStreamType.WordprocessingML:return["docx"];
case b.TXStreamType.HTMLFormat:return["htm","html"];
case b.TXStreamType.AdobePDF:return["pdf"];
case b.TXStreamType.RichTextFormat:return["rtf"];
case b.TXStreamType.InternalUnicodeFormat:return["tx"];
case b.TXStreamType.PlainText:return["txt"];
}return[];
}function i(x,w){if(!x||!x.length){return w;
}var y=[];
w.forEach(function(A){var z=A.split(".").pop().toLowerCase();
if(x.contains(function(B){return B===z;
})){y.push(A);
}});
return y;
}function j(w,x){if(x==0){return[];
}switch(w){case b.FileType.Document:return v(x);
case b.FileType.Image:return m(x);
case b.FileType.DataBase:return g(x);
}}function n(w){if(!w){return false;
}return w.classList.contains("txOFDItemTypeDir");
}function p(w){if(!w){return false;
}return w.classList.contains("txOFDItemTypeFile");
}function u(B){var C=document.getElementById("txOFDTblFilesAndFolders");
var F=document.getElementById("txOFDSelFileType");
for(var z=C.children.length-1;
z>=0;
--z){var w=C.children[z];
if(w.tagName==="TR"){C.removeChild(w);
}}var A=parseInt(F.value,10);
var y=j(B.fileType,A);
var x=i(y,B.fileNames);
B.dirNames.forEach(function(G){var K=document.createElement("TR");
var I=document.createElement("TD");
var J=document.createElement("TD");
var H=document.createElement("IMG");
K.classList.add("txOFDItemTypeDir");
H.alt=B.altTexts.dirName;
H.src=B.imageDataURLs.dir;
J.textContent=G;
I.appendChild(H);
K.appendChild(I);
K.appendChild(J);
C.appendChild(K);
});
x.forEach(function(K){var J=document.createElement("TR");
var H=document.createElement("TD");
var I=document.createElement("TD");
var G=document.createElement("IMG");
J.classList.add("txOFDItemTypeFile");
G.alt=B.altTexts.fileName;
G.src=B.imageDataURLs.file;
I.textContent=K;
H.appendChild(G);
J.appendChild(H);
J.appendChild(I);
C.appendChild(J);
});
function D(H){var G=document.getElementById("btnOK_"+B.dialogContainerID);
var J=k(H.target);
if(J){a("#txOFDTblFilesAndFolders tr.selected").removeClass("selected");
J.classList.add("selected");
var K=document.getElementById("txOFDTxtFileName");
var I=J.children[1];
if(p(J)){h(G,true);
K.value=I.textContent;
}else{if(n(J)){h(G,true);
K.value="";
}}}}function E(H){var G=document.getElementById("btnOK_"+B.dialogContainerID);
var J=k(H.target);
if(J){var I=J.children[1];
if(n(J)){h(G,false);
q(I.textContent);
}else{if(p(J)){r(B,I.textContent);
}}}}a("#txOFDTblFilesAndFolders tr").click(D);
a("#txOFDTblFilesAndFolders tr").dblclick(E);
}function t(z){var A=document.getElementById("txOFDSelFileType");
var w=document.createElement("OPTION");
w.value="0";
w.textContent=z.fileFilterAll;
A.appendChild(w);
for(var y=0;
y<z.fileFilters.length;
++y){var x=z.fileFilters[y];
w=document.createElement("OPTION");
w.value=x.Value;
w.textContent=x.Text;
if(y==0){w.selected=true;
}A.appendChild(w);
}}s.prototype.fileTypeChangeHandler=function(x){var w=document.getElementById("btnOK_"+this.dialogContainerID);
var y=document.getElementById("txOFDTxtFileName");
h(w,false);
y.value="";
u(this);
};
function h(w,x){if(x){w.removeAttribute("disabled");
w.classList.remove("ui-state-disabled");
}else{w.setAttribute("disabled","disabled");
w.classList.add("ui-state-disabled");
}}function l(){return document.querySelector("#txOFDTblFilesAndFolders tr.selected");
}function o(){var w=l();
return(w&&n(w));
}s.prototype.fileNameChangeHandler=function(x){a("#txOFDTblFilesAndFolders tr.selected").removeClass("selected");
var w=document.getElementById("btnOK_"+this.dialogContainerID);
var y=document.getElementById("txOFDTxtFileName");
if(y.value.length||o()){h(w,true);
}else{h(w,false);
}};
s.prototype.fileListReceivedHandler=function(w){this.fileNames=w.detail.fileNames;
this.dirNames=w.detail.dirNames;
u(this);
};
s.prototype.OKHandler=function(x){if(o()){var y=document.querySelector("#txOFDTblFilesAndFolders tr.selected").children[1];
var w=document.getElementById("btnOK_"+this.dialogContainerID);
h(w,false);
q(y.textContent);
}else{this.dialogData.dialogResult=true;
this.close(x);
}};
s.prototype.dialogReady=function(x){document.addEventListener("fileListReceived",this.fileListReceivedHandlerBound);
b.sendCommand(b.Command.GetFileList,this.fileType);
var z=document.getElementById("txOFDTxtFileName");
z.value="";
var w=document.getElementById("btnOK_"+this.dialogContainerID);
h(w,false);
var y=document.getElementById("txOFDSelFileType");
y.addEventListener("change",this.fileTypeChangeHandlerBound);
z.addEventListener("change",this.fileNameChangeHandlerBound);
z.addEventListener("input",this.fileNameChangeHandlerBound);
};
s.prototype.applyStringResources=function(w){a("#OPEN_FILE_DIALOG_LBL_FILENAME").text(w.OPEN_FILE_DIALOG_LBL_FILENAME);
a("#OPEN_FILE_DIALOG_LBL_FILETYPE").text(w.OPEN_FILE_DIALOG_LBL_FILETYPE);
this.imageDataURLs.dir=w.ImageDataURLs.Dir;
this.altTexts.fileName=w.OPEN_FILE_DIALOG_ALT_TXT_FILE_NAME;
this.altTexts.dirName=w.OPEN_FILE_DIALOG_ALT_TXT_DIR_NAME;
this.setDefaultBtnTexts(w);
this.fileFilterAll=w.FileTypes.All;
switch(this.fileType){case b.FileType.Document:this.fileFilters=w.FileTypes.Document;
this.imageDataURLs.file=w.ImageDataURLs.Document;
break;
case b.FileType.Image:this.fileFilters=w.FileTypes.Image;
this.imageDataURLs.file=w.ImageDataURLs.Image;
break;
case b.FileType.DataBase:this.fileFilters=w.FileTypes.DataBase;
this.imageDataURLs.file=w.ImageDataURLs.DataBase;
break;
}t(this);
};
return s;
})(b.HTMLDialog);
return d;
}(TXTextControl||{},j$1_10_2));
var TXTextControl=(function(c,a){var b=c._private=c._private||{};
b.WaitDialog=(function(d){__extends(e,d);
function e(g,f){d.call(this);
this.DialogInfo={DialogType:b.HTMLDialogType.WaitDialog,ElementID:"waitDialog",Width:"auto",Height:100,FileName:"WaitDialog.html",TitleResourceName:"WAIT_DLG_TITLE",DialogClass:"no-close",Buttons:{},};
this.title=g;
this.message=f;
}e.prototype.loaded=function(){var f={WAIT_DLG_LABEL_MESSAGE:this.message,WAIT_DLG_TITLE:this.title};
this.dialogize(f);
};
e.prototype.applyStringResources=function(f){a("#WAIT_DLG_LABEL_MESSAGE").text(f.WAIT_DLG_LABEL_MESSAGE);
};
e.prototype.dialogReady=function(){var g=a("#waitDialog"),h=g.css("margin-left"),f={width:g.css("border-left-width"),color:g.css("border-left-color"),style:g.css("border-left-style")};
g.css("border-bottom-width",f.width);
g.css("border-bottom-color",f.color);
g.css("border-bottom-style",f.style);
g.css("margin-bottom",h);
};
return e;
})(b.HTMLDialog);
return c;
}(TXTextControl||{},j$1_10_2));
var TXTextControl=(function(f,a){var b=f._private=f._private||{},g={None:0,CreateFile:8192,OverwriteFile:16384,Inline:32768},c={AllowAuthoring:1,AllowAuthoringFields:2,AllowContentAccessibility:4,AllowDocumentAssembly:8,AllowExtractContents:16,AllowGeneralEditing:32,AllowHighLevelPrinting:64,AllowLowLevelPrinting:128,AllowAll:255,},e={Disabled:-1,All:0,OnlyCorrect:1},d={Disabled:-1,All:0,OnlyAtBegin:1,OnlyWhenBeginIsUpper:2};
b.OptionsDialog=(function(h){__extends(m,h);
function m(r){h.call(this);
this.DialogInfo={DialogType:b.HTMLDialogType.OptionsDialog,ElementID:"optionsDialog",Width:540,Height:600,FileName:"OptionsDialog.html",TitleResourceName:"OPTIONS_DIALOG_TITLE"};
this.options=r;
this.errorMessages={permPwdEmpty:"",samePwd:"",docPwdEmpty:""};
}function i(s){var r=[],t=new Uint8Array(s),w=t.byteLength;
for(var u=0;
u<w;
u++){r.push(String.fromCharCode(t[u]));
}var v=r.join("");
return window.btoa(v);
}m.prototype.OKHandler=function(t){var r=document.getElementById("chkMasterPassword"),u=document.getElementById("txtMasterPassword"),s=document.getElementById("chkUserPassword"),v=document.getElementById("txtUserPassword");
if(r.checked&&(u.value.length==0)){b.jQueryAlert(this.caption,this.errorMessages.permPwdEmpty);
return;
}if(s.checked&&(v.value.length==0)){b.jQueryAlert(this.caption,this.errorMessages.docPwdEmpty);
return;
}if(r.checked&&s.checked&&(u.value===v.value)){b.jQueryAlert(this.caption,this.errorMessages.samePwd);
return;
}this.dialogData.dialogResult=true;
this.close(t);
};
function l(){var u=document.getElementById("chkIgnoreUpper"),y=document.getElementById("selIgnoreUpper"),s=document.getElementById("chkIgnoreCntNums"),w=document.getElementById("chkIgnoreURLs"),t=document.getElementById("chkIgnoreEmails"),r=document.getElementById("chkFlagRepeatedWords"),v=document.getElementById("chkIgnoreUpperAndLower"),z=document.getElementById("selIgnoreUpperLower");
var x={ignoreUpperCaseWords:e.All,ignoreContNums:true,ignoreURLs:true,ignoreEmails:true,flagRepeated:true,ignoreAll:d.OnlyWhenBeginIsUpper};
if(!u.checked){x.ignoreUpperCaseWords=e.Disabled;
}else{x.ignoreUpperCaseWords=y.selectedIndex;
}x.ignoreContNums=s.checked;
x.ignoreURLs=w.checked;
x.ignoreEmails=t.checked;
x.flagRepeated=r.checked;
if(!v.checked){x.ignoreAll=d.Disabled;
}else{x.ignoreAll=z.selectedIndex;
}return x;
}m.prototype.close=function(s){var r={dialogResult:this.dialogData.dialogResult};
if(this.dialogData.dialogResult){r.cssSaveMode=j();
r.reqPDFDocPwd=document.getElementById("chkUserPassword").checked;
r.pdfDocPwd=document.getElementById("txtUserPassword").value;
r.reqPwdPrintEdit=document.getElementById("chkMasterPassword").checked;
r.pdfPermPwd=document.getElementById("txtMasterPassword").value;
r.docAccessPerms=k();
r.pdfa=document.getElementById("chkEnPDFAExp").checked;
r.hyphEnabled=document.getElementById("chkEnableHyphenation").checked;
r.langDetectEnabled=document.getElementById("chkEnableLangDetect").checked;
r.spellCheckEnabled=document.getElementById("chkEnableSpellCheck").checked;
r.pfxFilePassword=document.getElementById("txtPDFCertPwd").value;
if(this.options.IsTXSpellAssemblyPresent){r.spellChecking=l();
}var u=document.getElementById("txtPDFCertFile"),t=u.files;
if(t.length){var w=this,v=new FileReader();
v.onloadend=function(){var x=i(v.result);
r.pfxFile=x;
b.sendCommand(b.Command.DialogResult,w.DialogInfo.DialogType,0,0,r);
};
v.readAsArrayBuffer(t[0]);
}else{b.sendCommand(b.Command.DialogResult,this.DialogInfo.DialogType,0,0,r);
}}else{b.sendCommand(b.Command.DialogResult,this.DialogInfo.DialogType,0,0,r);
}a(s).dialog("destroy").remove();
a("#"+this.dialogContainerID).remove();
if(!b.isTouchDevice){b.textViewer.focus();
}};
function j(){if(document.getElementById("rbCSSOptsNoStSh").checked){return g.None;
}else{if(document.getElementById("rbCSSOptsInlStSh").checked){return g.Inline;
}}}function k(){var t=0,v=document.getElementById("selPDFPrintAllowed"),u=document.getElementById("selPDFChngAllow"),s=document.getElementById("chkPDFAllowContentAccessibility"),r=document.getElementById("chkAllowExtractContents");
switch(v.selectedIndex){case 1:t|=c.AllowLowLevelPrinting;
break;
case 2:t|=c.AllowHighLevelPrinting;
break;
}switch(u.selectedIndex){case 1:t|=c.AllowDocumentAssembly;
break;
case 2:t|=c.AllowAuthoringFields;
break;
case 3:t|=c.AllowAuthoring;
break;
case 4:t|=c.AllowAuthoring|c.AllowDocumentAssembly|c.AllowGeneralEditing;
break;
}if(s.checked){t|=c.AllowContentAccessibility;
}if(r.checked){t|=c.AllowExtractContents;
}return t;
}function n(r){switch(r.CssSaveMode){case g.None:document.getElementById("rbCSSOptsNoStSh").checked=true;
break;
case g.Inline:document.getElementById("rbCSSOptsInlStSh").checked=true;
break;
}}function o(t){var u=t.PDFDocumentAccessPermissions,w=document.getElementById("selPDFPrintAllowed"),v=document.getElementById("selPDFChngAllow"),s=document.getElementById("chkPDFAllowContentAccessibility"),r=document.getElementById("chkAllowExtractContents");
if((u&c.AllowAuthoring)&&(u&c.AllowDocumentAssembly)&&(u&c.AllowGeneralEditing)){v.selectedIndex=4;
}else{if(u&c.AllowAuthoring){v.selectedIndex=3;
}else{if(u&c.AllowAuthoringFields){v.selectedIndex=2;
}else{if(u&c.AllowDocumentAssembly){v.selectedIndex=1;
}}}}if(u&c.AllowHighLevelPrinting){w.selectedIndex=2;
}else{if(u&c.AllowLowLevelPrinting){w.selectedIndex=1;
}}r.checked=(u&c.AllowExtractContents);
s.checked=(u&c.AllowContentAccessibility);
}function p(z){var u=document.getElementById("chkIgnoreUpper"),x=document.getElementById("selIgnoreUpper"),s=document.getElementById("chkIgnoreCntNums"),w=document.getElementById("chkIgnoreURLs"),t=document.getElementById("chkIgnoreEmails"),r=document.getElementById("chkFlagRepeatedWords"),v=document.getElementById("chkIgnoreUpperAndLower"),y=document.getElementById("selIgnoreUpperLower");
u.checked=true;
switch(z.IgnoreUpperCaseWords){case e.Disabled:u.checked=false;
x.disabled=true;
break;
default:x.selectedIndex=z.IgnoreUpperCaseWords;
break;
}s.checked=z.IgnoreContainingNumbers;
w.checked=z.IgnoreURLs;
t.checked=z.IgnoreEmailAddresses;
r.checked=z.FlagRepeatedWords;
v.checked=true;
switch(z.IgnoreAll){case d.Disabled:v.checked=false;
y.disabled=true;
break;
default:y.selectedIndex=z.IgnoreAll;
break;
}}function q(z){var D=document.getElementById("txtPDFCertPwd"),y=document.getElementById("chkUserPassword"),E=document.getElementById("txtUserPassword"),w=document.getElementById("chkMasterPassword"),C=document.getElementById("txtMasterPassword"),v=document.getElementById("chkEnPDFAExp"),s=document.getElementById("chkEnableHyphenation"),t=document.getElementById("chkEnableLangDetect"),u=document.getElementById("chkEnableSpellCheck"),B=document.getElementById("selPDFPrintAllowed"),A=document.getElementById("selPDFChngAllow"),x=document.getElementById("chkPDFAllowContentAccessibility"),r=document.getElementById("chkAllowExtractContents");
n(z);
o(z);
D.value=z.PDFCertFilePwd;
y.checked=z.RequireUserPwd;
E.disabled=!z.RequireUserPwd;
E.value=z.PDFUserPwd;
w.checked=z.RequireMasterPwd;
C.disabled=B.disabled=A.disabled=x.disabled=r.disabled=!z.RequireMasterPwd;
C.value=z.PDFMasterPwd;
v.checked=z.PDFA;
if(z.IsTXSpellAssemblyPresent){s.checked=z.IsHyphenationEnabled;
t.checked=z.IsLanguageDetectionEnabled;
u.checked=z.IsSpellCheckingEnabled;
if(z.IsSpellCheckingEnabled){p(z.SpellCheckSettings);
}else{a("#optionsDialogTabs").tabs("option","disabled",[4]);
}}else{a("#optionsDialogTabs").tabs("option","disabled",[3,4]);
}}m.prototype.dialogReady=function(z){a("#optionsDialogTabs").tabs();
q(z.options);
function w(A){var B=document.getElementById("txtUserPassword");
B.disabled=!this.checked;
}var y=document.getElementById("chkUserPassword");
y.addEventListener("click",w);
function x(C){var F=document.getElementById("txtMasterPassword"),E=document.getElementById("selPDFPrintAllowed"),D=document.getElementById("selPDFChngAllow"),B=document.getElementById("chkPDFAllowContentAccessibility"),A=document.getElementById("chkAllowExtractContents");
F.disabled=E.disabled=D.disabled=B.disabled=A.disabled=!this.checked;
}var v=document.getElementById("chkMasterPassword");
v.addEventListener("click",x);
function u(A){var B=document.getElementById("selIgnoreUpper");
B.disabled=!this.checked;
}var r=document.getElementById("chkIgnoreUpper");
r.addEventListener("click",u);
function t(A){var B=document.getElementById("selIgnoreUpperLower");
B.disabled=!this.checked;
}var s=document.getElementById("chkIgnoreUpperAndLower");
s.addEventListener("click",t);
};
m.prototype.applyStringResources=function(r){a("#OPTIONS_DIALOG_TAB_HTML").text(r.OPTIONS_DIALOG_TAB_HTML);
a("#OPTIONS_DIALOG_TAB_PDF_SEC").text(r.OPTIONS_DIALOG_TAB_PDF_SEC);
a("#OPTIONS_DIALOG_TAB_PDF_EXP").text(r.OPTIONS_DIALOG_TAB_PDF_EXP);
a("#OPTIONS_DIALOG_GRP_STYLESH_SAV_OPTS > legend").text(r.OPTIONS_DIALOG_GRP_STYLESH_SAV_OPTS);
a("#OPTIONS_DIALOG_LBL_CSS_OPTS_NO_STSH").text(r.OPTIONS_DIALOG_LBL_CSS_OPTS_NO_STSH);
a("#OPTIONS_DIALOG_LBL_CSS_OPTS_INL_STSH").text(r.OPTIONS_DIALOG_LBL_CSS_OPTS_INL_STSH);
a("#OPTIONS_DIALOG_GRP_PDF_DIG_SIG > legend").text(r.OPTIONS_DIALOG_GRP_PDF_DIG_SIG);
a("#OPTIONS_DIALOG_GRP_PDF_PWD > legend").text(r.OPTIONS_DIALOG_GRP_PDF_PWD);
a("#OPTIONS_DIALOG_GRP_PDF_PERM > legend").text(r.OPTIONS_DIALOG_GRP_PDF_PERM);
a("#OPTIONS_DIALOG_LBL_PDF_CERT_FILE").text(r.OPTIONS_DIALOG_LBL_PDF_CERT_FILE);
a("#OPTIONS_DIALOG_LBL_PDF_CERT_PWD").text(r.OPTIONS_DIALOG_LBL_PDF_CERT_PWD);
a("#OPTIONS_DIALOG_LBL_PDF_REQ_PWD").text(r.OPTIONS_DIALOG_LBL_PDF_REQ_PWD);
a("#OPTIONS_DIALOG_LBL_PDF_DOC_PWD").text(r.OPTIONS_DIALOG_LBL_PDF_DOC_PWD);
a("#OPTIONS_DIALOG_LBL_PDF_REQ_PWD_PRINT").text(r.OPTIONS_DIALOG_LBL_PDF_REQ_PWD_PRINT);
a("#OPTIONS_DIALOG_LBL_PDF_PERM_PWD").text(r.OPTIONS_DIALOG_LBL_PDF_PERM_PWD);
a("#OPTIONS_DIALOG_LBL_PDF_PRINT_ALLOWED").text(r.OPTIONS_DIALOG_LBL_PDF_PRINT_ALLOWED);
a("#OPTIONS_DIALOG_OPT_PDF_PRINT_ALLOWED_NONE").text(r.OPTIONS_DIALOG_OPT_PDF_PRINT_ALLOWED_NONE);
a("#OPTIONS_DIALOG_OPT_PDF_PRINT_ALLOWED_LO_RES").text(r.OPTIONS_DIALOG_OPT_PDF_PRINT_ALLOWED_LO_RES);
a("#OPTIONS_DIALOG_OPT_PDF_PRINT_ALLOWED_HI_RES").text(r.OPTIONS_DIALOG_OPT_PDF_PRINT_ALLOWED_HI_RES);
a("#OPTIONS_DIALOG_LBL_PDF_CHNG_ALLOW").text(r.OPTIONS_DIALOG_LBL_PDF_CHNG_ALLOW);
a("#OPTIONS_DIALOG_OPT_PDF_CHNG_ALLOW_NONE").text(r.OPTIONS_DIALOG_OPT_PDF_CHNG_ALLOW_NONE);
a("#OPTIONS_DIALOG_OPT_PDF_CHNG_ALLOW_INS_DEL").text(r.OPTIONS_DIALOG_OPT_PDF_CHNG_ALLOW_INS_DEL);
a("#OPTIONS_DIALOG_OPT_PDF_CHNG_ALLOW_FRM_FLD_SIGN").text(r.OPTIONS_DIALOG_OPT_PDF_CHNG_ALLOW_FRM_FLD_SIGN);
a("#OPTIONS_DIALOG_OPT_PDF_CHNG_ALLOW_COMMENT_FRM_FLD").text(r.OPTIONS_DIALOG_OPT_PDF_CHNG_ALLOW_COMMENT_FRM_FLD);
a("#OPTIONS_DIALOG_OPT_PDF_CHNG_ALLOW_ANY").text(r.OPTIONS_DIALOG_OPT_PDF_CHNG_ALLOW_ANY);
a("#OPTIONS_DIALOG_GRP_PDF_EXP_OPTS > legend").text(r.OPTIONS_DIALOG_GRP_PDF_EXP_OPTS);
a("#OPTIONS_DIALOG_CHK_EN_PDFA").text(r.OPTIONS_DIALOG_CHK_EN_PDFA);
a("#OPTIONS_DIALOG_LBL_PDF_ALLOW_CONT_ACC").text(r.OPTIONS_DIALOG_LBL_PDF_ALLOW_CONT_ACC);
a("#OPTIONS_DIALOG_LBL_PDF_ALLOW_EXTR_CONT").text(r.OPTIONS_DIALOG_LBL_PDF_ALLOW_EXTR_CONT);
a("#OPTIONS_DIALOG_TAB_PROOFING").text(r.OPTIONS_DIALOG_TAB_PROOFING);
a("#OPTIONS_DIALOG_GRP_PROOF_OPTS > legend").text(r.OPTIONS_DIALOG_GRP_PROOF_OPTS);
a("#OPTIONS_DIALOG_LBL_PROOF_SPELL_CHECK").text(r.OPTIONS_DIALOG_LBL_PROOF_SPELL_CHECK);
a("#OPTIONS_DIALOG_LBL_PROOF_HYPHEN").text(r.OPTIONS_DIALOG_LBL_PROOF_HYPHEN);
a("#OPTIONS_DIALOG_LBL_PROOF_LANGDETECT").text(r.OPTIONS_DIALOG_LBL_PROOF_LANGDETECT);
a("#OPTIONS_DIALOG_TAB_SPELL_CHECK").text(r.OPTIONS_DIALOG_TAB_SPELL_CHECK);
this.setDefaultBtnTexts(r);
if(r.TXSpell){a("#LBL_IGNORE_UPPERCASE").text(r.TXSpell.LBL_IGNORE_UPPERCASE);
a("#ITM_UPPERCASE_ALL").text(r.TXSpell.ITM_UPPERCASE_ALL);
a("#ITM_UPPERCASE_ONLY_CORRECT").text(r.TXSpell.ITM_UPPERCASE_ONLY_CORRECT);
a("#LBL_IGNORE_WORD_WITH_NUMBERS").text(r.TXSpell.LBL_IGNORE_WORD_WITH_NUMBERS);
a("#LBL_IGNORE_INTERNET_ADDRESSES").text(r.TXSpell.LBL_IGNORE_INTERNET_ADDRESSES);
a("#LBL_IGNORE_EMAIL_ADDRESSES").text(r.TXSpell.LBL_IGNORE_EMAIL_ADDRESSES);
a("#LBL_FLAG_REPEATED_WORDS").text(r.TXSpell.LBL_FLAG_REPEATED_WORDS);
a("#LBL_IGNORE_CASE").text(r.TXSpell.LBL_IGNORE_CASE);
a("#ITM_CASE_ALL").text(r.TXSpell.ITM_CASE_ALL);
a("#ITM_CASE_WORD_BEGIN_ALWAYS").text(r.TXSpell.ITM_CASE_WORD_BEGIN_ALWAYS);
a("#ITM_CASE_WORD_BEGIN_IS_UPPER").text(r.TXSpell.ITM_CASE_WORD_BEGIN_IS_UPPER);
}this.errorMessages.docPwdEmpty=r.OPTIONS_DIALOG_DOC_PWD_EMPTY_ERROR;
this.errorMessages.permPwdEmpty=r.OPTIONS_DIALOG_PERM_PWD_EMPTY_ERROR;
this.errorMessages.samePwd=r.OPTIONS_DIALOG_SAME_PWD_ERROR;
};
return m;
})(b.HTMLDialog);
return f;
}(TXTextControl||{},j$1_10_2));
var TXTextControl=(function(d,a){var b=d._private=d._private||{};
var c={Line:3,Bar:7,Column:10,Area:13,Pie:17};
b.ChartSettingsDialog=(function(e){__extends(f,e);
function f(k){e.call(this);
this.DialogInfo={DialogType:b.HTMLDialogType.ChartSettingsDialog,ElementID:"chartSettingsDialog",Width:"auto",FileName:"ChartSettingsDialog.html",TitleResourceName:"CHART_SETTINGS_DLG_TITLE",};
this.settings=k;
}function g(){switch(a("#chartSettingsDialog input[name=optGroupChartType]:checked")[0].id){case"optChartType_Area":return c.Area;
break;
case"optChartType_Bar":return c.Bar;
break;
case"optChartType_Column":return c.Column;
break;
case"optChartType_Line":return c.Line;
break;
case"optChartType_Pie":return c.Pie;
break;
}}function h(k){k.ChartType=g();
k.Is3D=document.getElementById("chkChart3D").checked;
k.IsRightAngleAxes=document.getElementById("chkChartRightAngleAxes").checked;
k.Inclination=parseInt(document.getElementById("spinChartIncl").value,10);
k.Perspective=parseInt(document.getElementById("spinChartPersp").value,10);
k.Rotation=parseInt(document.getElementById("spinChartRot").value,10);
}f.prototype.closing=function(){if(this.dialogData.dialogResult){h(this.settings);
this.dialogData.settings=this.settings;
}};
function i(k){switch(k){case c.Area:document.getElementById("optChartType_Area").checked=true;
break;
case c.Bar:document.getElementById("optChartType_Bar").checked=true;
break;
case c.Column:document.getElementById("optChartType_Column").checked=true;
break;
case c.Line:document.getElementById("optChartType_Line").checked=true;
break;
case c.Pie:document.getElementById("optChartType_Pie").checked=true;
break;
}}function j(m){var n=m.settings;
a("#spinChartIncl").val(n.Inclination);
a("#spinChartPersp").val(n.Perspective);
a("#spinChartRot").val(n.Rotation);
var k=document.getElementById("chkChart3D"),o=document.getElementById("spinChartIncl"),p=document.getElementById("spinChartPersp"),q=document.getElementById("spinChartRot"),l=document.getElementById("chkChartRightAngleAxes");
k.checked=n.Is3D;
o.disabled=p.disabled=q.disabled=l.disabled=!n.Is3D;
l.checked=n.IsRightAngleAxes;
i(n.ChartType);
k.addEventListener("click",function(){a(".chart3DSettingsSpinners").spinner("option","disabled",!k.checked);
l.disabled=!k.checked;
});
}f.prototype.applyStringResources=function(k){a("#CHART_SETTINGS_DLG_GRP_TYPE > legend").text(k.CHART_SETTINGS_DLG_GRP_TYPE);
a("#CHART_SETTINGS_DLG_LBL_OPT_CHART_TYPE_AREA").text(k.CHART_SETTINGS_DLG_LBL_OPT_CHART_TYPE_AREA);
a("#CHART_SETTINGS_DLG_LBL_OPT_CHART_TYPE_BAR").text(k.CHART_SETTINGS_DLG_LBL_OPT_CHART_TYPE_BAR);
a("#CHART_SETTINGS_DLG_LBL_OPT_CHART_TYPE_COLUMN").text(k.CHART_SETTINGS_DLG_LBL_OPT_CHART_TYPE_COLUMN);
a("#CHART_SETTINGS_DLG_LBL_OPT_CHART_TYPE_LINE").text(k.CHART_SETTINGS_DLG_LBL_OPT_CHART_TYPE_LINE);
a("#CHART_SETTINGS_DLG_LBL_OPT_CHART_TYPE_PIE").text(k.CHART_SETTINGS_DLG_LBL_OPT_CHART_TYPE_PIE);
a("#CHART_SETTINGS_DLG_LBL_OPT_3D").text(k.CHART_SETTINGS_DLG_LBL_OPT_3D);
a("#CHART_SETTINGS_DLG_LBL_INCL").text(k.CHART_SETTINGS_DLG_LBL_INCL);
a("#CHART_SETTINGS_DLG_LBL_PERSP").text(k.CHART_SETTINGS_DLG_LBL_PERSP);
a("#CHART_SETTINGS_DLG_LBL_ROT").text(k.CHART_SETTINGS_DLG_LBL_ROT);
a("#CHART_SETTINGS_DLG_LBL_OPT_RIGHT_ANGLE").text(k.CHART_SETTINGS_DLG_LBL_OPT_RIGHT_ANGLE);
a("#CHART_SETTINGS_DLG_BTN_LAYOUT_POS").text(k.CHART_SETTINGS_DLG_BTN_LAYOUT_POS);
this.setDefaultBtnTexts(k);
};
f.prototype.dialogReady=function(k){a("#spinChartIncl").spinner({max:90,min:-90});
a("#spinChartPersp").spinner({max:100,min:0});
a("#spinChartRot").spinner({max:180,min:-180});
var l=document.getElementById("CHART_SETTINGS_DLG_IMG_AREA");
l.src=b.imageResources.small.chartarea;
l=document.getElementById("CHART_SETTINGS_DLG_IMG_BAR");
l.src=b.imageResources.small.chartbar;
l=document.getElementById("CHART_SETTINGS_DLG_IMG_COLUMN");
l.src=b.imageResources.small.chartcolumn;
l=document.getElementById("CHART_SETTINGS_DLG_IMG_LINE");
l.src=b.imageResources.small.chartline;
l=document.getElementById("CHART_SETTINGS_DLG_IMG_PIE");
l.src=b.imageResources.small.chartpie;
j(k);
};
return f;
})(b.HTMLDialog);
return d;
}(TXTextControl||{},j$1_10_2));
var TXTextControl=(function(c,a){var b=c._private=c._private||{};
b.SaveDocumentAsDialog=(function(d){__extends(f,d);
function f(g,h){d.call(this);
this.DialogInfo={DialogType:b.HTMLDialogType.SaveDocumentAsDialog,ElementID:"saveDocumentAsDialog",Width:280,FileName:"SaveDocumentAsDialog.html",TitleResourceName:"SAVEDOCAS_DIALOG_TITLE"};
this.fileName=g;
this.streamType=h;
this.errorMessages={fileNameEmpty:""};
}f.prototype.OKHandler=function(g){var h=document.getElementById("txtSaveDocAsFilename").value;
if(a.trim(h)==""){b.jQueryAlert(this.caption,this.errorMessages.fileNameEmpty);
return;
}this.dialogData.dialogResult=true;
this.close(g);
};
function e(){var g=document.getElementById("selSaveAsDocType");
var h=g.options[g.selectedIndex].value;
return parseInt(h,10);
}f.prototype.closing=function(g){if(this.dialogData.dialogResult){this.dialogData.fileName=document.getElementById("txtSaveDocAsFilename").value;
this.dialogData.streamType=e();
}};
f.prototype.dialogReady=function(g){var h=document.getElementById("txtSaveDocAsFilename");
h.value=g.fileName;
a("#selSaveAsDocType").val(""+g.streamType);
};
f.prototype.applyStringResources=function(g){a("#SAVEDOCAS_DIALOG_LBL_FILENAME").text(g.SAVEDOCAS_DIALOG_LBL_FILENAME);
a("#SAVEDOCAS_DIALOG_LBL_DOC_TYPE").text(g.SAVEDOCAS_DIALOG_LBL_DOC_TYPE);
this.errorMessages.fileNameEmpty=g.SAVEDOCAS_DIALOG_FILE_NAME_EMPTY_ERROR;
this.setDefaultBtnTexts(g);
};
return f;
})(b.HTMLDialog);
return c;
}(TXTextControl||{},j$1_10_2));
var TXTextControl=(function(c,a){var b=c._private=c._private||{};
b.ClientPasteDialog=(function(d){__extends(f,d);
function f(k){d.call(this);
this.DialogInfo={DialogType:b.HTMLDialogType.ClientPasteDialog,ElementID:"clientPasteDialog",Width:300,Height:255,FileName:"ClientPasteDialog.html",TitleResourceName:"CLIENTPASTE_DIALOG_TITLE",Buttons:{}};
}function h(){var k=document.getElementById("pasteArea");
return k.innerHTML;
}function j(){var k=h();
b.pasteText(k,b.ClipboardDataType.HTML);
}f.prototype.closing=function(){b.modifierKeys=0;
};
function e(k){j();
k.close(a("#"+k.DialogInfo.ElementID));
}function i(m,k){if(!b.handleClientPaste(k,false)){m.close(a("#"+m.DialogInfo.ElementID));
return;
}var l=document.getElementById("pasteArea");
l.innerHTML="";
setTimeout(function(){e(m);
},10);
return false;
}function g(l,k){b.handleDrop(k);
l.close(a("#"+l.DialogInfo.ElementID));
return false;
}f.prototype.dialogReady=function(l){var p=this;
var m=a("#clientPasteDialog"),n=m.css("margin-left"),k={width:m.css("border-left-width"),color:m.css("border-left-color"),style:m.css("border-left-style")};
m.css("border-bottom-width",k.width);
m.css("border-bottom-color",k.color);
m.css("border-bottom-style",k.style);
m.css("margin-bottom",n);
var o=document.getElementById("pasteArea");
if(!b.isTouchDevice){o.focus();
}o.addEventListener("paste",function(q){i(p,q);
});
o.addEventListener("drop",function(q){g(p,q);
q.stopPropagation();
});
o.addEventListener("dragenter",function(q){q.preventDefault();
q.stopPropagation();
});
o.addEventListener("dragover",function(q){q.preventDefault();
q.stopPropagation();
q.dataTransfer.dropEffect="copy";
});
};
f.prototype.applyStringResources=function(k){a("#CLIENTPASTE_DIALOG_PLACEHLD_TXT").text(k.CLIENTPASTE_DIALOG_PLACEHLD_TXT);
};
return f;
})(b.HTMLDialog);
return c;
}(TXTextControl||{},j$1_10_2));
var TXTextControl=(function(d,a){var b=d._private=d._private||{};
b.SpellCheckCommand={IgnoreOnce:1,IgnoreAll:2,AddToDict:3,Change:4,ChangeAll:5,SuggestionSelected:6,SuggestionDictSelected:7,PreviewTextChanged:8};
var c=false;
b.SpellCheckDialog=(function(e){__extends(l,e);
function l(m){e.call(this);
this.DialogInfo={DialogType:b.HTMLDialogType.SpellCheckDialog,ElementID:"spellCheckDialog",FileName:"SpellCheckDialog.html",TitleResourceName:"SPELLCHECK_DIALOG_TITLE",Buttons:{}};
this.dialogStateUpdatedHandlerBound=this.dialogStateUpdatedHandler.bind(this);
this.initialState=m;
}l.prototype.btnIgnoreOnceClick=function(m){b.sendCommand(b.Command.SpellCheckCommand,b.SpellCheckCommand.IgnoreOnce);
};
l.prototype.btnIgnoreAllClick=function(m){b.sendCommand(b.Command.SpellCheckCommand,b.SpellCheckCommand.IgnoreAll);
};
l.prototype.btnAddToDictClick=function(m){b.sendCommand(b.Command.SpellCheckCommand,b.SpellCheckCommand.AddToDict);
};
l.prototype.btnChangeClick=function(m){b.sendCommand(b.Command.SpellCheckCommand,b.SpellCheckCommand.Change);
};
l.prototype.btnChangeAllClick=function(m){b.sendCommand(b.Command.SpellCheckCommand,b.SpellCheckCommand.ChangeAll);
};
var g={spanBefore:null,spanEmph:null,spanAfter:null,textContent:""};
function h(m){var n;
if(m.target.children.length!=3){m.target.innerHTML="";
m.target.appendChild(g.spanBefore);
m.target.appendChild(g.spanEmph);
m.target.appendChild(g.spanAfter);
return;
}var s=m.target.children[1],t=s.textContent,u=g.spanEmph.textContent;
if(t!==u){b.sendCommand(b.Command.SpellCheckCommand,b.SpellCheckCommand.PreviewTextChanged,0,0,t);
}else{var q=m.target.children[0],o=m.target.children[2],r=g.spanBefore,p=g.spanAfter;
if(q.textContent!==r.textContent){q.textContent=r.textContent;
}else{if(o.textContent!==p.textContent){o.textContent=p.textContent;
}else{if(m.target.textContent!==g.textContent){m.target.innerHTML="";
m.target.appendChild(g.spanBefore);
m.target.appendChild(g.spanEmph);
m.target.appendChild(g.spanAfter);
}}}}g.spanBefore=m.target.children[0].cloneNode(true);
g.spanEmph=s.cloneNode(true);
g.spanAfter=m.target.children[2].cloneNode(true);
g.textContent=m.target.textContent;
}function k(q,m){m.innerHTML="";
var u=q.Text;
var o=document.createElement("SPAN");
var n=document.createElement("SPAN");
var p=document.createElement("SPAN");
p.style.fontWeight="bold";
p.style.color="red";
p.id="txSpellDlgPrevAreaEmphWord";
o.contentEditable=false;
n.contentEditable=false;
if(q.EmphasizedAreaStart!=null){var t=u.substring(q.EmphasizedAreaStart,q.EmphasizedAreaEnd);
p.textContent=t;
var s=u.substring(0,q.EmphasizedAreaStart);
var r=u.substring(q.EmphasizedAreaEnd);
o.textContent=s;
n.textContent=r;
}else{n.textContent=u;
}m.appendChild(o);
m.appendChild(p);
m.appendChild(n);
g.spanBefore=o.cloneNode(true);
g.spanEmph=p.cloneNode(true);
g.spanAfter=n.cloneNode(true);
g.textContent=m.textContent;
}l.prototype.applyPrevAreaState=function(n){var m=document.getElementById("txSpellCheckPreviewArea");
if(n.AreaEnabled){m.contentEditable=true;
}else{m.removeAttribute("contenteditable");
}if(n.Text!=null){k(n,m);
}};
l.prototype.setSugDicts=function(q){var n=document.getElementById("txSpellCheckSelSuggDict");
n.innerHTML="";
for(var o=0;
o<q.Names.length;
++o){var p=q.Names[o];
var m=document.createElement("OPTION");
m.textContent=p;
m.value=p;
n.appendChild(m);
}if(q.SelectedDict!=null){n.value=q.SelectedDict;
}};
function i(m){if(c){return;
}b.sendCommand(b.Command.SpellCheckCommand,b.SpellCheckCommand.SuggestionDictSelected,0,0,m.target.value);
}l.prototype.setSuggestions=function(o){var p=o.Suggestions;
var m=o.NoSuggestionsCreated;
var n=document.getElementById("txSpellCheckSelSuggestions");
n.innerHTML="";
if(m){n.setAttribute("disabled","disabled");
}else{n.removeAttribute("disabled");
}p.forEach(function(r){var q=document.createElement("OPTION");
q.textContent=r;
n.appendChild(q);
});
if(!m){n.selectedIndex=0;
}};
function j(m){if(c){return;
}b.sendCommand(b.Command.SpellCheckCommand,b.SpellCheckCommand.SuggestionSelected,0,0,m.target.value);
}function f(m,n){if(n){m.removeAttribute("disabled");
m.classList.remove("ui-state-disabled");
}else{m.setAttribute("disabled","disabled");
m.classList.add("ui-state-disabled");
}}l.prototype.setButtonStates=function(r){var p=document.getElementById("ID_SPELL_BTN_IGNORE_ONCE");
if(r.BtnIgnore.Text!=null){p.textContent=r.BtnIgnore.Text;
}if(r.BtnIgnore.Enabled!=null){f(p,r.BtnIgnore.Enabled);
}var q=document.getElementById("ID_SPELL_BTN_IGNORE_ALL");
if(r.BtnIgnoreAll.Enabled!=null){f(q,r.BtnIgnoreAll.Enabled);
}var m=document.getElementById("ID_SPELL_BTN_ADD_TO_DICTIONARY");
if(r.BtnAddToDict.Enabled!=null){f(m,r.BtnAddToDict.Enabled);
}var n=document.getElementById("ID_SPELL_BTN_CHANGE");
if(r.BtnChange.Text!=null){n.textContent=r.BtnChange.Text;
}if(r.BtnChange.Enabled!=null){f(n,r.BtnChange.Enabled);
}var o=document.getElementById("ID_SPELL_BTN_CHANGE_ALL");
if(r.BtnChangeAll.Text!=null){o.textContent=r.BtnChangeAll.Text;
}if(r.BtnChangeAll.Enabled!=null){f(o,r.BtnChangeAll.Enabled);
}};
l.prototype.updateSugArea=function(n){var m=document.getElementById("txSpellCheckSelSuggDict");
if(n.CbSugDictsEnabled){m.removeAttribute("disabled");
}else{m.setAttribute("disabled","disabled");
}};
l.prototype.setDialogState=function(n){var m=document.getElementById("txSpellCheckLblLang");
if(n.LblLangText!=null){m.textContent=n.LblLangText;
}if(n.MessageBoxText!=null){b.jQueryAlert("TXSpell",n.MessageBoxText);
}if(n.CloseDialog){this.close(a("#"+this.DialogInfo.ElementID));
}};
l.prototype.applyDialogState=function(m){c=true;
if(m.Preview!=null){this.applyPrevAreaState(m.Preview);
}if(m.SugDicts!=null){this.setSugDicts(m.SugDicts);
}if(m.Suggestions!=null){this.setSuggestions(m.Suggestions);
}if(m.ButtonStates!=null){this.setButtonStates(m.ButtonStates);
}if(m.SuggestionsArea!=null){this.updateSugArea(m.SuggestionsArea);
}if(m.DialogState!=null){this.setDialogState(m.DialogState);
}c=false;
};
l.prototype.dialogStateUpdatedHandler=function(m){var n=m.detail;
this.applyDialogState(n);
};
l.prototype.applyStringResources=function(m){a("#ID_SPELL_LBL_NOT_IN_DICTIONARIES").text(m.ID_SPELL_LBL_NOT_IN_DICTIONARIES);
a("#LBL_LANGUAGE").text(m.LBL_LANGUAGE);
a("#ID_SPELL_BTN_IGNORE_ONCE").text(m.ID_SPELL_BTN_IGNORE_ONCE);
a("#ID_SPELL_BTN_IGNORE_ALL").text(m.ID_SPELL_BTN_IGNORE_ALL);
a("#ID_SPELL_BTN_ADD_TO_DICTIONARY").text(m.ID_SPELL_BTN_ADD_TO_DICTIONARY);
a("#ID_SPELL_LBL_SUGGESTIONS").text(m.ID_SPELL_LBL_SUGGESTIONS);
a("#ID_SPELL_BTN_CHANGE").text(m.ID_SPELL_BTN_CHANGE);
a("#ID_SPELL_BTN_CHANGE_ALL").text(m.ID_SPELL_BTN_CHANGE_ALL);
a("#ID_SPELL_LBL_SUGGESTIONS_DICTIONARY").text(m.ID_SPELL_LBL_SUGGESTIONS_DICTIONARY);
a("#ID_SPELL_BTN_CANCEL").text(m.ID_SPELL_BTN_CANCEL);
};
l.prototype.closing=function(){document.removeEventListener("spellCheckDialogStateUpdated",this.dialogStateUpdatedHandlerBound);
};
l.prototype.dialogReady=function(){var s=this;
var n=a("#spellCheckDialog"),r=n.css("margin-left"),m={width:n.css("border-left-width"),color:n.css("border-left-color"),style:n.css("border-left-style")};
n.css("border-bottom-width",m.width);
n.css("border-bottom-color",m.color);
n.css("border-bottom-style",m.style);
n.css("margin-bottom",r);
a("#ID_SPELL_BTN_IGNORE_ONCE").click(s.btnIgnoreOnceClick);
a("#ID_SPELL_BTN_IGNORE_ALL").click(s.btnIgnoreAllClick);
a("#ID_SPELL_BTN_ADD_TO_DICTIONARY").click(s.btnAddToDictClick);
a("#ID_SPELL_BTN_CHANGE").click(s.btnChangeClick);
a("#ID_SPELL_BTN_CHANGE_ALL").click(s.btnChangeAllClick);
a("#ID_SPELL_BTN_CANCEL").click(function(){s.close(a("#"+s.DialogInfo.ElementID));
});
this.applyDialogState(this.initialState);
document.addEventListener("spellCheckDialogStateUpdated",this.dialogStateUpdatedHandlerBound);
var q=document.getElementById("txSpellCheckSelSuggestions");
q.addEventListener("change",j);
var p=document.getElementById("txSpellCheckSelSuggDict");
p.addEventListener("change",i);
var o=document.getElementById("txSpellCheckPreviewArea");
o.addEventListener("keyup",h);
};
return l;
})(b.HTMLDialog);
return d;
}(TXTextControl||{},j$1_10_2));
var TXTextControl=(function(c,a){var b=c._private=c._private||{};
b.FieldDialog=(function(d){__extends(e,d);
function e(f){d.call(this);
this.field=f;
this.fieldDataReceivedHandlerBound=this.fieldDataReceivedHandler.bind(this);
}e.prototype.fieldDataReceivedHandler=function(f){var h=f.detail.fieldType,g=f.detail.field;
if(!g||(h!=this.DialogInfo.FieldType)){return;
}this.setValues(g);
};
e.prototype.OKHandler=function(f){b.sendCommand(b.Command.InsertItem,b.ItemType.FieldAdapter,this.DialogInfo.FieldType,0,this.getValues());
this.close(f);
};
e.prototype.closing=function(f){if(!this.field){document.removeEventListener("fieldDataReceived",this.fieldDataReceivedHandlerBound);
}};
e.prototype.loaded=function(){if(!this.field){document.addEventListener("fieldDataReceived",this.fieldDataReceivedHandlerBound);
b.sendCommand(b.Command.GetItem,b.ItemType.FieldAdapter);
}else{this.setValues(this.field);
}document.addEventListener("dialogResourcesReceived",this.resourcesReceivedHandlerBound);
b.sendCommand(b.Command.GetDialogResources,this.DialogInfo.DialogType);
};
e.prototype.setValues=function(f){};
e.prototype.getValues=function(){return{};
};
return e;
})(b.HTMLDialog);
return c;
}(TXTextControl||{},j$1_10_2));
var TXTextControl=(function(c,a){var b=c._private=c._private||{};
b.IfFieldDialog=(function(d){__extends(e,d);
function e(f){d.call(this,f);
this.DialogInfo={DialogType:b.HTMLDialogType.IfFieldDialog,FieldType:b.FieldType.IfField,ElementID:"ifFieldDialog",Width:385,FileName:"MailMerge/IfFieldDialog.html",TitleResourceName:"IF_FIELD_DIALOG_TITLE"};
}e.prototype.setValues=function(f){a("#txtFieldName").val(f.Expression1);
a("#txtCompareTo").val(f.Expression2);
a("#txtInsertThis").val(f.TrueText);
a("#txtOtherwise").val(f.FalseText);
document.getElementById("selIfFldOperators").selectedIndex=f.Operator;
};
e.prototype.getValues=function(){var f={Expression1:a("#txtFieldName").val(),Expression2:a("#txtCompareTo").val(),TrueText:a("#txtInsertThis").val(),FalseText:a("#txtOtherwise").val(),Operator:document.getElementById("selIfFldOperators").selectedIndex};
return f;
};
e.prototype.applyStringResources=function(f){a("#IF_FIELD_GROUP_BOX > legend").text(f.IF_FIELD_GROUP_BOX);
a("#IF_FIELD_LABEL_NAME").text(f.IF_FIELD_LABEL_NAME);
a("#IF_FIELD_LABEL_COMPARISON").text(f.IF_FIELD_LABEL_COMPARISON);
a("#IF_FIELD_COMBO_BOX_COMPARISON_EQUALS").text(f.IF_FIELD_COMBO_BOX_COMPARISON_EQUALS);
a("#IF_FIELD_COMBO_BOX_COMPARISON_NOT_EQUAL").text(f.IF_FIELD_COMBO_BOX_COMPARISON_NOT_EQUAL);
a("#IF_FIELD_COMBO_BOX_COMPARISON_LESS").text(f.IF_FIELD_COMBO_BOX_COMPARISON_LESS);
a("#IF_FIELD_COMBO_BOX_COMPARISON_GREATER").text(f.IF_FIELD_COMBO_BOX_COMPARISON_GREATER);
a("#IF_FIELD_COMBO_BOX_COMPARISON_GREATER_OR_EQUAL").text(f.IF_FIELD_COMBO_BOX_COMPARISON_GREATER_OR_EQUAL);
a("#IF_FIELD_COMBO_BOX_COMPARISON_LESS_OR_EQUAL").text(f.IF_FIELD_COMBO_BOX_COMPARISON_LESS_OR_EQUAL);
a("#IF_FIELD_LABEL_COMPARE_TO").text(f.IF_FIELD_LABEL_COMPARE_TO);
a("#IF_FIELD_LABEL_INSERT_THIS").text(f.IF_FIELD_LABEL_INSERT_THIS);
a("#IF_FIELD_LABEL_OTHERWISE").text(f.IF_FIELD_LABEL_OTHERWISE);
this.setDefaultBtnTexts(f);
};
return e;
})(b.FieldDialog);
return c;
}(TXTextControl||{},j$1_10_2));
var TXTextControl=(function(c,a){var b=c._private=c._private||{};
b.MergeFieldDialog=(function(d){__extends(e,d);
function e(f){d.call(this,f);
this.DialogInfo={DialogType:b.HTMLDialogType.MergeFieldDialog,FieldType:b.FieldType.MergeField,ElementID:"mergeFieldDialog",FileName:"MailMerge/MergeFieldDialog.html",TitleResourceName:"MERGEFIELD_DIALOG_TITLE",};
}e.prototype.setValues=function(f){a("#txtFieldName").val(f.Name);
a("#txtFieldText").val(f.Text);
document.getElementById("selMergeFieldFormat").selectedIndex=f.TextFormat;
a("#txtTextBefore").val(f.TextBefore);
a("#txtTextBefore").prop("disabled",f.TextBefore.length==0);
a("#chkTextBefore").prop("checked",f.TextBefore.length>0);
a("#txtTextAfter").val(f.TextAfter);
a("#txtTextAfter").prop("disabled",f.TextAfter.length==0);
a("#chkTextAfter").prop("checked",f.TextAfter.length>0);
a("#txtDateTimeFormat").val(f.DateTimeFormat);
a("#txtDateTimeFormat").prop("disabled",f.DateTimeFormat.length==0);
a("#chkDateTimeFormat").prop("checked",f.DateTimeFormat.length>0);
a("#txtNumericFormat").val(f.NumericFormat);
a("#txtNumericFormat").prop("disabled",f.NumericFormat.length==0);
a("#chkNumericFormat").prop("checked",f.NumericFormat.length>0);
a("#chkPreserveFormat").prop("checked",f.PreserveFormatting);
};
e.prototype.getValues=function(){var f={Name:a("#txtFieldName").val(),Text:a("#txtFieldText").val(),TextFormat:document.getElementById("selMergeFieldFormat").selectedIndex,TextBefore:a("#chkTextBefore").is(":checked")?a("#txtTextBefore").val():"",TextAfter:a("#chkTextAfter").is(":checked")?a("#txtTextAfter").val():"",DateTimeFormat:a("#chkDateTimeFormat").is(":checked")?a("#txtDateTimeFormat").val():"",NumericFormat:a("#chkNumericFormat").is(":checked")?a("#txtNumericFormat").val():"",PreserveFormatting:a("#chkPreserveFormat").is(":checked"),};
return f;
};
e.prototype.applyStringResources=function(f){a("#MERGEFIELD_GROUP_FIELD_PROPERTIES > legend").text(f.MERGEFIELD_GROUP_FIELD_PROPERTIES);
a("#MERGEFIELD_LABEL_NAME").text(f.MERGEFIELD_LABEL_NAME);
a("#MERGEFIELD_LABEL_TEXT").text(f.MERGEFIELD_LABEL_TEXT);
a("#MERGEFIELD_LABEL_FORMAT").text(f.MERGEFIELD_LABEL_FORMAT);
a("#MERGEFIELD_FORMAT_NONE").text(f.MERGEFIELD_FORMAT_NONE);
a("#MERGEFIELD_FORMAT_UPPER").text(f.MERGEFIELD_FORMAT_UPPER);
a("#MERGEFIELD_FORMAT_LOWER").text(f.MERGEFIELD_FORMAT_LOWER);
a("#MERGEFIELD_FORMAT_FIRST_CAP").text(f.MERGEFIELD_FORMAT_FIRST_CAP);
a("#MERGEFIELD_FORMAT_TITLE_CASE").text(f.MERGEFIELD_FORMAT_TITLE_CASE);
a("#MERGEFIELD_GROUP_FIELD_OPTIONS > legend").text(f.MERGEFIELD_GROUP_FIELD_OPTIONS);
a("#MERGEFIELD_LABEL_TEXT_BEFORE").text(f.MERGEFIELD_LABEL_TEXT_BEFORE);
a("#MERGEFIELD_LABEL_TEXT_AFTER").text(f.MERGEFIELD_LABEL_TEXT_AFTER);
a("#MERGEFIELD_LABEL_DATE_TIME_FORMAT").text(f.MERGEFIELD_LABEL_DATE_TIME_FORMAT);
a("#MERGEFIELD_LABEL_NUMERIC_FORMAT").text(f.MERGEFIELD_LABEL_NUMERIC_FORMAT);
a("#MERGEFIELD_CHECK_BOX_PRESERVE_FORMAT").text(f.MERGEFIELD_CHECK_BOX_PRESERVE_FORMAT);
this.setDefaultBtnTexts(f);
};
e.prototype.dialogReady=function(){function i(k){a("#txtTextBefore").prop("disabled",!k.target.checked);
}function h(k){a("#txtTextAfter").prop("disabled",!k.target.checked);
}function f(k){a("#txtDateTimeFormat").prop("disabled",!k.target.checked);
}function g(k){a("#txtNumericFormat").prop("disabled",!k.target.checked);
}a("#chkTextBefore").click(i);
a("#chkTextAfter").click(h);
a("#chkDateTimeFormat").click(f);
a("#chkNumericFormat").click(g);
var j=document.getElementById("selMergeFieldFormat");
j.selectedIndex=0;
};
return e;
})(b.FieldDialog);
return c;
}(TXTextControl||{},j$1_10_2));
var TXTextControl=(function(c,a){var b=c._private=c._private||{};
b.IncludeTextFieldDialog=(function(d){__extends(e,d);
function e(f){d.call(this,f);
this.DialogInfo={DialogType:b.HTMLDialogType.IncludeTextFieldDialog,FieldType:b.FieldType.IncludeTextField,ElementID:"includeTextFieldDialog",Width:300,FileName:"MailMerge/IncludeTextFieldDialog.html",TitleResourceName:"INCLUDETEXT_DIALOG_TITLE",};
}e.prototype.setValues=function(f){a("#txtFilename").val(f.Filename);
a("#txtBookmark").val(f.Bookmark);
document.getElementById("selectTextFormat").selectedIndex=f.TextFormat;
a("#chkPresFmt").prop("checked",f.PreserveFormatting);
};
e.prototype.getValues=function(){var f={Filename:a("#txtFilename").val(),Bookmark:a("#txtBookmark").val(),TextFormat:document.getElementById("selectTextFormat").selectedIndex,PreserveFormatting:a("#chkPresFmt").is(":checked"),};
return f;
};
e.prototype.applyStringResources=function(f){a("#INCLUDETEXT_GROUP_FIELD_OPTIONS > legend").text(f.INCLUDETEXT_GROUP_FIELD_OPTIONS);
a("#INCLUDETEXT_LABEL_FILENAME").text(f.INCLUDETEXT_LABEL_FILENAME);
a("#INCLUDETEXT_LABEL_BOOKMARK").text(f.INCLUDETEXT_LABEL_BOOKMARK);
a("#INCLUDETEXT_LABEL_TEXT_FORMAT").text(f.INCLUDETEXT_LABEL_TEXT_FORMAT);
a("#INCLUDETEXT_LIST_FORMAT_NONE").text(f.INCLUDETEXT_LIST_FORMAT_NONE);
a("#INCLUDETEXT_LIST_FORMAT_UPPER").text(f.INCLUDETEXT_LIST_FORMAT_UPPER);
a("#INCLUDETEXT_LIST_FORMAT_LOWER").text(f.INCLUDETEXT_LIST_FORMAT_LOWER);
a("#INCLUDETEXT_LIST_FORMAT_FIRST_CAP").text(f.INCLUDETEXT_LIST_FORMAT_FIRST_CAP);
a("#INCLUDETEXT_LIST_FORMAT_TITLE_CASE").text(f.INCLUDETEXT_LIST_FORMAT_TITLE_CASE);
a("#INCLUDETEXT_CHECK_BOX_PRESERVE_FORMAT").text(f.INCLUDETEXT_CHECK_BOX_PRESERVE_FORMAT);
this.setDefaultBtnTexts(f);
};
e.prototype.dialogReady=function(){var f=document.getElementById("selectTextFormat");
f.selectedIndex=0;
};
return e;
})(b.FieldDialog);
return c;
}(TXTextControl||{},j$1_10_2));
var TXTextControl=(function(c,a){var b=c._private=c._private||{};
b.DateFieldDialog=(function(d){__extends(e,d);
function e(f){d.call(this,f);
this.DialogInfo={DialogType:b.HTMLDialogType.DateFieldDialog,FieldType:b.FieldType.DateField,ElementID:"dateFieldDialog",Width:280,FileName:"MailMerge/DateFieldDialog.html",TitleResourceName:"DATEFIELD_DIALOG_TITLE",};
}e.prototype.setValues=function(f){a("#txtDateFormat").val(f.Format);
a("#chkPresFmt").prop("checked",f.PreserveFormatting);
};
e.prototype.getValues=function(){var f={Format:a("#txtDateFormat").val(),PreserveFormatting:a("#chkPresFmt").is(":checked"),};
return f;
};
e.prototype.applyStringResources=function(h){var f=["dd.MM.yyyy","dddd, d. MMMM yyyy","d. MMMM yyyy","dd.MM.yy","yyyy-MM-dd","yy-MM-dd","dd. MMM. yyyy","dd/MM/yy","MMMM yy","MMM-yy","dd.MM.yyyy HH:mm","dd.MM.yyyy HH:mm:ss","h:mm tt","h:mm:ss tt","HH:mm","HH:mm:ss",];
a("#DATEFIELD_LABEL_DATE_FORMATS").text(h.DATEFIELD_LABEL_DATE_FORMATS);
a("#DATEFIELD_CHECK_BOX_PRESERVE_FORMAT").text(h.DATEFIELD_CHECK_BOX_PRESERVE_FORMAT);
var g=document.getElementById("selDateFormats");
f.forEach(function(k){var i=h[k];
if(i){var j=document.createElement("option");
g.appendChild(j);
j.value=k;
j.text=i;
}});
this.setDefaultBtnTexts(h);
};
e.prototype.dialogReady=function(){var f=document.getElementById("selDateFormats");
var g=document.getElementById("txtDateFormat");
f.selectedIndex=0;
f.addEventListener("change",function(){var h=f.options[f.selectedIndex];
g.value=h.value;
});
};
return e;
})(b.FieldDialog);
return c;
}(TXTextControl||{},j$1_10_2));
var TXTextControl=(function(c,a){var b=c._private=c._private||{};
b.NextIfFieldDialog=(function(d){__extends(e,d);
function e(f){d.call(this,f);
this.DialogInfo={DialogType:b.HTMLDialogType.NextIfFieldDialog,FieldType:b.FieldType.NextIfField,ElementID:"ifFieldDialog",Width:385,FileName:"MailMerge/IfFieldDialog.html",TitleResourceName:"NEXTIF_FIELD_DIALOG_TITLE",};
}e.prototype.setValues=function(f){a("#txtFieldName").val(f.Expression1);
a("#txtCompareTo").val(f.Expression2);
document.getElementById("selIfFldOperators").selectedIndex=f.Operator;
};
e.prototype.getValues=function(){var f={Expression1:a("#txtFieldName").val(),Expression2:a("#txtCompareTo").val(),Operator:document.getElementById("selIfFldOperators").selectedIndex,};
return f;
};
e.prototype.applyStringResources=function(f){a("#IF_FIELD_GROUP_BOX > legend").text(f.IF_FIELD_GROUP_BOX);
a("#IF_FIELD_LABEL_NAME").text(f.IF_FIELD_LABEL_NAME);
a("#IF_FIELD_LABEL_COMPARISON").text(f.IF_FIELD_LABEL_COMPARISON);
a("#IF_FIELD_COMBO_BOX_COMPARISON_EQUALS").text(f.IF_FIELD_COMBO_BOX_COMPARISON_EQUALS);
a("#IF_FIELD_COMBO_BOX_COMPARISON_NOT_EQUAL").text(f.IF_FIELD_COMBO_BOX_COMPARISON_NOT_EQUAL);
a("#IF_FIELD_COMBO_BOX_COMPARISON_LESS").text(f.IF_FIELD_COMBO_BOX_COMPARISON_LESS);
a("#IF_FIELD_COMBO_BOX_COMPARISON_GREATER").text(f.IF_FIELD_COMBO_BOX_COMPARISON_GREATER);
a("#IF_FIELD_COMBO_BOX_COMPARISON_GREATER_OR_EQUAL").text(f.IF_FIELD_COMBO_BOX_COMPARISON_GREATER_OR_EQUAL);
a("#IF_FIELD_COMBO_BOX_COMPARISON_LESS_OR_EQUAL").text(f.IF_FIELD_COMBO_BOX_COMPARISON_LESS_OR_EQUAL);
a("#IF_FIELD_LABEL_COMPARE_TO").text(f.IF_FIELD_LABEL_COMPARE_TO);
a("#IF_FIELD_LABEL_INSERT_THIS").remove();
a("#txtInsertThis").remove();
a("#IF_FIELD_LABEL_OTHERWISE").remove();
a("#txtOtherwise").remove();
this.setDefaultBtnTexts(f);
};
return e;
})(b.FieldDialog);
return c;
}(TXTextControl||{},j$1_10_2));
var TXTextControl=(function(c,a){var b=c._private=c._private||{};
b.MaxPreviewRowsDialog=(function(d){__extends(e,d);
function e(f){d.call(this);
this.DialogInfo={DialogType:b.HTMLDialogType.MaxPreviewRowsDialog,ElementID:"maxPreviewRowsDialog",Width:"auto",Height:120,FileName:"MailMerge/MaxPreviewRowsDialog.html",TitleResourceName:"MAXPREVROWS_DIALOG_TITLE",};
this.value=f;
}e.prototype.closing=function(f){if(this.dialogData.dialogResult){this.value=parseInt(a("#spinNum").val(),10);
this.dialogData.value=this.value;
}};
e.prototype.applyStringResources=function(f){a("#MAXPREVROWS_LABEL_NUM_RESULTS").text(f.MAXPREVROWS_LABEL_NUM_RESULTS);
this.setDefaultBtnTexts(f);
};
e.prototype.dialogReady=function(){a("#spinNum").spinner({max:100,min:1});
a("#spinNum").val(this.value);
};
return e;
})(b.HTMLDialog);
return c;
}(TXTextControl||{},j$1_10_2));
var TXTextControl=(function(d,a){var b=d._private=d._private||{},c={Table:0,Paragraph:1,};
b.InsertMergeBlockDialog=(function(e){__extends(h,e);
function h(m,l){e.call(this);
this.DialogInfo={DialogType:b.HTMLDialogType.InsertMergeBlockDialog,ElementID:"insertMergeBlockDialog",Width:"auto",FileName:"MailMerge/InsertMergeBlockDialog.html",TitleResourceName:"INSERT_MERGE_BLOCK_DIALOG_TITLE"};
this.blockName=m;
this.dbScheme=l;
}function g(){var l=[];
a("div#tblColContainer input[type=checkbox]").each(function(){var n=a(this);
if(n.is(":checked")){var m=n.attr("data-column-name");
l.push(m);
}});
return l;
}h.prototype.getValues=function(){var l={type:a("#radioTableRow").is(":checked")?c.Table:c.Paragraph,name:this.blockName,headerRow:a("#chkAddHeaderRow").is(":checked"),columnNames:g()};
return l;
};
function f(n){var m=document.getElementById("btnMoveUp");
var l=document.getElementById("btnMoveDown");
m.disabled=(n.previousElementSibling==null);
l.disabled=(n.nextElementSibling==null);
}function i(m){var o=m.currentTarget;
var n=o.parentElement;
for(var p=0;
p<n.children.length;
++p){var l=n.children[p];
l.classList.remove("selected");
}o.classList.add("selected");
f(o);
var q=g().length?"enable":"disable";
a("#btnOK_"+this.dialogContainerID).button(q);
}h.prototype.createColumnCheckBoxes=function(l){var n=0,o=this,m=document.getElementById("tblColContainer");
l.forEach(function(q){var s=document.createElement("div");
s.style.cssFloat="left";
s.style.clear="left";
s.style.width="100%";
s.addEventListener("click",i.bind(o));
m.appendChild(s);
var p="chkColName"+n++,r=document.createElement("input");
r.id=p;
r.setAttribute("type","checkbox");
r.setAttribute("data-column-name",q.ColumnName);
r.title=q.ColumnName;
r.style.cssFloat="left";
r.style.clear="left";
s.appendChild(r);
var t=document.createElement("label");
t.setAttribute("for",p);
t.textContent=q.ColumnName;
t.title=q.ColumnName;
t.style.cssFloat="left";
s.appendChild(t);
});
};
h.prototype.OKHandler=function(m){var l=this.getValues();
if(l.columnNames.length>0){b.sendCommand(b.Command.InsertItem,b.ItemType.MergeBlock,0,0,l);
}this.close(m);
};
h.prototype.btnMoveUpClick=function(l){var n=document.querySelector("#tblColContainer > div.selected");
if(n==null){return;
}var o=n.previousElementSibling;
var m=document.getElementById("tblColContainer");
m.removeChild(n);
m.insertBefore(n,o);
f(n);
};
h.prototype.btnMoveDownClick=function(l){var n=document.querySelector("#tblColContainer > div.selected");
if(n==null){return;
}var o=n.nextElementSibling;
var m=document.getElementById("tblColContainer");
m.removeChild(n);
m.insertBefore(n,o.nextElementSibling);
f(n);
};
function k(m){var l=document.getElementById("chkAddHeaderRow");
l.disabled=!m.currentTarget.checked;
}function j(m){var l=document.getElementById("chkAddHeaderRow");
l.disabled=m.currentTarget.checked;
}h.prototype.dialogReady=function(){var l=this,m=this.dbScheme.Tables.find(function(n){return(n.TableName.toLowerCase()===l.blockName.toLowerCase());
});
this.createColumnCheckBoxes(m.Columns);
a("#btnOK_"+this.dialogContainerID).button("disable");
a("#btnMoveUp").click(l.btnMoveUpClick.bind(l));
a("#btnMoveDown").click(l.btnMoveDownClick.bind(l));
document.getElementById("radioTableRow").addEventListener("click",k);
document.getElementById("radioPlainPar").addEventListener("click",j);
};
h.prototype.applyStringResources=function(l){a("#INSERT_MERGE_BLOCK_DIALOG_LBL_SEL_TBL_COL").text(l.INSERT_MERGE_BLOCK_DIALOG_LBL_SEL_TBL_COL);
a("#INSERT_MERGE_BLOCK_DIALOG_LBL_PLAIN_PAR").text(l.INSERT_MERGE_BLOCK_DIALOG_LBL_PLAIN_PAR);
a("#INSERT_MERGE_BLOCK_DIALOG_LBL_TBL_ROW").text(l.INSERT_MERGE_BLOCK_DIALOG_LBL_TBL_ROW);
a("#INSERT_MERGE_BLOCK_DIALOG_LBL_HDR_ROW").text(l.INSERT_MERGE_BLOCK_DIALOG_LBL_HDR_ROW);
this.setDefaultBtnTexts(l);
};
return h;
})(b.HTMLDialog);
return d;
}(TXTextControl||{},j$1_10_2));
var TXTextControl=(function(c,a){var b=c._private=c._private||{};
b.EditDataRelationsDialog=(function(d){__extends(e,d);
function e(f){d.call(this);
this.DialogInfo={DialogType:b.HTMLDialogType.EditDataRelationsDialog,ElementID:"editDataRelationsDialog",Width:"auto",FileName:"MailMerge/EditDataRelationsDialog.html",TitleResourceName:"EDIT_DATA_RELS_DIALOG_TITLE"};
this.relations=f;
this.deletedRelations=[];
}e.prototype.closing=function(){if(this.dialogData.dialogResult){this.dialogData.relations=this.relations;
this.dialogData.deletedRelations=this.deletedRelations;
}};
e.prototype.addDataRelation=function(){var g=this,f=new b.CreateDataRelationDialog(b.dbScheme);
f.showModal(function(h){if(!h){return;
}g.relations.push(h);
g.populateSelect();
});
};
e.prototype.deleteSelectedRelation=function(){var f=document.getElementById("selDataRelations"),l=f.options[f.selectedIndex],j=this.relations;
for(var g=0;
g<j.length;
++g){var h=j[g],k=(h.RelationName&&(h.RelationName!==""))?h.RelationName:this.getRelDesc(h);
if(k===l.value){this.deletedRelations.push(l.value);
j.splice(g,1);
this.populateSelect();
return;
}}};
e.prototype.populateSelect=function(){var g=this,f=document.getElementById("selDataRelations");
f.innerHTML="";
this.relations.forEach(function(i){var h=document.createElement("option"),j=g.getRelDesc(i);
h.value=h.text=(i.RelationName==="")?j:i.RelationName;
h.title=j;
f.appendChild(h);
});
f.selectedIndex=0;
};
e.prototype.getRelDesc=function(f){if(!f){return"NO RELATION GIVEN";
}var g=f.ParentTableName+'["'+f.ParentColumnName+'"] -> '+f.ChildTableName+'["'+f.ChildColumnName+'"]';
return g;
};
e.prototype.dialogReady=function(){var h=this;
this.populateSelect();
function f(i){h.addDataRelation();
}function g(i){h.deleteSelectedRelation();
}a("#EDIT_DATA_RELS_DIALOG_BTN_ADD").click(f);
a("#EDIT_DATA_RELS_DIALOG_BTN_DELETE").click(g);
};
e.prototype.applyStringResources=function(f){a("#EDIT_DATA_RELS_DIALOG_LBL_SEL_DATA_REL").text(f.EDIT_DATA_RELS_DIALOG_LBL_SEL_DATA_REL);
a("#EDIT_DATA_RELS_DIALOG_BTN_ADD").text(f.EDIT_DATA_RELS_DIALOG_BTN_ADD);
a("#EDIT_DATA_RELS_DIALOG_BTN_DELETE").text(f.EDIT_DATA_RELS_DIALOG_BTN_DELETE);
this.setDefaultBtnTexts(f);
};
return e;
})(b.HTMLDialog);
return c;
}(TXTextControl||{},j$1_10_2));
var TXTextControl=(function(c,a){var b=c._private=c._private||{};
b.CreateDataRelationDialog=(function(d){__extends(e,d);
function e(f){d.call(this);
this.DialogInfo={DialogType:b.HTMLDialogType.CreateDataRelationDialog,ElementID:"createDataRelationDialog",Width:"auto",FileName:"MailMerge/CreateDataRelationDialog.html",TitleResourceName:"CREATE_DATA_REL_DIALOG_TITLE",};
this.dbScheme=f;
this.callback=null;
this.newRelation={RelationName:"",ParentTableName:"",ChildTableName:"",ParentColumnName:"",ChildColumnName:""};
}e.prototype.dialogReady=function(){var h=this,g=document.getElementById("selMainTable"),f=document.getElementById("selChildTable");
g.onchange=function(){h.newRelation.ParentTableName=this.value;
h.populateColumnNameContainer(document.getElementById("mainTblColContainer"),this.value,"parent");
};
f.onchange=function(){h.newRelation.ChildTableName=this.value;
h.populateColumnNameContainer(document.getElementById("childTblColContainer"),this.value,"child");
};
this.dbScheme.Tables.forEach(function(j){var i=document.createElement("option");
i.value=i.text=i.title=j.TableName;
g.appendChild(i);
f.appendChild(i.cloneNode(true));
});
this.populateColumnNameContainers(this.dbScheme.Tables[0].TableName);
this.newRelation.ParentTableName=this.newRelation.ChildTableName=this.dbScheme.Tables[0].TableName;
this.newRelation.ParentColumnName=this.newRelation.ChildColumnName=this.dbScheme.Tables[0].Columns[0].ColumnName;
};
e.prototype.populateColumnNameContainers=function(f){this.populateColumnNameContainer(document.getElementById("mainTblColContainer"),f,"parent");
this.populateColumnNameContainer(document.getElementById("childTblColContainer"),f,"child");
};
e.prototype.populateColumnNameContainer=function(f,j,k){var h=this,g=0;
f.innerHTML="";
var i=this.dbScheme.Tables.find(function(l){return l.TableName.toLowerCase()===j.toLowerCase();
});
if(!i){console.assert(i);
return;
}i.Columns.forEach(function(l){var o=f.id+"_opt_"+g++,n=document.createElement("input");
n.id=o;
n.setAttribute("type","radio");
n.setAttribute("name","group_"+k);
n.setAttribute("data-column-name",l.ColumnName);
n.setAttribute("data-table-role",k);
n.title=l.ColumnName;
n.style.cssFloat="left";
n.style.clear="left";
f.appendChild(n);
n.addEventListener("click",function(p){h.columnSelected(this.attributes["data-column-name"].value,this.attributes["data-table-role"].value);
});
if(g==1){n.checked=true;
h.columnSelected(l.ColumnName,k);
}var m=document.createElement("label");
m.setAttribute("for",o);
m.textContent=l.ColumnName;
m.title=l.ColumnName;
m.style.cssFloat="left";
f.appendChild(m);
});
};
e.prototype.columnSelected=function(f,g){switch(g){case"parent":this.newRelation.ParentColumnName=f;
break;
case"child":this.newRelation.ChildColumnName=f;
break;
}};
e.prototype.OKHandler=function(f){if(this.callback){if(this.relationIsValid(this.newRelation)){this.newRelation.RelationName=a("#txtRelName").val();
this.callback(this.newRelation);
}}this.close(f);
};
e.prototype.close=function(f){a(f).dialog("destroy").remove();
a("#"+this.dialogContainerID).remove();
};
e.prototype.showModal=function(f){var h=document.getElementById("txTemplateDesignerContainer"),i=document.createElement("div");
i.id=this.dialogContainerID;
h.appendChild(i);
var j="";
if(typeof TXSettings!=="undefined"){j=TXSettings.AppVirtualPath+TXSettings.BasePath;
}var g=a("#"+this.dialogContainerID);
g.load(j+"Dialogs/"+this.DialogInfo.FileName,this.loadedBound);
this.callback=f;
};
e.prototype.applyStringResources=function(f){a("#CREATE_DATA_REL_DIALOG_LBL_MAIN_TBL").text(f.CREATE_DATA_REL_DIALOG_LBL_MAIN_TBL);
a("#CREATE_DATA_REL_DIALOG_LBL_MAIN_COL").text(f.CREATE_DATA_REL_DIALOG_LBL_MAIN_COL);
a("#CREATE_DATA_REL_DIALOG_LBL_CHILD_TBL").text(f.CREATE_DATA_REL_DIALOG_LBL_CHILD_TBL);
a("#CREATE_DATA_REL_DIALOG_LBL_CHILD_COL").text(f.CREATE_DATA_REL_DIALOG_LBL_CHILD_COL);
a("#CREATE_DATA_REL_DIALOG_LBL_REL_NAME").text(f.CREATE_DATA_REL_DIALOG_LBL_REL_NAME);
a("#txtRelName").attr("placeholder",f.CREATE_DATA_REL_DIALOG_INP_REL_NAME_PLACEHLD);
this.setDefaultBtnTexts(f);
};
e.prototype.relationIsValid=function(f){return(f.ParentTableName!=="")&&(f.ChildTableName!=="")&&(f.ParentColumnName!=="")&&(f.ChildColumnName!=="");
};
return e;
})(b.HTMLDialog);
return c;
}(TXTextControl||{},j$1_10_2));
var TXTextControl=(function(c,a){var b=c._private=c._private||{};
b.EditMergeBlocksDialog=(function(d){__extends(e,d);
function e(f){d.call(this);
this.DialogInfo={DialogType:b.HTMLDialogType.EditMergeBlocksDialog,ElementID:"editMergeBlocksDialog",Width:"auto",FileName:"MailMerge/EditMergeBlocksDialog.html",TitleResourceName:"EDIT_MERGE_BLOCKS_DIALOG_TITLE"};
this.blocks=f;
this.deletedBlocks=[];
this.renamedBlocks=[];
}e.prototype.closing=function(){this.dialogData.deletedBlocks=this.deletedBlocks;
this.dialogData.renamedBlocks=this.renamedBlocks;
};
e.prototype.populateSelect=function(){var f=document.getElementById("selMergeBlocks");
f.innerHTML="";
this.blocks.forEach(function(g){var h=(g.NewName!=="")?g.NewName:g.Name;
var i=document.createElement("option");
i.value=i.text=i.title=h;
f.appendChild(i);
});
f.selectedIndex=0;
};
e.prototype.goToSelectedBlock=function(){var g=document.getElementById("selMergeBlocks"),h=g.options[g.selectedIndex],f=this.blocks.find(function(i){return i.Name===h.value;
});
b.sendCommand(b.Command.GoToItem,b.ItemType.MergeBlock,0,0,f.Name);
};
e.prototype.renameSelectedBlock=function(){var n=this,k=document.getElementById("selMergeBlocks"),m=k.options[k.selectedIndex],g=this.blocks.find(function(i){if(i.NewName!==""){return i.NewName===m.value;
}else{return i.Name===m.value;
}});
if(g.NewName!==""){for(var l=0;
l<this.renamedBlocks.length;
++l){var f=this.renamedBlocks[l];
if(f.NewName===g.NewName){this.renamedBlocks.splice(l,1);
break;
}}}var h=(g.NewName!=="")?g.NewName:g.Name,j=new b.InputBoxDialog(b.variousMessages.txtRenameMergeBlock,h);
j.showModal(function(i){if(i!==""){g.NewName=i;
n.renamedBlocks.push(cloneObject(g));
n.populateSelect();
}});
};
e.prototype.deleteSelectedBlock=function(){var j=document.getElementById("selMergeBlocks"),l=j.options[j.selectedIndex],h=this.blocks;
for(var k=0;
k<h.length;
++k){var f=h[k],g=(f.NewName!=="")?f.NewName:f.Name;
if(g===l.value){this.deletedBlocks.push(f.Name);
h.splice(k,1);
this.populateSelect();
return;
}}};
e.prototype.dialogReady=function(){var i=this;
this.populateSelect();
function g(j){i.goToSelectedBlock();
}function h(j){i.renameSelectedBlock();
}function f(j){i.deleteSelectedBlock();
}a("#EDIT_MERGE_BLOCKS_DIALOG_BTN_GOTO").click(g);
a("#EDIT_MERGE_BLOCKS_DIALOG_BTN_RENAME").click(h);
a("#EDIT_MERGE_BLOCKS_DIALOG_BTN_DELETE").click(f);
};
e.prototype.applyStringResources=function(f){a("#EDIT_MERGE_BLOCKS_DIALOG_LBL_SEL_BLOCKS").text(f.EDIT_MERGE_BLOCKS_DIALOG_LBL_SEL_BLOCKS);
a("#EDIT_MERGE_BLOCKS_DIALOG_BTN_GOTO").text(f.EDIT_MERGE_BLOCKS_DIALOG_BTN_GOTO);
a("#EDIT_MERGE_BLOCKS_DIALOG_BTN_RENAME").text(f.EDIT_MERGE_BLOCKS_DIALOG_BTN_RENAME);
a("#EDIT_MERGE_BLOCKS_DIALOG_BTN_DELETE").text(f.EDIT_MERGE_BLOCKS_DIALOG_BTN_DELETE);
this.setDefaultBtnTexts(f);
};
return e;
})(b.HTMLDialog);
return c;
}(TXTextControl||{},j$1_10_2));
var TXTextControl=(function(c,a){var b=c._private=c._private||{};
b.txDialog=null;
b.TxDialog=(function(){function d(g,e,f,h){this.dialogType=f;
this.initialImage=g;
this.caption=e;
this.dialogContainer;
this.depth=h?h.depth+1:0;
this.parentDialog=h||null;
this.childDialog=null;
this.viewer=null;
this.caretStateBuffer=null;
this.caretStateChangedBound=this.caretStateChanged.bind(this);
this.imageReceivedBound=this.imageReceived.bind(this);
this.imageRegionsUpdatedBound=this.imageRegionsUpdated.bind(this);
this.dialogClosedBound=this.dialogClosed.bind(this);
this.loadedBound=this.loaded.bind(this);
}d.prototype.close=function(e,f){f=f||false;
if(!this.parentDialog){document.removeEventListener("dialogCaretStateChanged",this.caretStateChangedBound);
document.removeEventListener("txDialogImageReceived",this.imageReceivedBound);
document.removeEventListener("txDialogImageRegionsUpdated",this.imageRegionsUpdatedBound);
document.removeEventListener("txDialogClosed",this.dialogClosedBound);
}if(!f){b.sendCommand(b.Command.CloseDialog,this.depth);
}a(e).dialog("destroy").remove();
this.dialogContainer.remove();
b.mouseOwner=null;
if(!this.parentDialog){b.txDialog=null;
if(!b.isTouchDevice){b.textViewer.focus();
}}else{this.parentDialog.childDialog=null;
if(!b.isTouchDevice){this.parentDialog.focus();
}}};
d.prototype.dialogReady=function(){var g=document.getElementById("txDialogContent");
g.id=g.id+"_"+this.depth;
this.viewer=new b.ComponentViewer(g,b.ComponentType.TxDialog,this.dialogType,this.depth);
this.viewer.setImage(this.initialImage,true);
delete this.initialImage;
if(this.caretStateBuffer){this.viewer.setCaretState(this.caretStateBuffer);
this.caretStateBuffer=null;
}var f=a("#txDialog"),i=f.css("margin-left"),e={width:f.css("border-left-width"),color:f.css("border-left-color"),style:f.css("border-left-style")};
f.css("border-bottom-width",e.width);
f.css("border-bottom-style",e.style);
f.css("border-bottom-color",e.color);
f.css("margin-bottom",i);
var h=document.getElementById("txDialog");
h.id=h.id+"_"+this.depth;
a("div.ui-dialog button.ui-dialog-titlebar-close").blur();
if(!b.isTouchDevice){this.viewer.focus();
}};
d.prototype.dialogize=function(){var e=this;
a("#txDialog").dialog({modal:true,resizable:false,width:"auto",height:"auto",title:this.caption,buttons:{},close:function(){e.close(this);
},}).keypress(function(f){if(f.keyCode==a.ui.keyCode.ENTER){}});
this.dialogReady();
};
d.prototype.showChildDialog=function(f,e){if(this.childDialog){this.childDialog.showChildDialog(f,e);
}else{this.childDialog=new d(f,e,b.TXDialogType.ChildDialog,this);
this.childDialog.showModal();
}};
d.prototype.caretStateChanged=function(f){var g=f.detail;
if(this.depth<g.nestingDepth){this.childDialog.caretStateChanged(f);
}else{if(g.dialogType==this.dialogType){if(this.viewer){this.viewer.setCaretState(g.caretState);
}else{this.caretStateBuffer=g.caretState;
}}}};
d.prototype.dialogClosed=function(f){var g=f.detail;
if(this.depth<g.nestingDepth){if(this.childDialog){this.childDialog.dialogClosed(f);
}}else{if(g.dialogType==this.dialogType){this.close(a("#txDialog_"+this.depth),true);
}}};
d.prototype.imageReceived=function(f){var g=f.detail;
if(this.depth<g.nestingDepth){this.childDialog.imageReceived(f);
}else{if(g.dialogType==this.dialogType){if(this.viewer){this.viewer.setImage(g.data);
}}}};
d.prototype.imageRegionsUpdated=function(f){var g=f.detail;
if(this.depth<g.nestingDepth){this.childDialog.imageRegionsUpdated(f);
}else{if(g.dialogType==this.dialogType){this.viewer.updateImageRegions(g.tiles);
}}};
d.prototype.loaded=function(){this.dialogize();
if(!this.parentDialog){document.addEventListener("dialogCaretStateChanged",this.caretStateChangedBound);
document.addEventListener("txDialogImageReceived",this.imageReceivedBound);
document.addEventListener("txDialogImageRegionsUpdated",this.imageRegionsUpdatedBound);
document.addEventListener("txDialogClosed",this.dialogClosedBound);
}};
d.prototype.getActiveViewer=function(){if(!this.childDialog){return this.viewer;
}else{return this.childDialog.getActiveViewer();
}};
d.prototype.focus=function(){if(!this.childDialog){this.viewer.focus();
}else{this.childDialog.focus();
}};
d.prototype.blur=function(){if(!this.childDialog){this.viewer.blur();
}else{this.childDialog.blur();
}};
d.prototype.showModal=function(){var g="txDlgContainer_"+this.depth,e=document.getElementById("txTemplateDesignerContainer"),f=document.createElement("div");
f.id=g;
e.appendChild(f);
var h="";
if(typeof TXSettings!=="undefined"){h=TXSettings.AppVirtualPath+TXSettings.BasePath;
}this.dialogContainer=a("#"+g);
this.dialogContainer.load(h+"Dialogs/TxDialog.html",this.loadedBound);
};
return d;
})();
return c;
}(TXTextControl||{},j$1_10_2));
var TXTextControl=(function(V,a){var b=V._private=V._private||{},j,i,n,p,m,q,t,o,k=10,l="",s="#000000",r="#FFFFFF";
b.attachHomeTabEventHandlers=function(){i=a("#bordersDropDown").menu().hide();
j=a("#bulletListDropDown").menu().hide();
n=a("#numberedListDropDown").menu().hide();
p=a("#structuredListDropDown").menu().hide();
m=a("#lineSpacingDropDown").menu().hide();
q=a("#stylesDropDown").menu().hide();
t=a("#ulStylesDropDown").menu().hide();
o=a("#pasteDropDown").menu().hide();
i.on("menuselect",u);
j.on("menuselect",v);
n.on("menuselect",F);
p.on("menuselect",H);
m.on("menuselect",E);
q.on("menuselect",I);
t.on("menuselect",J);
o.on("menuselect",G);
document.addEventListener("fontListReceived",e);
document.addEventListener("fontSizesReceived",f);
document.addEventListener("inputFormatReceived",h);
document.addEventListener("styleNameChanged",P);
document.addEventListener("styleNamesChanged",Q);
document.addEventListener("underlineStyleChanged",W);
var X=document.getElementById("selectFont");
X.addEventListener("click",O);
X.addEventListener("change",function(){var Z=this.value;
if(Z){b.sendCommand(b.Command.InputFormat,b.InputFormatProperty.FontFamily,0,0,Z);
}if(!b.isTouchDevice){b.textViewer.focus();
}});
var Y=document.getElementById("selectFontSize");
Y.addEventListener("click",O);
Y.addEventListener("change",function(){var aa=this.value;
if(aa){var Z=parseInt(aa,10);
b.sendCommand(b.Command.InputFormat,b.InputFormatProperty.FontSize,Z);
}if(!b.isTouchDevice){b.textViewer.focus();
}});
a("#btnUndo").click(function(){if(!a(this).hasClass("ui-state-disabled")){b.sendCommand(b.Command.Undo);
}});
a("#btnRedo").click(function(){if(!a(this).hasClass("ui-state-disabled")){b.sendCommand(b.Command.Redo);
}});
a("#btnFind").click(function(){b.sendCommand(b.Command.ShowDialog,b.DialogCategory.TXDialog,b.TXDialogType.FindDialog);
});
a("#btnReplace").click(function(){b.sendCommand(b.Command.ShowDialog,b.DialogCategory.TXDialog,b.TXDialogType.ReplaceDialog);
});
a("#btnSelectAll").click(function(){b.sendCommand(b.Command.SelectAll);
});
a("#btnCut").click(function(){if(!a(this).hasClass("ui-state-disabled")){b.sendCommand(b.Command.Cut);
}});
a("#btnCopy").click(function(){if(!a(this).hasClass("ui-state-disabled")){b.sendCommand(b.Command.Copy);
}});
a("#drpDnBtnPaste").click(A);
a("#btnFontGrow").click(function(){b.sendCommand(b.Command.GrowFont);
});
a("#btnFontShrink").click(function(){b.sendCommand(b.Command.ShrinkFont);
});
a("#tglBtnBold").click(function(){if(a(this).hasClass("ribbon-button-selected")){b.sendCommand(b.Command.InputFormat,b.InputFormatProperty.Bold,0);
}else{b.sendCommand(b.Command.InputFormat,b.InputFormatProperty.Bold,1);
}});
a("#tglBtnItalic").click(function(){if(a(this).hasClass("ribbon-button-selected")){b.sendCommand(b.Command.InputFormat,b.InputFormatProperty.Italic,0);
}else{b.sendCommand(b.Command.InputFormat,b.InputFormatProperty.Italic,1);
}});
a("#drpDnBtnUnderlineStyles").click(D);
a("#tglBtnStrikethrough").click(function(){if(a(this).hasClass("ribbon-button-selected")){b.sendCommand(b.Command.InputFormat,b.InputFormatProperty.Strikeout,0);
}else{b.sendCommand(b.Command.InputFormat,b.InputFormatProperty.Strikeout,1);
}});
a("#tglBtnSubscript").click(function(){if(a(this).hasClass("ribbon-button-selected")){b.sendCommand(b.Command.InputFormat,b.InputFormatProperty.Subscript,0);
}else{b.sendCommand(b.Command.InputFormat,b.InputFormatProperty.Subscript,1);
}});
a("#tglBtnSuperscript").click(function(){if(a(this).hasClass("ribbon-button-selected")){b.sendCommand(b.Command.InputFormat,b.InputFormatProperty.Superscript,0);
}else{b.sendCommand(b.Command.InputFormat,b.InputFormatProperty.Superscript,1);
}});
a("#btnHighlightColor").click(function(){b.sendCommand(b.Command.ShowDialog,b.DialogCategory.TXDialog,b.TXDialogType.TextBackColorDialog);
});
a("#btnFontColor").click(function(){b.sendCommand(b.Command.ShowDialog,b.DialogCategory.TXDialog,b.TXDialogType.ForeColorDialog);
});
a("#btnCharacterSettings").click(function(){b.sendCommand(b.Command.ShowDialog,b.DialogCategory.TXDialog,b.TXDialogType.FontDialog);
});
a("#drpDnBtnBulletList").click(x);
a("#drpDnBtnNumberedList").click(z);
a("#drpDnBtnStructuredList").click(B);
a("#btnIndentDecrease").click(function(){b.sendCommand(b.Command.DecreaseIndent);
});
a("#btnIndentIncrease").click(function(){b.sendCommand(b.Command.IncreaseIndent);
});
a("#tglBtnTextDirLTR").click(function(){if(!a(this).hasClass("ribbon-button-selected")){b.sendCommand(b.Command.InputFormat,b.InputFormatProperty.RightToLeft,0);
}});
a("#tglBtnTextDirRTL").click(function(){if(!a(this).hasClass("ribbon-button-selected")){b.sendCommand(b.Command.InputFormat,b.InputFormatProperty.RightToLeft,1);
}});
a("#btnTabs").click(function(){b.sendCommand(b.Command.ShowDialog,b.DialogCategory.TXDialog,b.TXDialogType.TabDialog);
});
a("#tglBtnControlChars").click(function(){if(a(this).hasClass("ribbon-button-selected")){b.sendCommand(b.Command.DisplayVisualElement,b.VisualElement.ControlChars,0);
a(this).removeClass("ribbon-button-selected");
}else{b.sendCommand(b.Command.DisplayVisualElement,b.VisualElement.ControlChars,1);
a(this).addClass("ribbon-button-selected");
}});
a("#tglBtnAlignLeft").click(function(){if(a(this).hasClass("ribbon-button-selected")){b.sendCommand(b.Command.InputFormat,b.InputFormatProperty.LeftAligned,0);
}else{b.sendCommand(b.Command.InputFormat,b.InputFormatProperty.LeftAligned,1);
}});
a("#tglBtnAlignCenter").click(function(){if(a(this).hasClass("ribbon-button-selected")){b.sendCommand(b.Command.InputFormat,b.InputFormatProperty.Centered,0);
}else{b.sendCommand(b.Command.InputFormat,b.InputFormatProperty.Centered,1);
}});
a("#tglBtnAlignRight").click(function(){if(a(this).hasClass("ribbon-button-selected")){b.sendCommand(b.Command.InputFormat,b.InputFormatProperty.RightAligned,0);
}else{b.sendCommand(b.Command.InputFormat,b.InputFormatProperty.RightAligned,1);
}});
a("#tglBtnAlignJust").click(function(){if(a(this).hasClass("ribbon-button-selected")){b.sendCommand(b.Command.InputFormat,b.InputFormatProperty.Justified,0);
}else{b.sendCommand(b.Command.InputFormat,b.InputFormatProperty.Justified,1);
}});
a("#drpDnBtnLineSpacing").click(y);
a("#drpDnBtnBorders").click(w);
a("#drpDnBtnStyles").click(C);
a("#btnParSettings").click(function(){b.sendCommand(b.Command.ShowDialog,b.DialogCategory.TXDialog,b.TXDialogType.ParagraphFormatDialog);
});
};
function e(X){var Y=X.detail.fontNames;
Y.forEach(function(aa){var Z=document.createElement("option");
Z.text=aa;
a("#selectFont").append(Z);
});
}function f(X){var Z=X.detail.fontSizes,Y=a("#selectFontSize");
Y.empty();
Z.forEach(function(ab){var aa=document.createElement("option");
aa.text=ab;
Y.append(aa);
});
}function h(X){var Y=X.detail;
if(Y.hasOwnProperty("Bold")){g(b.InputFormatProperty.Bold,Y.Bold);
}if(Y.hasOwnProperty("Italic")){g(b.InputFormatProperty.Italic,Y.Italic);
}if(Y.hasOwnProperty("Underline")){g(b.InputFormatProperty.Underline,Y.Underline);
}if(Y.hasOwnProperty("UnderlineStyle")){g(b.InputFormatProperty.UnderlineStyle,Y.UnderlineStyle);
}if(Y.hasOwnProperty("Strikeout")){g(b.InputFormatProperty.Strikeout,Y.Strikeout);
}if(Y.hasOwnProperty("LeftAligned")){g(b.InputFormatProperty.LeftAligned,Y.LeftAligned);
}if(Y.hasOwnProperty("Centered")){g(b.InputFormatProperty.Centered,Y.Centered);
}if(Y.hasOwnProperty("RightAligned")){g(b.InputFormatProperty.RightAligned,Y.RightAligned);
}if(Y.hasOwnProperty("Justified")){g(b.InputFormatProperty.Justified,Y.Justified);
}if(Y.hasOwnProperty("RightToLeft")){g(b.InputFormatProperty.RightToLeft,Y.RightToLeft);
}if(Y.hasOwnProperty("FontFamily")){g(b.InputFormatProperty.FontFamily,0,Y.FontFamily);
}if(Y.hasOwnProperty("FontSize")){g(b.InputFormatProperty.FontSize,Y.FontSize);
}if(Y.hasOwnProperty("StyleName")){g(b.InputFormatProperty.StyleName,0,Y.StyleName);
}if(Y.hasOwnProperty("StyleNames")){g(b.InputFormatProperty.StyleNames,Y.StyleNames);
}if(Y.hasOwnProperty("BulletedList")){g(b.InputFormatProperty.BulletedList,Y.BulletedList);
}if(Y.hasOwnProperty("BulletCharacter")){g(b.InputFormatProperty.BulletCharacter,0,Y.BulletCharacter||"");
}if(Y.hasOwnProperty("NumberedList")){g(b.InputFormatProperty.NumberedList,Y.NumberedList);
}if(Y.hasOwnProperty("NumberedListFormat")){g(b.InputFormatProperty.NumberedListFormat,Y.NumberedListFormat);
}if(Y.hasOwnProperty("StructuredList")){g(b.InputFormatProperty.StructuredList,Y.StructuredList);
}if(Y.hasOwnProperty("StructuredListFormat")){g(b.InputFormatProperty.StructuredListFormat,Y.StructuredListFormat);
}if(Y.hasOwnProperty("LeftFrameLine")){g(b.InputFormatProperty.LeftFrameLine,Y.LeftFrameLine);
}if(Y.hasOwnProperty("TopFrameLine")){g(b.InputFormatProperty.TopFrameLine,Y.TopFrameLine);
}if(Y.hasOwnProperty("RightFrameLine")){g(b.InputFormatProperty.RightFrameLine,Y.RightFrameLine);
}if(Y.hasOwnProperty("BottomFrameLine")){g(b.InputFormatProperty.BottomFrameLine,Y.BottomFrameLine);
}if(Y.hasOwnProperty("BoxFrame")){g(b.InputFormatProperty.BoxFrame,Y.BoxFrame);
}if(Y.hasOwnProperty("AllFrameLines")){g(b.InputFormatProperty.AllFrameLines,Y.AllFrameLines);
}if(Y.hasOwnProperty("InnerHorizontalFrameLines")){g(b.InputFormatProperty.InnerHorizontalFrameLines,Y.InnerHorizontalFrameLines);
}if(Y.hasOwnProperty("InnerVerticalFrameLines")){g(b.InputFormatProperty.InnerVerticalFrameLines,Y.InnerVerticalFrameLines);
}if(Y.hasOwnProperty("TextColor")){g(b.InputFormatProperty.TextColor,Y.TextColor);
}if(Y.hasOwnProperty("TextBackColor")){g(b.InputFormatProperty.TextBackColor,Y.TextBackColor);
}if(Y.hasOwnProperty("Subscript")){g(b.InputFormatProperty.Subscript,Y.Subscript);
}if(Y.hasOwnProperty("Superscript")){g(b.InputFormatProperty.Superscript,Y.Superscript);
}if(Y.hasOwnProperty("LineSpacing")){g(b.InputFormatProperty.LineSpacing,Y.LineSpacing);
}}function M(Z,ab){var X=document.getElementById(Z);
if(!X){return;
}if(X.tagName!=="SELECT"){return;
}for(var Y=0;
Y<X.options.length;
++Y){var aa=X.options[Y];
if(aa.value===ab){aa.selected=true;
break;
}}}function O(X){X.stopPropagation();
}function g(ab,ad,ac){var Z=null;
switch(ab){case b.InputFormatProperty.Bold:Z=[a("#tglBtnBold")];
break;
case b.InputFormatProperty.Italic:Z=[a("#tglBtnItalic")];
break;
case b.InputFormatProperty.UnderlineStyle:var aa=new CustomEvent("underlineStyleChanged",{detail:ad});
document.dispatchEvent(aa);
break;
case b.InputFormatProperty.Strikeout:Z=[a("#tglBtnStrikethrough")];
break;
case b.InputFormatProperty.LeftAligned:Z=[a("#tglBtnAlignLeft")];
break;
case b.InputFormatProperty.Centered:Z=[a("#tglBtnAlignCenter")];
break;
case b.InputFormatProperty.RightAligned:Z=[a("#tglBtnAlignRight")];
break;
case b.InputFormatProperty.Justified:Z=[a("#tglBtnAlignJust")];
break;
case b.InputFormatProperty.RightToLeft:var Y=a("#tglBtnTextDirRTL");
var X=a("#tglBtnTextDirLTR");
if(ad){Y.addClass("ribbon-button-selected");
X.removeClass("ribbon-button-selected");
}else{Y.removeClass("ribbon-button-selected");
X.addClass("ribbon-button-selected");
}break;
case b.InputFormatProperty.FontFamily:ac=ac||"";
M("selectFont",ac);
break;
case b.InputFormatProperty.FontSize:ad=ad||0;
k=ad/20;
M("selectFontSize",""+k);
break;
case b.InputFormatProperty.StyleName:var aa=new CustomEvent("styleNameChanged",{detail:ac});
document.dispatchEvent(aa);
break;
case b.InputFormatProperty.StyleNames:var aa=new CustomEvent("styleNamesChanged",{detail:ad});
document.dispatchEvent(aa);
break;
case b.InputFormatProperty.BulletedList:Z=[a("#drpDnBtnBulletList")];
break;
case b.InputFormatProperty.BulletCharacter:R(ac);
break;
case b.InputFormatProperty.NumberedList:Z=[a("#drpDnBtnNumberedList")];
break;
case b.InputFormatProperty.NumberedListFormat:T(ad);
break;
case b.InputFormatProperty.StructuredList:Z=[a("#drpDnBtnStructuredList")];
break;
case b.InputFormatProperty.StructuredListFormat:U(ad);
break;
case b.InputFormatProperty.LeftFrameLine:Z=[a("#tglBtnBorderLeft")];
break;
case b.InputFormatProperty.TopFrameLine:Z=[a("#tglBtnBorderTop")];
break;
case b.InputFormatProperty.RightFrameLine:Z=[a("#tglBtnBorderRight")];
break;
case b.InputFormatProperty.BottomFrameLine:Z=[a("#tglBtnBorderBottom")];
break;
case b.InputFormatProperty.BoxFrame:Z=[a("#drpDnBtnBorders"),a("#tglBtnBorderOutside")];
break;
case b.InputFormatProperty.AllFrameLines:Z=[a("#tglBtnBorderAll")];
break;
case b.InputFormatProperty.InnerHorizontalFrameLines:Z=[a("#tglBtnBorderInsideHor")];
break;
case b.InputFormatProperty.InnerVerticalFrameLines:Z=[a("#tglBtnBorderInsideVert")];
break;
case b.InputFormatProperty.TextColor:if(ad){s=c(ad);
}else{s="#000000";
}break;
case b.InputFormatProperty.TextBackColor:if(ad){r=c(ad);
}else{r="#FFFFFF";
}break;
case b.InputFormatProperty.Subscript:Z=[a("#tglBtnSubscript")];
break;
case b.InputFormatProperty.Superscript:Z=[a("#tglBtnSuperscript")];
break;
case b.InputFormatProperty.LineSpacing:S(ad);
break;
}if(Z){Z.forEach(function(ae){if(ad){ae.addClass("ribbon-button-selected");
}else{ae.removeClass("ribbon-button-selected");
}});
}}function P(X){var Y=X.detail;
l=Y;
L();
}function Q(X){var Y=X.detail;
K(Y);
a("#stylesDropDown").menu("refresh");
}function W(X){var Y=X.detail,Z=false;
a("#ulStylesDropDown div.ribbon-button-checkmark").removeClass("ribbon-button-selected");
switch(Y){case b.FontUnderlineStyle.Single:a("#tglBtnULStyleSingle").addClass("ribbon-button-selected");
Z=true;
break;
case b.FontUnderlineStyle.Doubled:a("#tglBtnULStyleDoubled").addClass("ribbon-button-selected");
Z=true;
break;
case b.FontUnderlineStyle.SingleWordsOnly:a("#tglBtnULStyleSingleWO").addClass("ribbon-button-selected");
Z=true;
break;
case b.FontUnderlineStyle.DoubledWordsOnly:a("#tglBtnULStyleDoubledWO").addClass("ribbon-button-selected");
Z=true;
break;
}if(Z){a("#drpDnBtnUnderlineStyles").addClass("ribbon-button-selected");
}else{a("#drpDnBtnUnderlineStyles").removeClass("ribbon-button-selected");
}}function A(Y){b.fileMenu.hide();
b.hideAllMenus_homeTab();
var X=document.getElementById("pasteDropDown");
b.calcMenuWidths(X);
o.show().position({my:"left top",at:"left bottom",of:Y.currentTarget});
a(document).one("click",function(){o.hide();
});
return false;
}function G(Y,Z){switch(Z.item.context.id){case"mnuItemServerPaste":b.sendCommand(b.Command.Paste);
break;
case"mnuItemClientPaste":var X=new b.ClientPasteDialog();
X.showModal();
break;
}}function w(Y){b.fileMenu.hide();
b.hideAllMenus_homeTab();
var X=document.getElementById("bordersDropDown");
b.calcMenuWidths(X);
i.show().position({my:"left top",at:"left bottom",of:Y.currentTarget});
a(document).one("click",function(){i.hide();
});
return false;
}function u(Y,aa){var X=null,Z;
switch(aa.item.context.id){case"mnuItemBorderLeft":X=a("#tglBtnBorderLeft");
Z=b.InputFormatProperty.LeftFrameLine;
break;
case"mnuItemBorderTop":X=a("#tglBtnBorderTop");
Z=b.InputFormatProperty.TopFrameLine;
break;
case"mnuItemBorderRight":X=a("#tglBtnBorderRight");
Z=b.InputFormatProperty.RightFrameLine;
break;
case"mnuItemBorderBottom":X=a("#tglBtnBorderBottom");
Z=b.InputFormatProperty.BottomFrameLine;
break;
case"mnuItemBorderOutside":X=a("#tglBtnBorderOutside");
Z=b.InputFormatProperty.BoxFrame;
break;
case"mnuItemBorderAll":X=a("#tglBtnBorderAll");
Z=b.InputFormatProperty.AllFrameLines;
break;
case"mnuItemBorderInsideHor":X=a("#tglBtnBorderInsideHor");
Z=b.InputFormatProperty.InnerHorizontalFrameLines;
break;
case"mnuItemBorderInsideVert":X=a("#tglBtnBorderInsideVert");
Z=b.InputFormatProperty.InnerVerticalFrameLines;
break;
}if(X){if(X.hasClass("ribbon-button-selected")){b.sendCommand(b.Command.InputFormat,Z,0);
}else{b.sendCommand(b.Command.InputFormat,Z,1);
}}}function x(Y){b.fileMenu.hide();
b.hideAllMenus_homeTab();
var X=document.getElementById("bulletListDropDown");
b.calcMenuWidths(X);
j.show().position({my:"left top",at:"left bottom",of:Y.currentTarget});
a(document).one("click",function(){j.hide();
});
return false;
}function v(Z,aa){var X=null,Y;
switch(aa.item.context.id){case"mnuItemBulletListDisc":X=a("#tglBtnBulletListDisc");
Y="\u00B7";
break;
case"mnuItemBulletListDash":X=a("#tglBtnBulletListDash");
Y="-";
break;
case"mnuItemBulletListAsterisk":X=a("#tglBtnBulletListAsterisk");
Y="*";
break;
case"mnuItemBulletListDiamond":X=a("#tglBtnBulletListDiamond");
Y="\u00A8";
break;
case"mnuItemBulletListArrow":X=a("#tglBtnBulletListArrow");
Y="\u00AE";
break;
case"mnuItemListFormatBullet":b.sendCommand(b.Command.ShowDialog,b.DialogCategory.TXDialog,b.TXDialogType.ListFormatDialog);
break;
}if(X){if(X.hasClass("ribbon-button-selected")){b.sendCommand(b.Command.InputFormat,b.InputFormatProperty.BulletedList,0);
}else{b.sendCommand(b.Command.InputFormat,b.InputFormatProperty.BulletedList,1);
b.sendCommand(b.Command.InputFormat,b.InputFormatProperty.BulletCharacter,0,0,Y);
}}}function z(Y){b.fileMenu.hide();
b.hideAllMenus_homeTab();
var X=document.getElementById("numberedListDropDown");
b.calcMenuWidths(X);
n.show().position({my:"left top",at:"left bottom",of:Y.currentTarget});
a(document).one("click",function(){n.hide();
});
return false;
}function F(Y,aa){var X=null,Z;
switch(aa.item.context.id){case"mnuItemNumberedList_123":X=a("#tglBtnNumberedList_123");
Z=b.NumberFormat.ArabicNumbers;
break;
case"mnuItemNumberedList_abc":X=a("#tglBtnNumberedList_abc");
Z=b.NumberFormat.Letters;
break;
case"mnuItemNumberedList_ABC":X=a("#tglBtnNumberedList_ABC");
Z=b.NumberFormat.CapitalLetters;
break;
case"mnuItemNumberedList_III":X=a("#tglBtnNumberedList_III");
Z=b.NumberFormat.RomanNumbers;
break;
case"mnuItemNumberedList_iii":X=a("#tglBtnNumberedList_iii");
Z=b.NumberFormat.SmallRomanNumbers;
break;
case"mnuItemFormatListNumbered":b.sendCommand(b.Command.ShowDialog,b.DialogCategory.TXDialog,b.TXDialogType.ListFormatDialog);
break;
}if(X){if(X.hasClass("ribbon-button-selected")){b.sendCommand(b.Command.InputFormat,b.InputFormatProperty.NumberedList,0);
}else{b.sendCommand(b.Command.InputFormat,b.InputFormatProperty.NumberedList,1);
b.sendCommand(b.Command.InputFormat,b.InputFormatProperty.NumberedListFormat,Z);
}}}function B(Y){b.fileMenu.hide();
b.hideAllMenus_homeTab();
var X=document.getElementById("structuredListDropDown");
b.calcMenuWidths(X);
p.show().position({my:"left top",at:"left bottom",of:Y.currentTarget});
a(document).one("click",function(){p.hide();
});
return false;
}function H(Y,aa){var X=null,Z;
switch(aa.item.context.id){case"mnuItemStructuredList_123":X=a("#tglBtnStructuredList_123");
Z=b.NumberFormat.ArabicNumbers;
break;
case"mnuItemStructuredList_abc":X=a("#tglBtnStructuredList_abc");
Z=b.NumberFormat.Letters;
break;
case"mnuItemStructuredList_ABC":X=a("#tglBtnStructuredList_ABC");
Z=b.NumberFormat.CapitalLetters;
break;
case"mnuItemStructuredList_III":X=a("#tglBtnStructuredList_III");
Z=b.NumberFormat.RomanNumbers;
break;
case"mnuItemStructuredList_iii":X=a("#tglBtnStructuredList_iii");
Z=b.NumberFormat.SmallRomanNumbers;
break;
case"mnuItemFormatListStructured":b.sendCommand(b.Command.ShowDialog,b.DialogCategory.TXDialog,b.TXDialogType.ListFormatDialog);
break;
}if(X){if(X.hasClass("ribbon-button-selected")){b.sendCommand(b.Command.InputFormat,b.InputFormatProperty.StructuredList,0);
}else{b.sendCommand(b.Command.InputFormat,b.InputFormatProperty.StructuredList,1);
b.sendCommand(b.Command.InputFormat,b.InputFormatProperty.StructuredListFormat,Z);
}}}function y(Y){b.fileMenu.hide();
b.hideAllMenus_homeTab();
var X=document.getElementById("lineSpacingDropDown");
b.calcMenuWidths(X);
m.show().position({my:"left top",at:"left bottom",of:Y.currentTarget});
a(document).one("click",function(){m.hide();
});
return false;
}function E(Y,aa){var X=null,Z=0;
switch(aa.item.context.id){case"mnuItemLineSpacing_1_0":Z=100;
break;
case"mnuItemLineSpacing_1_15":Z=115;
break;
case"mnuItemLineSpacing_1_5":Z=150;
break;
case"mnuItemLineSpacing_2_0":Z=200;
break;
case"mnuItemLineSpacing_2_5":Z=250;
break;
case"mnuItemLineSpacing_3_0":Z=300;
break;
}if(Z){b.sendCommand(b.Command.InputFormat,b.InputFormatProperty.LineSpacing,Z);
}}function D(Y){b.fileMenu.hide();
b.hideAllMenus_homeTab();
var X=document.getElementById("ulStylesDropDown");
b.calcMenuWidths(X);
t.show().position({my:"left top",at:"left bottom",of:Y.currentTarget});
a(document).one("click",function(){t.hide();
});
return false;
}function J(X,ab){var Y=ab.item.context.id;
var aa=a("#"+Y+" div.ribbon-button-checkmark");
var Z=aa.hasClass("ribbon-button-selected");
var ac=b.FontUnderlineStyle.None;
switch(Y){case"mnuItmULStyleSingle":if(!Z){ac=b.FontUnderlineStyle.Single;
}break;
case"mnuItmULStyleDoubled":if(!Z){ac=b.FontUnderlineStyle.Doubled;
}break;
case"mnuItmULStyleSingleWO":if(!Z){ac=b.FontUnderlineStyle.SingleWordsOnly;
}break;
case"mnuItmULStyleDoubledWO":if(!Z){ac=b.FontUnderlineStyle.DoubledWordsOnly;
}break;
}if(ac){b.sendCommand(b.Command.InputFormat,b.InputFormatProperty.UnderlineStyle,ac);
}}function C(Y){b.fileMenu.hide();
b.hideAllMenus_homeTab();
var X=document.getElementById("stylesDropDown");
X.style.height=null;
var aa=b.clientSize.Height-b.RibbonBarHeight-b.StatusBarHeight-b.ScrollbarWidth;
b.calcMenuWidths(X);
q.show().position({my:"left top",at:"left bottom",of:Y.currentTarget});
var ab=a("#stylesDropDown"),Z=ab.height();
if(Z>aa){ab.css("overflow-y","scroll");
}else{ab.css("overflow-y","");
}ab.height(Math.min(aa,Z));
a(document).one("click",function(){q.hide();
});
return false;
}function I(X,Y){switch(Y.item.context.id){case"mnuItemManageStyles":b.sendCommand(b.Command.ShowDialog,b.DialogCategory.TXDialog,b.TXDialogType.FormattingStylesDialog);
break;
default:N(Y.item.context.attributes["data-style-name"].value);
break;
}}function L(){var Y=a("#stylesDropDown > li > a > div.ribbon-button.ribbon-button-selected");
if(Y){Y.removeClass("ribbon-button-selected");
}var X=a('#stylesDropDown > li[data-style-name="'+l+'"] > a > div.ribbon-button');
if(X){X.addClass("ribbon-button-selected");
}}function N(X){b.sendCommand(b.Command.InputFormat,b.InputFormatProperty.StyleName,0,0,X);
}function K(Y){var X=document.getElementById("mnuItemManageStyles").cloneNode(true),Z=document.getElementById("stylesDropDown");
Z.innerHTML="";
Y.forEach(function(af){var ae=document.createElement("li");
Z.appendChild(ae);
ae.style.overflowX="hidden";
ae.setAttribute("data-style-name",af);
ae.setAttribute("title",af);
var aa=document.createElement("a");
ae.appendChild(aa);
aa.style.width="1000px";
aa.setAttribute("href","#");
var ab=document.createElement("div");
aa.appendChild(ab);
ab.className="ribbon-button ribbon-button-tiny ribbon-button-checkmark";
var ac=document.createElement("img");
ab.appendChild(ac);
ac.setAttribute("src",b.imageResources.small.checkmark);
ab=document.createElement("div");
aa.appendChild(ab);
ab.className="small-menu-item-caption-container";
ab.style.overflowX="hidden";
var ad=document.createElement("p");
ab.appendChild(ad);
ad.textContent=af;
});
Z.appendChild(X);
}function R(Y){Y=Y||"";
var X=null;
a("#bulletListDropDown div.ribbon-button-42px").removeClass("ribbon-button-selected");
switch(Y){case"\u00B7":X=a("#tglBtnBulletListDisc");
break;
case"-":X=a("#tglBtnBulletListDash");
break;
case"*":X=a("#tglBtnBulletListAsterisk");
break;
case"\u00A8":X=a("#tglBtnBulletListDiamond");
break;
case"\u00AE":X=a("#tglBtnBulletListArrow");
break;
}if(X){X.addClass("ribbon-button-selected");
}}function T(Y){var X=null;
Y=Y||0;
a("#numberedListDropDown div.ribbon-button-numbered-list").removeClass("ribbon-button-selected");
switch(Y){case b.NumberFormat.ArabicNumbers:X=a("#tglBtnNumberedList_123");
break;
case b.NumberFormat.Letters:X=a("#tglBtnNumberedList_abc");
break;
case b.NumberFormat.CapitalLetters:X=a("#tglBtnNumberedList_ABC");
break;
case b.NumberFormat.RomanNumbers:X=a("#tglBtnNumberedList_III");
break;
case b.NumberFormat.SmallRomanNumbers:X=a("#tglBtnNumberedList_iii");
break;
}if(X){X.addClass("ribbon-button-selected");
}}function U(Y){var X=null;
Y=Y||0;
a("#structuredListDropDown div.ribbon-button-numbered-list").removeClass("ribbon-button-selected");
switch(Y){case b.NumberFormat.ArabicNumbers:X=a("#tglBtnStructuredList_123");
break;
case b.NumberFormat.Letters:X=a("#tglBtnStructuredList_abc");
break;
case b.NumberFormat.CapitalLetters:X=a("#tglBtnStructuredList_ABC");
break;
case b.NumberFormat.RomanNumbers:X=a("#tglBtnStructuredList_III");
break;
case b.NumberFormat.SmallRomanNumbers:X=a("#tglBtnStructuredList_iii");
break;
}if(X){X.addClass("ribbon-button-selected");
}}function S(Y){var X=null;
Y=Y||0;
a("#lineSpacingDropDown div.ribbon-button-checkmark").removeClass("ribbon-button-selected");
switch(Y){case 100:X=a("#tglBtnLineSpacing_1_0");
break;
case 115:X=a("#tglBtnLineSpacing_1_15");
break;
case 150:X=a("#tglBtnLineSpacing_1_5");
break;
case 200:X=a("#tglBtnLineSpacing_2_0");
break;
case 250:X=a("#tglBtnLineSpacing_2_5");
break;
case 300:X=a("#tglBtnLineSpacing_3_0");
break;
}if(X){X.addClass("ribbon-button-selected");
}}function d(X,Z){var Y=Number(X).toString(16);
Z=Z||2;
while(Y.length<Z){Y="0"+Y;
}return Y;
}function c(X){return"#"+d(X.R)+d(X.G)+d(X.B);
}b.limitMenuHeight=function(aa){var X=document.getElementById(aa);
X.style.height=null;
var Y=X.clientHeight;
var Z=b.clientSize.Height-b.RibbonBarHeight-b.StatusBarHeight-b.ScrollbarWidth;
if(Z<Y){X.style.height=Z+"px";
}};
b.hideAllMenus_homeTab=function(){j.hide();
i.hide();
n.hide();
p.hide();
m.hide();
q.hide();
t.hide();
o.hide();
};
return V;
}(TXTextControl||{},j$1_10_2));
var TXTextControl=(function(N,a){var b=N._private=N._private||{};
var o,j,n,k,m,l,p,s,r,q;
b.BarcodeType={QRCode:1,Code128:2,EAN13:3,UPCA:4,EAN8:5,Interleaved2of5:6,Postnet:7,Code39:8,AztecCode:9,IntelligentMail:10,Datamatrix:11,PDF417:12,MicroPDF:13,Codabar:14,FourState:15,Code11:16,Code93:17,PLANET:18,RoyalMail:19,Maxicode:20,};
b.insertShapesMenuContent={};
b.attachInsertTabEventHandlers=function(){o=a("#insertImageDropDown").menu().hide();
j=a("#insertBarcodeDropDown").menu().hide();
n=a("#insertHyperlinkDropDown").menu().hide();
k=a("#insertBookmarkDropDown").menu().hide();
m=a("#insertHeaderDropDown").menu().hide();
l=a("#insertFooterDropDown").menu().hide();
p=a("#insertPageNumberDropDown").menu().hide();
s=a("#insertTextFrameDropDown").menu().hide();
r=a("#insertSymbolDropDown").menu().hide();
o.on("menuselect",E);
j.on("menuselect",u);
n.on("menuselect",C);
k.on("menuselect",w);
m.on("menuselect",A);
l.on("menuselect",y);
p.on("menuselect",G);
s.on("menuselect",M);
r.on("menuselect",K);
document.addEventListener("txItemReceived",O);
document.addEventListener("headerFooterActivated",e);
document.addEventListener("headerFooterDeactivated",f);
a("#btnBlankPage").click(function(){b.sendCommand(b.Command.InsertBlankPage);
});
a("#btnPageBreak").click(function(){b.sendCommand(b.Command.InsertBreak,b.BreakType.Page);
});
a("#btnInsertChart").click(function(){b.sendCommand(b.Command.InsertItem,b.ItemType.Chart);
});
a("#btnInsertTable").click(function(){b.sendCommand(b.Command.ShowDialog,b.DialogCategory.TXDialog,b.TXDialogType.InsertTableDialog);
});
a("#btnInsertFile").click(function(){g();
});
a("#drpDnBtnInsertHyperlink").click(B);
a("#drpDnBtnInsertBarcode").click(t);
a("#drpDnBtnInsertImage").click(D);
a("#drpDnBtnInsertShape").click(H);
a("#drpDnBtnInsertBookmark").click(v);
a("#drpDnBtnInsertHeader").click(z);
a("#drpDnBtnInsertFooter").click(x);
a("#drpDnBtnInsertPageNum").click(F);
a("#drpDnBtnInsertTextFrame").click(L);
a("#drpDnBtnInsertSymbol").click(J);
};
function h(){b.openFile(b.FileType.Image);
}function i(){b.sendCommand(b.Command.InsertItem,b.ItemType.ImagePlaceholder);
}function g(){var P=new b.OpenFileDialog(b.Command.InsertDocumentFile,b.FileType.Document);
P.showModal();
}function O(P){var R=P.detail.itemType;
var Q=P.detail.item;
if(Q==null){return;
}switch(R){case b.ItemType.HypertextLink:case b.ItemType.DocumentLink:a("#mnuItemEditHyperlink").removeClass("ui-state-disabled");
a("#mnuItemDeleteHyperlink").removeClass("ui-state-disabled");
break;
case b.ItemType.DocumentTarget:a("#mnuItemDeleteBookmark").removeClass("ui-state-disabled");
a("#mnuItemEditBookmark").removeClass("ui-state-disabled");
break;
}}function e(){a("#mnuItemInsertPageNum").removeClass("ui-state-disabled");
}function f(){a("#mnuItemInsertPageNum").addClass("ui-state-disabled");
}b.applyShapesMenuContent=function(){var P=b.insertShapesMenuContent;
d(P);
delete b.insertShapesMenuContent;
q=a("#insertShapesDropDown").menu().hide();
q.on("menuselect",I);
};
function d(R){var Q=document.getElementById("insertShapesDropDown");
c(R,Q);
var P=document.querySelector("#mnuItmDrawingMarkerLines div.small-menu-item-image-wrapper");
P.classList.add("ribbon-button");
}function c(Q,P){P.innerHTML="";
if(!P.id){P.style.maxHeight="200px";
P.style.overflowY="auto";
}Q.forEach(function(X){var U=document.createElement("li");
if(X.HtmlElemID){U.id=X.HtmlElemID;
}if(X.ShapeType>-1){U.setAttribute("data-item-shape-type",X.ShapeType);
}P.appendChild(U);
var R=document.createElement("a");
R.href="#!";
if(X.WithSeparator){R.style.borderTop="1px solid lightgray";
}U.appendChild(R);
var S=document.createElement("div");
S.classList.add("small-menu-item-image-wrapper");
if(X.ImageDataURL){var T=document.createElement("img");
T.src=X.ImageDataURL;
S.appendChild(T);
}R.appendChild(S);
S=document.createElement("div");
S.classList.add("small-menu-item-caption-container");
R.appendChild(S);
var V=document.createElement("p");
V.textContent=X.Text;
S.appendChild(V);
if(X.hasOwnProperty("Items")&&X.Items.length){var W=document.createElement("ul");
W.classList.add("dropDownMenu");
U.appendChild(W);
c(X.Items,W);
}});
}function D(Q){b.fileMenu.hide();
b.hideAllMenus_insertTab();
var P=document.getElementById("insertImageDropDown");
b.calcMenuWidths(P);
o.show().position({my:"left top",at:"left bottom",of:Q.currentTarget});
a(document).one("click",function(){o.hide();
});
return false;
}function E(P,Q){switch(Q.item.context.id){case"mnuItemInsertImage":h();
break;
case"mnuItemInsertImagePlacehld":i();
break;
}}function H(Q){b.fileMenu.hide();
b.hideAllMenus_insertTab();
var P=document.getElementById("insertShapesDropDown");
b.calcMenuWidths(P);
q.show().position({my:"left top",at:"left bottom",of:Q.currentTarget});
a(document).on("click",function(R){if(!(b.isInsideElementWithID(R.target,"insertShapesDropDown")&&b.isPartOfMenuItemWithSubMenu(R.target))){q.hide();
a(document).off(R);
}});
return false;
}function I(S,U){var R=U.item.context;
var P=R.attributes["data-item-shape-type"];
if(P){var T=parseInt(P.value,10);
b.sendCommand(b.Command.InsertItem,b.ItemType.Shape,T);
}else{if(R.id){switch(R.id){case"mnuItmNewDrawingCanvas":b.sendCommand(b.Command.InsertItem,b.ItemType.DrawingCanvas);
break;
case"mnuItmDrawingMarkerLines":var Q=document.querySelector("#mnuItmDrawingMarkerLines div.small-menu-item-image-wrapper");
if(Q.classList.contains("ribbon-button-selected")){Q.classList.remove("ribbon-button-selected");
b.sendCommand(b.Command.DisplayVisualElement,b.VisualElement.DrawingMarkerLines,0);
}else{Q.classList.add("ribbon-button-selected");
b.sendCommand(b.Command.DisplayVisualElement,b.VisualElement.DrawingMarkerLines,1);
}break;
}}}}function t(Q){b.fileMenu.hide();
b.hideAllMenus_insertTab();
var P=document.getElementById("insertBarcodeDropDown");
b.calcMenuWidths(P);
j.show().position({my:"left top",at:"left bottom",of:Q.currentTarget});
b.limitMenuHeight("insertBarcodeDropDown");
a(document).one("click",function(){j.hide();
});
return false;
}function u(Q,R){var P;
switch(R.item.context.id){case"mnuItemInsertQRCode":P=b.BarcodeType.QRCode;
break;
case"mnuItemInsertAztecCode":P=b.BarcodeType.AztecCode;
break;
case"mnuItemInsertDatamatrix":P=b.BarcodeType.Datamatrix;
break;
case"mnuItemInsertPDF417":P=b.BarcodeType.PDF417;
break;
case"mnuItemInsertMicroPDF":P=b.BarcodeType.MicroPDF;
break;
case"mnuItemInsertMaxicode":P=b.BarcodeType.Maxicode;
break;
case"mnuItemInsertCode128":P=b.BarcodeType.Code128;
break;
case"mnuItemInsertEAN13":P=b.BarcodeType.EAN13;
break;
case"mnuItemInsertUPCA":P=b.BarcodeType.UPCA;
break;
case"mnuItemInsertEAN8":P=b.BarcodeType.EAN8;
break;
case"mnuItemInsertInterleaved2of5":P=b.BarcodeType.Interleaved2of5;
break;
case"mnuItemInsertPostnet":P=b.BarcodeType.Postnet;
break;
case"mnuItemInsertCode39":P=b.BarcodeType.Code39;
break;
case"mnuItemInsertIntelligentMail":P=b.BarcodeType.IntelligentMail;
break;
case"mnuItemInsertCodabar":P=b.BarcodeType.Codabar;
break;
case"mnuItemInsertFourState":P=b.BarcodeType.FourState;
break;
case"mnuItemInsertCode11":P=b.BarcodeType.Code11;
break;
case"mnuItemInsertCode93":P=b.BarcodeType.Code93;
break;
case"mnuItemInsertPLANET":P=b.BarcodeType.PLANET;
break;
case"mnuItemInsertRoyalMail":P=b.BarcodeType.RoyalMail;
break;
}if(P){b.sendCommand(b.Command.InsertItem,b.ItemType.Barcode,P);
}}function B(Q){b.fileMenu.hide();
b.hideAllMenus_insertTab();
a("#mnuItemEditHyperlink").addClass("ui-state-disabled");
a("#mnuItemDeleteHyperlink").addClass("ui-state-disabled");
b.sendCommand(b.Command.GetItem,b.ItemType.Link);
var P=document.getElementById("insertHyperlinkDropDown");
b.calcMenuWidths(P);
n.show().position({my:"left top",at:"left bottom",of:Q.currentTarget});
a(document).one("click",function(){n.hide();
});
return false;
}function C(Q,R){switch(R.item.context.id){case"mnuItemInsertHyperlink":case"mnuItemEditHyperlink":var P=new b.HyperlinkDialog();
P.showModal();
break;
case"mnuItemDeleteHyperlink":b.sendCommand(b.Command.DeleteItem,b.ItemType.Link);
break;
}}function v(Q){b.fileMenu.hide();
b.hideAllMenus_insertTab();
a("#mnuItemDeleteBookmark").addClass("ui-state-disabled");
a("#mnuItemEditBookmark").addClass("ui-state-disabled");
b.sendCommand(b.Command.GetItem,b.ItemType.DocumentTarget);
var P=document.getElementById("insertBookmarkDropDown");
b.calcMenuWidths(P);
k.show().position({my:"left top",at:"left bottom",of:Q.currentTarget});
a(document).one("click",function(){k.hide();
});
return false;
}function w(Q,R){switch(R.item.context.id){case"mnuItemEditBookmark":case"mnuItemInsertBookmark":b.sendCommand(b.Command.InsertItem,b.ItemType.DocumentTarget);
break;
case"mnuItemDeleteBookmark":b.sendCommand(b.Command.DeleteItem,b.ItemType.DocumentTarget);
break;
case"mnuItemShowBookmarkMarkers":var P=a("#tglBtnShowBookmarkMarkers");
if(P.hasClass("ribbon-button-selected")){b.sendCommand(b.Command.DisplayVisualElement,b.VisualElement.BookmarkMarkers,0);
P.removeClass("ribbon-button-selected");
}else{b.sendCommand(b.Command.DisplayVisualElement,b.VisualElement.BookmarkMarkers,1);
P.addClass("ribbon-button-selected");
}break;
}}function z(Q){b.fileMenu.hide();
b.hideAllMenus_insertTab();
var P=document.getElementById("insertHeaderDropDown");
b.calcMenuWidths(P);
m.show().position({my:"left top",at:"left bottom",of:Q.currentTarget});
a(document).one("click",function(){m.hide();
});
return false;
}function A(P,Q){switch(Q.item.context.id){case"mnuItemEditHeader":b.sendCommand(b.Command.InsertItem,b.ItemType.HeaderFooter,b.HeaderFooterType.Header);
break;
case"mnuItemRemoveHeader":b.sendCommand(b.Command.DeleteItem,b.ItemType.HeaderFooter,b.HeaderFooterType.Header);
break;
}}function x(Q){b.fileMenu.hide();
b.hideAllMenus_insertTab();
var P=document.getElementById("insertFooterDropDown");
b.calcMenuWidths(P);
l.show().position({my:"left top",at:"left bottom",of:Q.currentTarget});
a(document).one("click",function(){l.hide();
});
return false;
}function y(P,Q){switch(Q.item.context.id){case"mnuItemEditFooter":b.sendCommand(b.Command.InsertItem,b.ItemType.HeaderFooter,b.HeaderFooterType.Footer);
break;
case"mnuItemRemoveFooter":b.sendCommand(b.Command.DeleteItem,b.ItemType.HeaderFooter,b.HeaderFooterType.Footer);
break;
}}function F(Q){b.fileMenu.hide();
b.hideAllMenus_insertTab();
var P=document.getElementById("insertPageNumberDropDown");
b.calcMenuWidths(P);
p.show().position({my:"left top",at:"left bottom",of:Q.currentTarget});
a(document).one("click",function(){p.hide();
});
return false;
}function G(P,Q){switch(Q.item.context.id){case"mnuItemInsertPageNum":b.textViewer.focus();
b.sendCommand(b.Command.InsertItem,b.ItemType.PageNumber);
break;
case"mnuItemPageNumRemove":b.sendCommand(b.Command.DeleteItem,b.ItemType.PageNumber,b.HeaderFooterType.All);
break;
}}function L(Q){b.fileMenu.hide();
b.hideAllMenus_insertTab();
var P=document.getElementById("insertTextFrameDropDown");
b.calcMenuWidths(P);
s.show().position({my:"left top",at:"left bottom",of:Q.currentTarget});
a(document).one("click",function(){s.hide();
});
return false;
}function M(Q,R){switch(R.item.context.id){case"mnuItemInsertTextFrame":b.sendCommand(b.Command.InsertItem,b.ItemType.TextFrame);
break;
case"mnuItemShowTextFrameMarkerLines":var P=a("#tglBtnShowTextFrameMarkerLines");
if(P.hasClass("ribbon-button-selected")){b.sendCommand(b.Command.DisplayVisualElement,b.VisualElement.TextFrameMarkerLines,0);
P.removeClass("ribbon-button-selected");
}else{b.sendCommand(b.Command.DisplayVisualElement,b.VisualElement.TextFrameMarkerLines,1);
P.addClass("ribbon-button-selected");
}break;
}}function J(P){b.fileMenu.hide();
b.hideAllMenus_insertTab();
r.show().position({my:"left top",at:"left bottom",of:P.currentTarget});
a(document).one("click",function(){r.hide();
});
return false;
}function K(R,T){var Q=T.item.context;
if(Q.id==="mnuItemMoreSymbols"){b.sendCommand(b.Command.ShowDialog,b.DialogCategory.TXDialog,b.TXDialogType.InsertSymbolDialog);
}else{var Q=Q.children[0];
var S=Q.text||null;
if(S){var P=S.charCodeAt(0);
b.sendCommand(b.Command.ComponentEvent,b.UserInputEventType.KeyPress,b.ComponentType.TextView,0,{key:P});
}}}b.hideAllMenus_insertTab=function(){o.hide();
j.hide();
n.hide();
k.hide();
m.hide();
l.hide();
p.hide();
s.hide();
r.hide();
q.hide();
};
return N;
}(TXTextControl||{},j$1_10_2));
var TXTextControl=(function(l,a){var b=l._private=l._private||{};
b.SectionFormatDialogTab={MarginsAndPaper:0,HeadersAndFooters:1,Columns:2,Borders:3};
var e,d,c;
b.attachPageLayoutTabEventHandlers=function(){e=a("#pageOrientationDropDown").menu().hide();
d=a("#pageColumnsDropDown").menu().hide();
c=a("#pageBreaksDropDown").menu().hide();
e.on("menuselect",k);
d.on("menuselect",i);
c.on("menuselect",g);
a("#btnPageSettings").click(function(){b.hideAllMenus_pageLayoutTab();
b.sendCommand(b.Command.ShowDialog,b.DialogCategory.TXDialog,b.TXDialogType.SectionFormatDialog,b.SectionFormatDialogTab.MarginsAndPaper);
return false;
});
a("#btnsPageBorders").click(function(){b.hideAllMenus_pageLayoutTab();
b.sendCommand(b.Command.ShowDialog,b.DialogCategory.TXDialog,b.TXDialogType.SectionFormatDialog,b.SectionFormatDialogTab.Borders);
return false;
});
a("#drpDnBtnPageOrientation").click(j);
a("#drpDnBtnPageColumns").click(h);
a("#drpDnBtnPageBreaks").click(f);
};
function j(n){b.fileMenu.hide();
b.hideAllMenus_pageLayoutTab();
var m=document.getElementById("pageOrientationDropDown");
b.calcMenuWidths(m);
e.show().position({my:"left top",at:"left bottom",of:n.currentTarget});
a(document).one("click",function(){e.hide();
});
return false;
}function k(m,n){switch(n.item.context.id){case"mnuItemPortrait":b.sendCommand(b.Command.SetLandscape,0);
break;
case"mnuItemLandscape":b.sendCommand(b.Command.SetLandscape,1);
break;
}}function h(n){b.fileMenu.hide();
b.hideAllMenus_pageLayoutTab();
var m=document.getElementById("pageColumnsDropDown");
b.calcMenuWidths(m);
d.show().position({my:"left top",at:"left bottom",of:n.currentTarget});
a(document).one("click",function(){d.hide();
});
return false;
}function i(m,n){switch(n.item.context.id){case"mnuItemOneColumn":b.sendCommand(b.Command.PageColumns,1);
break;
case"mnuItemTwoColumns":b.sendCommand(b.Command.PageColumns,2);
break;
case"mnuItemThreeColumns":b.sendCommand(b.Command.PageColumns,3);
break;
case"mnuItemMoreColumns":b.sendCommand(b.Command.ShowDialog,b.DialogCategory.TXDialog,b.TXDialogType.SectionFormatDialog,b.SectionFormatDialogTab.Columns);
break;
}}function f(n){b.fileMenu.hide();
b.hideAllMenus_pageLayoutTab();
var m=document.getElementById("pageBreaksDropDown");
b.calcMenuWidths(m);
c.show().position({my:"left top",at:"left bottom",of:n.currentTarget});
a(document).one("click",function(){c.hide();
});
return false;
}function g(m,n){switch(n.item.context.id){case"mnuItemPageBreakPage":b.sendCommand(b.Command.InsertBreak,b.BreakType.Page);
break;
case"mnuItemPageBreakColumn":b.sendCommand(b.Command.InsertBreak,b.BreakType.Column);
break;
case"mnuItemPageBreakTextWrap":b.sendCommand(b.Command.InsertBreak,b.BreakType.NextLine);
break;
case"mnuItemSectionBreakPage":b.sendCommand(b.Command.InsertBreak,b.BreakType.SectionNextPage);
break;
case"mnuItemSectionBreakCont":b.sendCommand(b.Command.InsertBreak,b.BreakType.SectionContinuous);
break;
}}b.hideAllMenus_pageLayoutTab=function(){e.hide();
c.hide();
d.hide();
};
return l;
}(TXTextControl||{},j$1_10_2));
var TXTextControl=(function(E,a){var b=E._private=E._private||{};
var p,o,n,m;
b.masterTableName="";
b.dbScheme=null;
b.currentFieldData={fieldAdapter:null,mergeFieldType:null,textField:null};
var t=(function(){function G(H){H=H||"MERGEFIELD";
this.Name=H;
this.Text="«"+H+"»";
this.TextFormat=0;
this.TextBefore="";
this.TextAfter="";
this.DateTimeFormat="";
this.NumericFormat="";
this.PreserveFormatting=true;
}return G;
})();
b.MailMergeNavButton={First:0,Previous:1,Next:2,Last:3,};
b.attachMailingsTabEventHandlers=function(){o=a("#insertSpecialFieldDropDown").menu().hide();
m=a("#insertMergeBlockDropDown").menu().hide();
n=a("#insertMergeFieldDropDown").menu().hide();
o.on("menuselect",A);
m.on("menuselect",w);
n.on("menuselect",y);
document.addEventListener("dbSchemeReceived",e);
document.addEventListener("fieldDisplayModeChanged",g);
document.addEventListener("fieldDataReceived",f);
document.addEventListener("masterTableSelected",q);
document.addEventListener("mergeFieldHighlightingChanged",u);
document.addEventListener("mergeBlockHighlightingChanged",r);
document.addEventListener("txItemReceived",F);
a("#btnLoadDBScheme").click(function(){b.openFile(b.FileType.DataBase);
});
a("#btnEditDataRelations").click(function(){b.sendCommand(b.Command.EditDataRelations);
});
a("#btnFieldProperties").click(function(){if(b.currentFieldData){b.showFieldDialog(b.currentFieldData.fieldAdapter,b.currentFieldData.mergeFieldType);
}});
a("#btnDeleteField").click(function(){b.sendCommand(b.Command.DeleteItem,b.ItemType.ApplicationField);
});
a("#btnEditMergeBlocks").click(function(){b.sendCommand(b.Command.EditMergeBlocks);
});
a("#tglBtnShowFieldCodes").click(function(){if(!a(this).hasClass("ribbon-button-selected")){b.sendCommand(b.Command.SetFieldDisplayMode,b.FieldDisplayMode.ShowFieldCodes);
}});
a("#tglBtnShowFieldText").click(function(){if(!a(this).hasClass("ribbon-button-selected")){b.sendCommand(b.Command.SetFieldDisplayMode,b.FieldDisplayMode.ShowFieldText);
}});
a("#tglBtnPreviewMergeResults").click(function(){if(a(this).hasClass("ribbon-button-selected")){b.sendCommand(b.Command.SetAppMode,b.ApplicationMode.Normal);
}else{b.sendCommand(b.Command.SetAppMode,b.ApplicationMode.MailMergePreview);
}});
a("#btnFirstRecord").click(function(){b.sendCommand(b.Command.MailMergePrevNav,b.MailMergeNavButton.First);
});
a("#btnPrevRecord").click(function(){b.sendCommand(b.Command.MailMergePrevNav,b.MailMergeNavButton.Previous);
});
a("#btnNextRecord").click(function(){b.sendCommand(b.Command.MailMergePrevNav,b.MailMergeNavButton.Next);
});
a("#btnLastRecord").click(function(){b.sendCommand(b.Command.MailMergePrevNav,b.MailMergeNavButton.Last);
});
var G=function(){b.sendCommand(b.Command.FinishAndMerge);
};
a("#btnFinishAndMerge").click(function(){if(b.documentDirty){b.fileSaveQuestion(G);
}else{G();
}});
a("#drpDnBtnSelectMasterTable").click(B);
a("#drpDnBtnInsertMergeField").click(x);
a("#drpDnBtnInsertSpecialField").click(z);
a("#drpDnBtnInsertMergeBlock").click(v);
};
function B(G){b.fileMenu.hide();
b.hideAllMenus_mailingsTab();
if(!p){return;
}p.show().position({my:"left top",at:"left bottom",of:G.currentTarget});
b.limitMenuHeight("selectMasterTableDropDown");
a(document).one("click",function(){p.hide();
});
return false;
}function x(H){b.fileMenu.hide();
b.hideAllMenus_mailingsTab();
b.sendCommand(b.Command.GetItem,b.ItemType.MergeBlock);
var G=document.getElementById("insertMergeFieldDropDown");
b.calcMenuWidths(G);
n.show().position({my:"left top",at:"left bottom",of:H.currentTarget});
a(document).on("click",function(I){if(!(b.isInsideElementWithID(I.target,"insertMergeFieldDropDown")&&b.isPartOfMenuItemWithSubMenu(I.target))){n.hide();
a(document).off(I);
}});
return false;
}function z(H){b.fileMenu.hide();
b.hideAllMenus_mailingsTab();
var G=document.getElementById("insertSpecialFieldDropDown");
b.calcMenuWidths(G);
o.show().position({my:"left top",at:"left bottom",of:H.currentTarget});
b.limitMenuHeight("insertSpecialFieldDropDown");
a(document).one("click",function(){o.hide();
});
return false;
}function A(H,I){var G;
switch(I.item.context.id){case"mnuItemInsertIFField":G=new b.IfFieldDialog();
break;
case"mnuItemInsertInclTxtField":G=new b.IncludeTextFieldDialog();
break;
case"mnuItemInsertDateField":G=new b.DateFieldDialog();
break;
case"mnuItemInsertNextField":b.sendCommand(b.Command.InsertItem,b.ItemType.FieldAdapter,b.FieldType.NextField);
break;
case"mnuItemInsertNextIfField":G=new b.NextIfFieldDialog();
break;
}if(G){G.showModal();
}}function v(H){b.fileMenu.hide();
b.hideAllMenus_mailingsTab();
if(!m){return;
}b.sendCommand(b.Command.GetItem,b.ItemType.MergeBlock);
var G=document.getElementById("insertMergeBlockDropDown");
b.calcMenuWidths(G);
m.show().position({my:"left top",at:"left bottom",of:H.currentTarget});
b.limitMenuHeight("insertMergeBlockDropDown");
a(document).one("click",function(){m.hide();
});
return false;
}function C(H,J){var G=J.item.context;
var I=j(G);
if(!I||(I.length==0)){return;
}b.selectMasterTable(I);
}function j(G){if(!G||!G.hasAttribute("data-table-name")){return"";
}return G.attributes["data-table-name"].value;
}function i(G){var K="";
if(!G||(!G.hasAttribute("data-column-name")&&!G.hasAttribute("data-child-table-name"))){return"";
}var H=G.parentElement;
while(H&&(H.nodeName.toLowerCase()!=="li")){H=H.parentElement;
}var I="";
if(G.hasAttribute("data-column-name")){I=G.attributes["data-column-name"].value;
}else{if(G.hasAttribute("data-child-table-name")){I=G.attributes["data-child-table-name"].value;
}}var J=i(H);
if(J.length){K=J+"."+I;
}else{K=I;
}return K;
}b.insertMergeField=function(H){var G={Name:H,Text:"«"+H+"»"};
b.sendCommand(b.Command.InsertItem,b.ItemType.FieldAdapter,b.FieldType.MergeField,0,G);
};
b.insertMergeBlock=function(G){G=JSON.stringify(G);
b.sendCommand(b.Command.InsertItem,b.ItemType.MergeBlock,0,0,G);
};
function y(J,M){var H=M.item.context;
if(H.querySelectorAll("ul").length){return;
}var L=i(H)||H.id;
if(!L||(L.length==0)){return;
}switch(L){case"mnuItemInsertMergeField":var K=new t();
var I=new b.MergeFieldDialog(K);
I.showModal();
break;
case"mnuItemHighlightMergeFields":var G=a("#tglBtnHighlightMergeFields");
if(G.hasClass("ribbon-button-selected")){b.sendCommand(b.Command.HighlightMergeFields,0);
}else{b.sendCommand(b.Command.HighlightMergeFields,1);
}break;
default:b.insertMergeField(L);
}}function w(I,K){var H=K.item.context;
var J=j(H)||H.id;
if(!J||(J.length==0)){return;
}switch(J){case"mnuItemInsertMergeBlock":b.insertMergeBlock();
break;
case"mnuItemHighlightMergeBlocks":var G=a("#tglBtnHighlightMergeBlocks");
if(G.hasClass("ribbon-button-selected")){b.sendCommand(b.Command.HighlightMergeBlocks,0);
}else{b.sendCommand(b.Command.HighlightMergeBlocks,1);
}break;
default:b.insertMergeBlock(J);
}}function e(G){var M=G.detail;
var J=a("#selectMasterTableDropDown");
var I=a("#insertMergeFieldDropDown");
var H=a("#insertMergeBlockDropDown");
J.empty();
b.clearInsertMergeBlockMenu();
b.dbScheme=null;
if(M.Tables.length==0){return;
}b.dbScheme=M;
var K=[];
K.push(document.getElementById("mnuItemInsertMergeBlock"));
K.push(document.getElementById("mnuItemHighlightMergeBlocks"));
K.forEach(function(N){H[0].removeChild(N);
});
var L=[];
L.push(document.getElementById("mnuItemInsertMergeField"));
L.push(document.getElementById("mnuItemHighlightMergeFields"));
L.forEach(function(N){I[0].removeChild(N);
});
I.empty();
H.empty();
b.dbScheme.Tables.forEach(function(N){d(I,b.dbScheme,N,true,false);
d(J,b.dbScheme,N,false,true);
d(H,b.dbScheme,N,false,false);
});
K.forEach(function(N){H[0].appendChild(N);
});
L.forEach(function(N){I[0].appendChild(N);
});
if(!p){p=J.menu().hide();
p.on("menuselect",C);
}else{J.menu("refresh");
}I.menu("refresh");
H.menu("refresh");
b.calcMenuWidths(J[0]);
if(!M.suppressMessage){b.showMsgDiv(b.variousMessages.databaseLoadedMessage.text,true);
}}function g(G){var H=G.detail.fieldDisplayMode;
switch(H){case b.FieldDisplayMode.ShowFieldText:a("#tglBtnShowFieldCodes").removeClass("ribbon-button-selected");
a("#tglBtnShowFieldText").addClass("ribbon-button-selected");
break;
case b.FieldDisplayMode.ShowFieldCodes:a("#tglBtnShowFieldCodes").addClass("ribbon-button-selected");
a("#tglBtnShowFieldText").removeClass("ribbon-button-selected");
break;
}}function f(G){b.currentFieldData.fieldAdapter=G.detail.field;
b.currentFieldData.mergeFieldType=G.detail.fieldType;
if(b.currentFieldData.fieldAdapter){a("#btnFieldProperties").removeClass("ui-state-disabled");
a("#btnDeleteField").removeClass("ui-state-disabled");
}else{a("#btnFieldProperties").addClass("ui-state-disabled");
a("#btnDeleteField").addClass("ui-state-disabled");
}}function q(I){var J=I.detail.tableName;
b.masterTableName=J;
var H=a("#selectMasterTableDropDown div.ribbon-button");
H.removeClass("ribbon-button-selected");
var G=a('#selectMasterTableDropDown li[data-table-name="'+J.toLowerCase()+'"] div.ribbon-button');
G.addClass("ribbon-button-selected");
}function u(G){var H=G.detail.highlight;
if(H){a("#tglBtnHighlightMergeFields").addClass("ribbon-button-selected");
}else{a("#tglBtnHighlightMergeFields").removeClass("ribbon-button-selected");
}}function r(G){var H=G.detail.highlight;
if(H){a("#tglBtnHighlightMergeBlocks").addClass("ribbon-button-selected");
}else{a("#tglBtnHighlightMergeBlocks").removeClass("ribbon-button-selected");
}}function F(G){var I=G.detail.itemType;
var H=G.detail.item;
switch(I){case b.ItemType.MergeBlock:s(H);
break;
}}function s(G){if(!b.dbScheme){return;
}D();
if(G==null){l(b.masterTableName);
}else{l(G.Name);
}}function l(O){var L;
O=O.toLowerCase();
var K=document.querySelector('#insertMergeFieldDropDown > li[data-table-name="'+O+'"] > a[role=menuitem]');
var G=document.querySelectorAll("#insertMergeBlockDropDown > li[data-table-name] > a[role=menuitem]");
if(K){K.classList.add("merge-highlight");
}var N=b.dbScheme.Tables.find(function(P){return P.TableName.toLowerCase()===O;
});
if(!N){return;
}var M=N.ChildRelations;
if(!M.length){return;
}for(L=0;
L<G.length;
++L){var I=G[L];
var J=I.parentElement;
var H=J.attributes["data-table-name"].value;
if(M.contains(function(P){return(P.ChildTableName.toLowerCase()===H);
})){I.classList.add("merge-highlight");
}}}function D(){var H=document.querySelectorAll("#insertMergeFieldDropDown > li > a[role=menuitem].merge-highlight");
var G=document.querySelectorAll("#insertMergeBlockDropDown > li > a[role=menuitem].merge-highlight");
for(var I=0;
I<H.length;
++I){H[I].classList.remove("merge-highlight");
}for(I=0;
I<G.length;
++I){G[I].classList.remove("merge-highlight");
}}function d(N,H,R,G,Q){var M=document.createElement("li");
N.append(M);
M.setAttribute("data-table-name",R.TableName.toLowerCase());
var I=document.createElement("a");
M.appendChild(I);
I.setAttribute("href","#");
var K=document.createElement("div");
I.appendChild(K);
K.classList.add("large-menu-item-image-container");
if(Q){K.classList.add("ribbon-button");
}var L=document.createElement("img");
K.appendChild(L);
L.setAttribute("src",b.imageResources.large.table);
var J=document.createElement("div");
I.appendChild(J);
J.classList.add("large-menu-item-caption-container");
var O=document.createElement("p");
J.appendChild(O);
O.textContent=R.TableName;
if(G){var P=document.createElement("ul");
M.appendChild(P);
P.classList.add("dropDownMenu");
c(P,H,R);
}}function c(H,G,I){I.Columns.forEach(function(J){var L=document.createElement("li");
H.appendChild(L);
L.setAttribute("data-column-name",J.ColumnName);
var K=document.createElement("a");
L.appendChild(K);
K.textContent=J.ColumnName;
});
I.ChildRelations.forEach(function(N){var L=document.createElement("li");
H.appendChild(L);
L.setAttribute("data-child-table-name",N.ChildTableName.toLowerCase());
var K=document.createElement("a");
L.appendChild(K);
K.textContent=N.ChildTableName;
var M=document.createElement("ul");
L.appendChild(M);
M.classList.add("dropDownMenu");
var J=G.Tables.find(function(O){return(O.TableName.toLowerCase()===N.ChildTableName.toLowerCase());
});
c(M,G,J);
});
}b.calcMenuWidths=function(I){var M=[];
for(var J=0;
J<I.children.length;
++J){var H=I.children[J];
if(H.tagName==="LI"){for(var K=0;
K<H.children.length;
++K){var G=H.children[K];
if(G.tagName==="UL"){M.push(G);
}}}}for(J=0;
J<M.length;
++J){var L=M[J];
b.calcMenuWidths(L);
}I.style.width=h(I)+"px";
};
function k(G){return(G.style.overflowY==="auto")||(G.style.overflowY==="scroll");
}function h(J){var S=0;
var U;
var G=k(J)?27:10;
for(var O=0;
O<J.children.length;
++O){var M=J.children[O];
if(!M.children.length){continue;
}var K=M.children[0];
if(K.nodeName!=="A"){continue;
}var I=getComputedStyle(K);
var H=K.cloneNode(true);
H.style.fontFamily=I.fontFamily;
H.style.fontSize=I.fontSize;
var T=document.createElement("TABLE");
T.style.position="fixed";
T.style.left="-9999px";
T.style.whiteSpace="nowrap";
T.style.borderCollapse="collapse";
T.style.fontSize=I.fontSize;
T.style.fontFamily=I.fontFamily;
var V=document.createElement("TR");
T.appendChild(V);
for(var P=0;
P<H.childNodes.length;
++P){var R=H.childNodes[P].cloneNode(true);
switch(R.nodeType){case Node.ELEMENT_NODE:if((R.tagName==="DIV")&&(R.classList.contains("menu-item-category-header"))){break;
}U=document.createElement("TD");
var N=R.querySelectorAll("h1");
for(var Q=0;
Q<N.length;
++Q){N[Q].style.fontSize=I.fontSize;
N[Q].style.fontWeight="bold";
}U.appendChild(R);
V.appendChild(U);
break;
case Node.TEXT_NODE:U=document.createElement("TD");
U.textContent=R.data;
V.appendChild(U);
break;
}}var L=document.getElementById("txTemplateDesignerContainer");
L.appendChild(T);
var W=T.clientWidth+G;
S=Math.max(S,W);
L.removeChild(T);
}return S;
}b.hideAllMenus_mailingsTab=function(){if(n){n.hide();
}if(p){p.hide();
}if(m){m.hide();
}o.hide();
};
return E;
}(TXTextControl||{},j$1_10_2));
var TXTextControl=(function(f,a){var b=f._private=f._private||{};
var c;
b.SpecialZoomFactor={PageWidth:-1,PageHeight:-2};
b.attachViewTabEventHandlers=function(){c=a("#zoomDropDown").menu().hide();
c.on("menuselect",e);
a("#drpDnBtnZoom").click(d);
a("#btnZoom100").click(function(){b.sendCommand(b.Command.Zoom,100);
});
a("#btnZoomPageWidth").click(function(){b.sendCommand(b.Command.Zoom,b.SpecialZoomFactor.PageWidth);
});
a("#btnZoomPageHeight").click(function(){b.sendCommand(b.Command.Zoom,b.SpecialZoomFactor.PageHeight);
});
a("#chkRulerVert").change(function(){b.showVerticalRuler(a(this).is(":checked"));
});
a("#chkRulerHor").change(function(){b.showHorizontalRuler(a(this).is(":checked"));
});
a("#chkStatusBar").change(function(){b.showStatusBar(a(this).is(":checked"));
});
a("#btnSpelling").click(function(){b.sendCommand(b.Command.ShowDialog,b.DialogCategory.HTMLDialog,b.HTMLDialogType.SpellCheckDialog);
});
a("#tglBtnEnableSpellCheck").click(function(){if(a(this).hasClass("ribbon-button-selected")){b.sendCommand(b.Command.EnableSpellChecking,0);
}else{b.sendCommand(b.Command.EnableSpellChecking,1);
}});
a("#tglBtnEnableLangDetect").click(function(){if(a(this).hasClass("ribbon-button-selected")){b.sendCommand(b.Command.EnableLangDetect,0);
}else{b.sendCommand(b.Command.EnableLangDetect,1);
}});
a("#btnLoadDictionary").click(function(){b.sendCommand(b.Command.ShowDialog,b.DialogCategory.HTMLDialog,b.HTMLDialogType.LoadDictionaryDialog);
});
a("#tglBtnEnableHyphenation").click(function(){if(a(this).hasClass("ribbon-button-selected")){b.sendCommand(b.Command.EnableHyphenation,0);
}else{b.sendCommand(b.Command.EnableHyphenation,1);
}});
a("#btnSetLanguage").click(function(){b.sendCommand(b.Command.ShowDialog,b.DialogCategory.TXDialog,b.TXDialogType.LanguageDialog);
});
};
function d(h){b.fileMenu.hide();
b.hideAllMenus_viewTab();
var g=document.getElementById("zoomDropDown");
b.calcMenuWidths(g);
c.show().position({my:"left top",at:"left bottom",of:h.currentTarget});
a(document).one("click",function(){c.hide();
});
return false;
}function e(g,h){switch(h.item.context.id){case"mnuItemZoom_25":b.sendCommand(b.Command.Zoom,25);
break;
case"mnuItemZoom_50":b.sendCommand(b.Command.Zoom,50);
break;
case"mnuItemZoom_75":b.sendCommand(b.Command.Zoom,75);
break;
case"mnuItemZoom_100":b.sendCommand(b.Command.Zoom,100);
break;
case"mnuItemZoom_150":b.sendCommand(b.Command.Zoom,150);
break;
case"mnuItemZoom_200":b.sendCommand(b.Command.Zoom,200);
break;
case"mnuItemZoom_400":b.sendCommand(b.Command.Zoom,400);
break;
}}b.hideAllMenus_viewTab=function(){c.hide();
};
return f;
}(TXTextControl||{},j$1_10_2));
var TXTextControl=(function(q,a){var b=q._private=q._private||{};
var e,d,f;
b.TableCommand={SelectElement:0,DeleteElement:1,InsertElement:2,CellAlignment:3,MergeCells:4,SplitCells:5,SplitTable:6};
b.TableElement={Cell:0,Column:1,Row:2,WholeTable:3,};
b.attachTableLayoutTabEventHandlers=function(){e=a("#tableSelectDropDown").menu().hide();
d=a("#tableDeleteDropDown").menu().hide();
f=a("#tableSplitDropDown").menu().hide();
e.on("menuselect",l);
d.on("menuselect",g);
f.on("menuselect",m);
a("#drpDnBtnTableSelect").click(j);
a("#drpDnBtnTableDelete").click(i);
a("#drpDnBtnSplitTable").click(h);
a("#tglBtnViewGridLines").click(function(){if(a(this).hasClass("ribbon-button-selected")){b.sendCommand(b.Command.DisplayVisualElement,b.VisualElement.TableGridLines,0);
a(this).removeClass("ribbon-button-selected");
}else{b.sendCommand(b.Command.DisplayVisualElement,b.VisualElement.TableGridLines,1);
a(this).addClass("ribbon-button-selected");
}});
a("#btnTableProperties").click(function(){b.sendCommand(b.Command.ShowDialog,b.DialogCategory.TXDialog,b.TXDialogType.TableFormatDialog);
});
a("#ribbonGroupTblLayoutAlignment div.ribbon-button-tiny").click(n);
a("#ribbonGroupTblLayoutRowsCols div.ribbon-button-big").click(o);
a("#ribbonGroupTblLayoutMerge div.ribbon-button-big").click(k);
};
function j(s){b.fileMenu.hide();
b.hideAllMenus_tableLayoutTab();
if(!e){return;
}var r=document.getElementById("tableSelectDropDown");
b.calcMenuWidths(r);
e.show().position({my:"left top",at:"left bottom",of:s.currentTarget});
a(document).one("click",function(){e.hide();
});
return false;
}function l(r,t){var s=t.item.context.id;
switch(s){case"mnuItemSelectTableCell":b.sendCommand(b.Command.TableCommand,b.TableCommand.SelectElement,b.TableElement.Cell);
break;
case"mnuItemSelectTableColumn":b.sendCommand(b.Command.TableCommand,b.TableCommand.SelectElement,b.TableElement.Column);
break;
case"mnuItemSelectTableRow":b.sendCommand(b.Command.TableCommand,b.TableCommand.SelectElement,b.TableElement.Row);
break;
case"mnuItemSelectTable":b.sendCommand(b.Command.TableCommand,b.TableCommand.SelectElement,b.TableElement.WholeTable);
break;
}}function i(s){b.fileMenu.hide();
b.hideAllMenus_tableLayoutTab();
if(!d){return;
}var r=document.getElementById("tableDeleteDropDown");
b.calcMenuWidths(r);
d.show().position({my:"left top",at:"left bottom",of:s.currentTarget});
a(document).on("click",function(t){if(!(b.isInsideElementWithID(t.target,"tableDeleteDropDown")&&b.isPartOfMenuItemWithSubMenu(t.target))){d.hide();
a(document).off(t);
}});
return false;
}function g(r,t){var s=t.item.context.id;
switch(s){case"mnuItemMoveCellsToLeft":b.sendCommand(b.Command.TableCommand,b.TableCommand.DeleteElement,b.TableElement.Cell);
break;
case"mnuItemDeleteWholeColumn":case"mnuItemDeleteTableColumns":b.sendCommand(b.Command.TableCommand,b.TableCommand.DeleteElement,b.TableElement.Column);
break;
case"mnuItemDeleteWholeRow":case"mnuItemDeleteTableRows":b.sendCommand(b.Command.TableCommand,b.TableCommand.DeleteElement,b.TableElement.Row);
break;
case"mnuItemDeleteTable":b.sendCommand(b.Command.TableCommand,b.TableCommand.DeleteElement,b.TableElement.WholeTable);
break;
}}function h(s){b.fileMenu.hide();
b.hideAllMenus_tableLayoutTab();
if(!f){return;
}var r=document.getElementById("tableSplitDropDown");
b.calcMenuWidths(r);
f.show().position({my:"left top",at:"left bottom",of:s.currentTarget});
a(document).one("click",function(){f.hide();
});
return false;
}function m(r,t){var s=t.item.context.id;
switch(s){case"mnuItemTableSplitAbove":b.sendCommand(b.Command.TableCommand,b.TableCommand.SplitTable,b.TableAddPosition.Before);
break;
case"mnuItemTableSplitBelow":b.sendCommand(b.Command.TableCommand,b.TableCommand.SplitTable,b.TableAddPosition.After);
break;
}}function n(r){var s=r.currentTarget.id;
switch(s){case"tglBtnCellAlignTopLeft":b.sendCommand(b.Command.TableCommand,b.TableCommand.CellAlignment,b.VerticalAlignment.Top,b.HorizontalAlignment.Left);
break;
case"tglBtnCellAlignTopCenter":b.sendCommand(b.Command.TableCommand,b.TableCommand.CellAlignment,b.VerticalAlignment.Top,b.HorizontalAlignment.Center);
break;
case"tglBtnCellAlignTopRight":b.sendCommand(b.Command.TableCommand,b.TableCommand.CellAlignment,b.VerticalAlignment.Top,b.HorizontalAlignment.Right);
break;
case"tglBtnCellAlignTopJustify":b.sendCommand(b.Command.TableCommand,b.TableCommand.CellAlignment,b.VerticalAlignment.Top,b.HorizontalAlignment.Justify);
break;
case"tglBtnCellAlignMiddleLeft":b.sendCommand(b.Command.TableCommand,b.TableCommand.CellAlignment,b.VerticalAlignment.Center,b.HorizontalAlignment.Left);
break;
case"tglBtnCellAlignMiddleCenter":b.sendCommand(b.Command.TableCommand,b.TableCommand.CellAlignment,b.VerticalAlignment.Center,b.HorizontalAlignment.Center);
break;
case"tglBtnCellAlignMiddleRight":b.sendCommand(b.Command.TableCommand,b.TableCommand.CellAlignment,b.VerticalAlignment.Center,b.HorizontalAlignment.Right);
break;
case"tglBtnCellAlignMiddleJustify":b.sendCommand(b.Command.TableCommand,b.TableCommand.CellAlignment,b.VerticalAlignment.Center,b.HorizontalAlignment.Justify);
break;
case"tglBtnCellAlignBottomLeft":b.sendCommand(b.Command.TableCommand,b.TableCommand.CellAlignment,b.VerticalAlignment.Bottom,b.HorizontalAlignment.Left);
break;
case"tglBtnCellAlignBottomCenter":b.sendCommand(b.Command.TableCommand,b.TableCommand.CellAlignment,b.VerticalAlignment.Bottom,b.HorizontalAlignment.Center);
break;
case"tglBtnCellAlignBottomRight":b.sendCommand(b.Command.TableCommand,b.TableCommand.CellAlignment,b.VerticalAlignment.Bottom,b.HorizontalAlignment.Right);
break;
case"tglBtnCellAlignBottomJustify":b.sendCommand(b.Command.TableCommand,b.TableCommand.CellAlignment,b.VerticalAlignment.Bottom,b.HorizontalAlignment.Justify);
break;
}}function o(r){var s=r.currentTarget.id;
switch(s){case"btnInsTblRowAbove":b.sendCommand(b.Command.TableCommand,b.TableCommand.InsertElement,b.TableElement.Row,b.TableAddPosition.Before);
break;
case"btnInsTblRowBelow":b.sendCommand(b.Command.TableCommand,b.TableCommand.InsertElement,b.TableElement.Row,b.TableAddPosition.After);
break;
case"btnInsTblColLeft":b.sendCommand(b.Command.TableCommand,b.TableCommand.InsertElement,b.TableElement.Column,b.TableAddPosition.Before);
break;
case"btnInsTblColRight":b.sendCommand(b.Command.TableCommand,b.TableCommand.InsertElement,b.TableElement.Column,b.TableAddPosition.After);
break;
}}function k(r){var s=r.currentTarget.id;
switch(s){case"btnMergeCells":b.sendCommand(b.Command.TableCommand,b.TableCommand.MergeCells);
break;
case"btnSplitCells":b.sendCommand(b.Command.TableCommand,b.TableCommand.SplitCells);
break;
}}b.processTableInfo=function(r){if(r.CanSplitCells){a("#btnSplitCells").removeClass("ui-state-disabled");
}else{a("#btnSplitCells").addClass("ui-state-disabled");
}if(r.CanMergeCells){a("#btnMergeCells").removeClass("ui-state-disabled");
}else{a("#btnMergeCells").addClass("ui-state-disabled");
}if(r.CanSplit){a("#drpDnBtnSplitTable").removeClass("ui-state-disabled");
}else{a("#drpDnBtnSplitTable").addClass("ui-state-disabled");
}if(r.RowsCanAdd){a("#btnInsTblRowAbove").removeClass("ui-state-disabled");
a("#btnInsTblRowBelow").removeClass("ui-state-disabled");
}else{a("#btnInsTblRowAbove").addClass("ui-state-disabled");
a("#btnInsTblRowBelow").addClass("ui-state-disabled");
}if(r.ColsCanAdd){a("#btnInsTblColLeft").removeClass("ui-state-disabled");
a("#btnInsTblColRight").removeClass("ui-state-disabled");
}else{a("#btnInsTblColLeft").addClass("ui-state-disabled");
a("#btnInsTblColRight").addClass("ui-state-disabled");
}if(r.RowsCanRemove){a("#mnuItemDeleteTableRows").removeClass("ui-state-disabled");
}else{a("#mnuItemDeleteTableRows").addClass("ui-state-disabled");
}if(r.ColsCanRemove){a("#mnuItemDeleteTableColumns").removeClass("ui-state-disabled");
}else{a("#mnuItemDeleteTableColumns").addClass("ui-state-disabled");
}c(r.Cell!=undefined);
if(r.Cell){p(r.Cell);
}};
function c(r){if(r){a("#ribbonGroupTblLayoutAlignment div.ribbon-button-tiny").removeClass("ui-state-disabled");
}else{a("#ribbonGroupTblLayoutAlignment div.ribbon-button-tiny").addClass("ui-state-disabled");
}}function p(r){a("#ribbonGroupTblLayoutAlignment div.ribbon-button-tiny").removeClass("ribbon-button-selected");
switch(r.VerticalAlignment){case b.VerticalAlignment.Top:switch(r.HorizontalAlignment){case b.HorizontalAlignment.Left:a("#tglBtnCellAlignTopLeft").addClass("ribbon-button-selected");
break;
case b.HorizontalAlignment.Center:a("#tglBtnCellAlignTopCenter").addClass("ribbon-button-selected");
break;
case b.HorizontalAlignment.Right:a("#tglBtnCellAlignTopRight").addClass("ribbon-button-selected");
break;
case b.HorizontalAlignment.Justify:a("#tglBtnCellAlignTopJustify").addClass("ribbon-button-selected");
break;
}break;
case b.VerticalAlignment.Center:switch(r.HorizontalAlignment){case b.HorizontalAlignment.Left:a("#tglBtnCellAlignMiddleLeft").addClass("ribbon-button-selected");
break;
case b.HorizontalAlignment.Center:a("#tglBtnCellAlignMiddleCenter").addClass("ribbon-button-selected");
break;
case b.HorizontalAlignment.Right:a("#tglBtnCellAlignMiddleRight").addClass("ribbon-button-selected");
break;
case b.HorizontalAlignment.Justify:a("#tglBtnCellAlignMiddleJustify").addClass("ribbon-button-selected");
break;
}break;
case b.VerticalAlignment.Bottom:switch(r.HorizontalAlignment){case b.HorizontalAlignment.Left:a("#tglBtnCellAlignBottomLeft").addClass("ribbon-button-selected");
break;
case b.HorizontalAlignment.Center:a("#tglBtnCellAlignBottomCenter").addClass("ribbon-button-selected");
break;
case b.HorizontalAlignment.Right:a("#tglBtnCellAlignBottomRight").addClass("ribbon-button-selected");
break;
case b.HorizontalAlignment.Justify:a("#tglBtnCellAlignBottomJustify").addClass("ribbon-button-selected");
break;
}break;
}}b.hideAllMenus_tableLayoutTab=function(){e.hide();
d.hide();
f.hide();
};
return q;
}(TXTextControl||{},j$1_10_2));
var TXTextControl=(function(r,a){var b=r._private=r._private||{};
var d,e,f,c,g;
b.FrameInsertionMode={AsCharacter:1,DisplaceCompleteLines:4,DisplaceText:8,MoveWithText:65536,FixedOnPage:131072,BelowTheText:262146,AboveTheText:524290};
b.FrameProperty={InsertionMode:0,Name:1,ID:2,HorizontalAlignment:3,ZOrder:4};
b.ZOrder={BottomMost:-2147483648,Bottom:-2147483647,Down:-2147483646,Up:2147483645,Top:2147483646,TopMost:2147483647};
b.attachObjectFormatTabEventHandlers=function(){d=a("#objectPropertiesDropDown").menu().hide();
e=a("#objPosDropDown").menu().hide();
f=a("#objSendToBackDropDown").menu().hide();
c=a("#objBringToFrontDropDown").menu().hide();
g=a("#objWrapTextDropDown").menu().hide();
d.on("menuselect",n);
e.on("menuselect",o);
f.on("menuselect",p);
c.on("menuselect",m);
g.on("menuselect",q);
a("#drpDnBtnObjectProperties").click(j);
a("#drpDnBtnObjectPosition").click(i);
a("#drpDnBtnSendToBack").click(k);
a("#drpDnBtnBringToFront").click(h);
a("#drpDnBtnWrapText").click(l);
};
b.processFrameInfo=function(u){var s;
var t=a("#objWrapTextDropDown div.ribbon-button");
t.removeClass("ribbon-button-selected");
switch(u.InsertionMode){case b.FrameInsertionMode.AsCharacter:s=a("#mnuItemObjInLineWithText div.ribbon-button");
break;
case b.FrameInsertionMode.AboveTheText:s=a("#mnuItemObjInFrontOfText div.ribbon-button");
break;
case b.FrameInsertionMode.DisplaceCompleteLines:s=a("#mnuItemObjTopAndBottom div.ribbon-button");
break;
case b.FrameInsertionMode.DisplaceText:s=a("#mnuItemObjSquare div.ribbon-button");
break;
case b.FrameInsertionMode.BelowTheText:s=a("#mnuItemObjBehindText div.ribbon-button");
break;
}if(s){s.addClass("ribbon-button-selected");
}};
function j(t){b.fileMenu.hide();
b.hideAllMenus_ObjectFormatTab();
if(!d){return;
}var s=document.getElementById("objectPropertiesDropDown");
b.calcMenuWidths(s);
d.show().position({my:"left top",at:"left bottom",of:t.currentTarget});
a(document).one("click",function(){d.hide();
});
return false;
}function n(s,u){var t=u.item.context.id;
switch(t){case"mnuItemObjAttrs":b.sendCommand(b.Command.ShowDialog,b.DialogCategory.TXDialog,b.TXDialogType.ObjectAttributesDialog);
break;
case"mnuItemObjName":b.sendCommand(b.Command.SetItemProperty,b.ItemType.Frame,b.FrameProperty.Name);
break;
case"mnuItemObjID":b.sendCommand(b.Command.SetItemProperty,b.ItemType.Frame,b.FrameProperty.ID);
break;
}}function i(t){b.fileMenu.hide();
b.hideAllMenus_ObjectFormatTab();
if(!e){return;
}var s=document.getElementById("objPosDropDown");
b.calcMenuWidths(s);
e.show().position({my:"left top",at:"left bottom",of:t.currentTarget});
a(document).one("click",function(){e.hide();
});
return false;
}function o(s,u){var t=u.item.context.id;
switch(t){case"mnnuItemObjPosLeft":b.sendCommand(b.Command.SetItemProperty,b.ItemType.Frame,b.FrameProperty.HorizontalAlignment,b.HorizontalAlignment.Left);
break;
case"mnuItemObjPosCenter":b.sendCommand(b.Command.SetItemProperty,b.ItemType.Frame,b.FrameProperty.HorizontalAlignment,b.HorizontalAlignment.Center);
break;
case"mnuItemObjPosRight":b.sendCommand(b.Command.SetItemProperty,b.ItemType.Frame,b.FrameProperty.HorizontalAlignment,b.HorizontalAlignment.Right);
break;
}}function k(t){b.fileMenu.hide();
b.hideAllMenus_ObjectFormatTab();
if(!f){return;
}var s=document.getElementById("objSendToBackDropDown");
b.calcMenuWidths(s);
f.show().position({my:"left top",at:"left bottom",of:t.currentTarget});
a(document).one("click",function(){f.hide();
});
return false;
}function p(s,u){var t=u.item.context.id;
switch(t){case"mnuItemObjSendToBack":b.sendCommand(b.Command.SetItemProperty,b.ItemType.Frame,b.FrameProperty.ZOrder,b.ZOrder.Bottom);
break;
case"mnuItemObjSendBackward":b.sendCommand(b.Command.SetItemProperty,b.ItemType.Frame,b.FrameProperty.ZOrder,b.ZOrder.Down);
break;
case"mnuItemObjSendBehindText":b.sendCommand(b.Command.SetItemProperty,b.ItemType.Frame,b.FrameProperty.InsertionMode,b.FrameInsertionMode.BelowTheText);
break;
}}function h(t){b.fileMenu.hide();
b.hideAllMenus_ObjectFormatTab();
if(!c){return;
}var s=document.getElementById("objBringToFrontDropDown");
b.calcMenuWidths(s);
c.show().position({my:"left top",at:"left bottom",of:t.currentTarget});
a(document).one("click",function(){c.hide();
});
return false;
}function m(s,u){var t=u.item.context.id;
switch(t){case"mnuItemObjBringToFront":b.sendCommand(b.Command.SetItemProperty,b.ItemType.Frame,b.FrameProperty.ZOrder,b.ZOrder.Top);
break;
case"mnuItemObjBringForward":b.sendCommand(b.Command.SetItemProperty,b.ItemType.Frame,b.FrameProperty.ZOrder,b.ZOrder.Up);
break;
case"mnuItemObjBringInFrontOfText":b.sendCommand(b.Command.SetItemProperty,b.ItemType.Frame,b.FrameProperty.InsertionMode,b.FrameInsertionMode.AboveTheText);
break;
}}function l(t){b.fileMenu.hide();
b.hideAllMenus_ObjectFormatTab();
if(!g){return;
}var s=document.getElementById("objWrapTextDropDown");
b.calcMenuWidths(s);
g.show().position({my:"left top",at:"left bottom",of:t.currentTarget});
a(document).one("click",function(){g.hide();
});
return false;
}function q(s,v){var t=v.item.context.id;
var u;
switch(t){case"mnuItemObjInLineWithText":u=b.FrameInsertionMode.AsCharacter;
break;
case"mnuItemObjTopAndBottom":u=b.FrameInsertionMode.DisplaceCompleteLines;
break;
case"mnuItemObjSquare":u=b.FrameInsertionMode.DisplaceText;
break;
case"mnuItemObjBehindText":u=b.FrameInsertionMode.BelowTheText;
break;
case"mnuItemObjInFrontOfText":u=b.FrameInsertionMode.AboveTheText;
break;
}if(u){b.sendCommand(b.Command.SetItemProperty,b.ItemType.Frame,b.FrameProperty.InsertionMode,u);
}}b.hideAllMenus_ObjectFormatTab=function(){d.hide();
e.hide();
f.hide();
c.hide();
g.hide();
};
return r;
}(TXTextControl||{},j$1_10_2));
var TXTextControl=(function(w,a){var b=w._private=w._private||{};
var j,h,i;
b.ShapeProperty={Style:0,FillColor:1,OutlineColor:2,OutlineWeight:3};
b.attachShapeFormatTabEventHandlers=function(){f();
j=a("#shapeStylesDropDown").menu().hide();
h=a("#shapeFillDropDown").menu().hide();
i=a("#shapeOutlineDropDown").menu().hide();
j.on("menuselect",r);
h.on("menuselect",p);
i.on("menuselect",q);
a("#drpDnBtnShapeStyles").click(o);
a("#drpDnBtnShapeFill").click(m);
a("#drpDnBtnShapeOutline").click(n);
};
function o(x){b.fileMenu.hide();
b.hideAllMenus_ShapeFormatTab();
if(!j){return;
}j.show().position({my:"left top",at:"left bottom",of:x.currentTarget});
a(document).one("click",function(){j.hide();
});
return false;
}function r(x,A){var y=A.item.context;
if(y.hasOwnProperty("txShapeStyle")){var z=y.txShapeStyle;
b.sendCommand(b.Command.SetItemProperty,b.ItemType.Shape,b.ShapeProperty.Style,0,z);
}}function m(x){b.fileMenu.hide();
b.hideAllMenus_ShapeFormatTab();
if(!h){return;
}var y=document.getElementById("shapeFillDropDown");
b.calcMenuWidths(y);
h.show().position({my:"left top",at:"left bottom",of:x.currentTarget});
a(document).one("click",function(){h.hide();
});
return false;
}function p(y,A){var z=A.item.context;
if(z.hasOwnProperty("txShapeColor")){var x=z.txShapeColor;
b.sendCommand(b.Command.SetItemProperty,b.ItemType.Shape,b.ShapeProperty.FillColor,0,x);
}else{switch(z.id){case"mnuItmShapeFillNone":b.sendCommand(b.Command.SetItemProperty,b.ItemType.Shape,b.ShapeProperty.FillColor,0,u(0));
break;
}}}function n(x){b.fileMenu.hide();
b.hideAllMenus_ShapeFormatTab();
if(!i){return;
}var y=document.getElementById("shapeOutlineDropDown");
b.calcMenuWidths(y);
i.show().position({my:"left top",at:"left bottom",of:x.currentTarget});
a(document).on("click",function(z){if(!(b.isInsideElementWithID(z.target,"shapeOutlineDropDown")&&b.isPartOfMenuItemWithSubMenu(z.target))){i.hide();
a(document).off(z);
}});
return false;
}function q(y,A){var z=A.item.context;
if(z.hasOwnProperty("txShapeColor")){var x=z.txShapeColor;
b.sendCommand(b.Command.SetItemProperty,b.ItemType.Shape,b.ShapeProperty.OutlineColor,0,x);
}else{var B=null;
switch(z.id){case"mnuItmShapeOutlNone":b.sendCommand(b.Command.SetItemProperty,b.ItemType.Shape,b.ShapeProperty.OutlineColor,0,u(0));
break;
case"mnuItmShapeOutlWeight025":B=0.25;
break;
case"mnuItmShapeOutlWeight050":B=0.5;
break;
case"mnuItmShapeOutlWeight075":B=0.75;
break;
case"mnuItmShapeOutlWeight100":B=1;
break;
case"mnuItmShapeOutlWeight150":B=1.5;
break;
case"mnuItmShapeOutlWeight225":B=2.25;
break;
case"mnuItmShapeOutlWeight300":B=3;
break;
case"mnuItmShapeOutlWeight450":B=4.5;
break;
case"mnuItmShapeOutlWeight600":B=6;
break;
}if(B){b.sendCommand(b.Command.SetItemProperty,b.ItemType.Shape,b.ShapeProperty.OutlineWeight,0,B);
}}}function f(){g();
e();
}var s=[4278190080,4288230144,4281545472,4278203136,4278203238,4278190208,4281545625,4281545523,4286578688,4294927872,4286611456,4278222848,4278222976,4278190335,4284901017,4286611584,4294901760,4294940928,4288269312,4281571686,4281584844,4281558783,4286578816,4288256409,4294902015,4294953984,4294967040,4278255360,4278255615,4278242559,4288230246,4290822336,4294941132,4294954137,4294967193,4291624908,4291624959,4288269567,4291598847,4294967295];
var t=[4278190080,4283400637,4290793549,4288396121,4286604450,4283149510,4294415942,4278190080,4281884042,4287379510,4285630783,4284237686,4281695633,4290145585];
function v(z){var x=u(z),y="rgba("+x.r+", "+x.g+", "+x.b+", "+(x.a/255)+")";
return y;
}function u(y){var x={a:(y>>>24),r:(y>>>16)&255,g:(y>>>8)&255,b:(y>>>0)&255};
return x;
}function g(){var z,y,x;
y=x=0;
for(var A=0;
A<7;
++A){z=t[A];
c(z,y,x,(A==0));
}for(A=0;
A<7;
++A){z=t[A+7];
y=t[A];
c(z,y,x,(A==0));
}z=4294967295;
x=402653184;
for(A=0;
A<7;
++A){y=t[A];
c(z,y,x,(A==0));
}}function c(A,z,y,x){var F=document.getElementById("shapeStylesDropDown");
var D=document.createElement("li");
if(x){D.style.clear="left";
}D.txShapeStyle={strokeColor:u(A),fillColor:u(z),};
var B=document.createElement("a");
B.setAttribute("href","#!");
var C=document.createElement("img");
var E=k(A,z,y,48,48);
C.src=E;
C.alt="Shape Style Button";
B.appendChild(C);
D.appendChild(B);
F.appendChild(D);
}function k(A,z,y,D,C){A=v(A);
z=v(z);
y=v(y);
var x=document.createElement("canvas");
x.width=D;
x.height=C;
var B=x.getContext("2d");
B.beginPath();
B.rect(0,0,D,C);
B.fillStyle=y;
B.fill();
B.closePath();
B.beginPath();
B.rect(3,3,30,30);
B.fillStyle=z;
B.fill();
B.lineWidth=2;
B.strokeStyle=A;
B.stroke();
B.closePath();
B.beginPath();
B.arc(29,29,17,0,2*Math.PI,false);
B.fillStyle=z;
B.fill();
B.lineWidth=2;
B.strokeStyle=A;
B.stroke();
B.closePath();
return x.toDataURL();
}function d(C){var x=[];
C.style.minWidth="180px";
for(var B=0;
B<5;
++B){for(var A=0;
A<8;
++A){var D=(8*B)+A;
var y=s[D];
x.push(l(C,y,(A==0)));
}}for(var A=(x.length-1);
A>=0;
--A){var z=x[A];
C.insertBefore(z,C.firstChild);
}}function e(){var x=document.getElementById("shapeFillDropDown");
d(x);
x=document.getElementById("shapeOutlineDropDown");
d(x);
}function l(C,y,x){var B=document.createElement("li");
var A=document.createElement("div");
B.style.position="relative";
B.style.width="16px";
B.style.height="16px";
B.style.cssFloat="left";
B.style.clear=x?"left":"none";
B.style.padding="2px";
B.style.marginLeft=x?"3px":"2px";
B.style.display="block";
B.style.overflow="hidden";
var z=document.createElement("a");
z.href="#!";
A.style.position="relative";
A.style.width="14px";
A.style.height="14px";
A.style.border="1px solid lightgray";
A.style.overflow="hidden";
A.style.background=A.style.color=v(y);
A.textContent=".";
z.appendChild(A);
B.appendChild(z);
B.txShapeColor=u(y);
return B;
}b.hideAllMenus_ShapeFormatTab=function(){j.hide();
h.hide();
i.hide();
};
return w;
}(TXTextControl||{},j$1_10_2));
var TXTextControl=(function(aH,a){var b=aH._private=aH._private||{};
aH.version="23.0";
function au(){delete aH._private;
}b.isSSLConnection=(window.location.protocol==="https:");
var y=59;
b.Command=Object.freeze({Close:4,Undo:5,NewFile:6,Cut:10,Copy:11,Paste:12,Redo:13,GetFileList:14,OpenFile:15,GrowFont:17,ShrinkFont:18,SetLandscape:19,PrintToPDF:22,IncreaseIndent:23,DecreaseIndent:24,InputFormat:28,WindowResized:34,HScroll:35,VScroll:36,ScrollDelta:37,InsertBlankPage:38,InsertBreak:39,PageColumns:43,Zoom:45,ImageLoaded:52,ClientPaste:53,GetDocumentTargets:54,InsertItem:55,GetItem:56,DeleteItem:57,EnableSpellChecking:58,EnableHyphenation:59,InsertDocumentFile:60,GetDialogResources:61,SetAppMode:62,MailMergePrevNav:63,FinishAndMerge:64,ShowDialog:65,DialogResult:66,SelectMasterTable:70,SetFieldDisplayMode:71,HighlightMergeFields:72,ComponentEvent:77,CloseDialog:79,EditDataRelations:82,EditMergeBlocks:84,GoToItem:85,DisplayVisualElement:86,TableCommand:87,ContextMenuItemClicked:89,SetItemProperty:92,SaveDocumentFile:94,Ping:95,SetGUID:103,EnableLangDetect:105,Save:108,ComponentActivationState:109,SpellCheckCommand:117,OpenDirectory:119,IsTouchDevice:126,ServerConsoleWriteLine:127,CreateTextControl:130,SelectAll:132,TXSettingsMVC:133,ResetContents:135,HighlightMergeBlocks:136,ClientSelection:137,EnableLoadWaitDialog:138});
var d={FontList:2,FileList:4,StyleList:6,Image:7,PrintResult:8,FontSizes:9,InputFormat:11,DocumentSizeChanged:12,Zoomed:13,InputPositionChanged:16,TextViewLocation:19,TextMessage:20,DBScheme:21,SetCursor:22,DocumentTargets:23,Item:24,DialogResources:25,SetAppMode:26,ShowDialog:27,FieldDisplayModeChanged:28,SetRibbonButtonState:29,WaitDialog:30,SelectMasterTable:31,MergeFieldHighlightingChanged:32,CaretStateChanged:33,CloseDialog:34,ImageRegions:35,MoveAndUpdate:36,ContextMenuData:37,ConsoleLog:38,DrawShape:39,FieldPropertiesDialog:40,HyperlinkClicked:41,Pong:42,UnknownProtocol:43,StringResources:44,ProofingSettings:45,ItemActivationStateChangedEvent:46,HTMLDialogState:47,DocumentDirtyChanged:48,DocumentSaved:49,EnableSaveDocumentQuestion:50,SetTextViewActivationState:51,EditMode:52,ImageResources:53,MenuContent:54,WSDisconnectReason:55,MergeBlockHighlightingChanged:56,ServerEvent:57,DocumentData:58,SelectionData:59};
b.FileType={Document:0,Image:1,DataBase:2};
b.DialogCategory={TXDialog:0,HTMLDialog:1,};
b.HTMLDialogType={None:0,MergeFieldDialog:1,IfFieldDialog:2,IncludeTextFieldDialog:3,DateFieldDialog:4,NextIfFieldDialog:5,MaxPreviewRowsDialog:6,InputBoxDialog:7,EditMergeBlocksDialog:8,InsertMergeBlockDialog:9,WaitDialog:10,EditDataRelationsDialog:11,CreateDataRelationDialog:12,HyperlinkDialog:14,OptionsDialog:15,ChartSettingsDialog:16,ChartDataRelDialog:17,SaveDocumentAsDialog:18,ClientPasteDialog:19,SpellCheckDialog:20,OpenFileDialog:21,LoadDictionaryDialog:22};
b.TXDialogType={Unknown:0,FontDialog:1,ParagraphFormatDialog:2,InsertTableDialog:3,ChildDialog:4,ListFormatDialog:5,FormattingStylesDialog:6,SectionFormatDialog:7,LanguageDialog:8,TableFormatDialog:9,TabDialog:12,ObjectAttributesDialog:13,FindDialog:14,ReplaceDialog:15,ForeColorDialog:16,TextBackColorDialog:17,InsertSymbolDialog:18,};
b.VisualElement={ControlChars:0,TextFrameMarkerLines:1,BookmarkMarkers:2,TableGridLines:3,DrawingMarkerLines:4};
b.ConsoleLogType={Log:0,Debug:1,Info:2,Warn:3,Error:4};
b.ItemActivationState={Deactivated:0,Activated:1};
b.ServerEventType={TXComponentsLoaded:0,DocumentLoaded:1};
var aG={VariousMessages:0,RibbonStrings:1};
var aJ={Unknown:0,ServiceNotInstalled:1,ServiceNotRunning:2,CouldNotConnectToService:3};
var t={Left:false,Middle:false,Right:false};
b.variousMessages={webSocketErrMsg:{text:"Can't connect to the server.\nPlease refresh the website to re-connect."}};
b.imageResources={};
b.webSocketHandlerURL="";
b.documentSavedEventHandlers=[];
b.documentDirty=false;
b.saveDocumentQuestionEnabled=true;
b.ignoreNextTextFocusRequest=false;
b.inIMEComposition=false;
function s(){return("ontouchend" in document);
}b.isTouchDevice=s();
b.isSocketConnected=function(){return b.socket&&(b.socket.readyState==WebSocket.OPEN);
};
b.sendCommand=function(aO,aQ,aR,aS,aP){if(!b.isSocketConnected()){return;
}var aN={CommandID:parseInt(aO,10),Param1:aQ||0,Param2:aR||0,Param3:aS||0,Data:aP||"",};
var aT=JSON.stringify(aN);
b.socket.send(aT);
};
b.getWebAppRootDir=function(){var aR="";
var aP="";
var aN="";
if((typeof TXWebResources!=="undefined")&&TXWebResources.hasOwnProperty("webSocketHandlerPath")){aP=TXWebResources.webSocketHandlerPath;
}else{if((typeof TXSettings!=="undefined")){aN=TXSettings.AppVirtualPath;
}}var aQ=window.location.pathname.split("/");
aQ.pop();
var aO=(aQ.length==0)?"/":aQ.join("/")+"/";
if(aP){if(aP.slice(-1)!=="/"){aP+="/";
}if(aP[0]==="/"){aR=window.location.host+aP;
}else{aR=window.location.host+aO+aP;
}}else{if(aN){aR=window.location.host+aN;
}else{aR=window.location.host+aO;
}}return aR;
};
b.getTXFileDir=function(){var aO=b.getWebAppRootDir();
var aN=b.isSSLConnection?"https://":"http://";
if(typeof TXSettings!=="undefined"){return aN+aO+TXSettings.BasePath;
}else{return aN+aO;
}};
function r(){var aN=(typeof TXSettings!=="undefined")&&TXSettings.IsMVC;
var aP=b.isSSLConnection?"wss://":"ws://";
var aO=b.getWebAppRootDir();
if(aN){return aP+aO+TXSettings.ApiRoute+"TXWebSocket";
}else{return aP+aO+"TXWebSocketHandler.ashx";
}}function f(){[].forEach.call(TXWebResources.m_imageWebResources,function(aO){var aN=document.getElementById(aO.id);
if(aN){aN.src=aO.src;
}else{console.error('changeWebFormsImageSources(): Image "'+aO.id+'" not found.');
}});
}function e(){var aN=document.getElementById("txRibbonTabContentContainer");
var aO=aN.querySelectorAll("img");
[].forEach.call(aO,function(aP){var aQ=aP.getAttribute("src");
if((aQ.indexOf("data:image")>-1)||(aQ.substring(0,1)==="/")){return;
}aP.src=TXSettings.AppVirtualPath+TXSettings.BasePath+aQ;
});
}b.changeImageSources=function(){if(typeof TXWebResources!=="undefined"){f();
}else{if(typeof TXSettings!=="undefined"){e();
}}};
b.init=function(){var aP=document.getElementById("mainCanvas");
var aN=document.getElementById("horRulerCanvas");
var aR=document.getElementById("vertRulerCanvas");
var aQ=document.getElementById("statusBarCanvas");
aP.width=window.innerWidth;
aP.height=window.innerHeight;
aN.width=window.innerWidth;
aR.height=window.innerHeight;
aQ.width=window.innerWidth;
b.textViewer=new b.ComponentViewer(aP,b.ComponentType.TextView);
b.horRulerViewer=new b.ComponentViewer(aN,b.ComponentType.HorRuler);
b.vertRulerViewer=new b.ComponentViewer(aR,b.ComponentType.VertRuler);
b.statusBarViewer=new b.ComponentViewer(aQ,b.ComponentType.StatusBar);
b.webSocketHandlerURL=r();
console.info("Connecting to "+b.webSocketHandlerURL);
b.socket=new WebSocket(b.webSocketHandlerURL,"TXTextControl.Web");
b.socket.addEventListener("open",aM);
b.socket.addEventListener("message",aL);
b.socket.addEventListener("error",aK);
b.socket.addEventListener("close",aI);
window.addEventListener("unload",w);
window.addEventListener("resize",x);
window.onbeforeunload=v;
c();
document.addEventListener("inputPositionChanged",b.inputPositionChangedHandler);
document.addEventListener("uiFlagsUpdated",b.uiFlagsUpdatedHandler);
document.addEventListener("imageReceived",b.imageReceivedHandler);
document.addEventListener("imageRegionsUpdated",b.imageRegionsUpdatedHandler);
document.addEventListener("viewContentMovedAndUpdated",b.viewContentMovedAndUpdatedHandler);
document.addEventListener("printResultReceived",b.printResultReceivedHandler);
document.addEventListener("documentSizeChanged",b.documentSizeChangedHandler);
document.addEventListener("txZoomed",b.txZoomedHandler);
document.addEventListener("textViewLocationChanged",b.textViewLocationChangedHandler);
document.addEventListener("contextMenuDataReceived",b.contextMenuDataReceivedHandler);
document.addEventListener("txContainerResized",b.onContainerResize);
document.addEventListener("textViewCaretStateChanged",b.textViewCaretStateChangedHandler);
document.addEventListener("showFieldPropsDialog",b.showFieldPropsDialogHandler);
document.addEventListener("hyperlinkClicked",b.hyperlinkClickedHandler);
document.addEventListener("pongMessageReceived",z);
document.addEventListener("documentSaved",l);
document.addEventListener("textFieldDataReceived",b.textFieldDataReceivedHandler);
aP.addEventListener("drop",b.handleDrop);
aP.addEventListener("dragenter",function(aS){aS.preventDefault();
aS.stopPropagation();
});
aP.addEventListener("dragover",function(aS){aS.preventDefault();
aS.stopPropagation();
aS.dataTransfer.dropEffect="copy";
});
document.getElementById("ribbonbar").addEventListener("contextmenu",A);
document.getElementById("vertical-scrollbar-wrapper").addEventListener("contextmenu",A);
document.getElementById("horizontal-scrollbar-wrapper").addEventListener("contextmenu",A);
document.getElementById("scroll-button-up").addEventListener("contextmenu",A);
document.getElementById("scroll-button-down").addEventListener("contextmenu",A);
document.getElementById("scroll-button-left").addEventListener("contextmenu",A);
document.getElementById("scroll-button-right").addEventListener("contextmenu",A);
document.addEventListener("mousedown",j);
document.addEventListener("mouseup",k);
document.addEventListener("click",i);
document.addEventListener("mouseout",function(aS){if(!aS.relatedTarget||(aS.relatedTarget.nodeName=="HTML")){t.Left=false;
t.Middle=false;
t.Right=false;
if(b.mouseOwner){b.mouseOwner.canvas_MouseUp(aS);
b.mouseOwner=null;
}}});
b.initContextMenus();
b.createScrollbars();
b.adaptViewToContainerSize();
setInterval(function(){b.sendCommand(b.Command.Ping);
},y*1000);
if(!b.isTouchDevice){b.textViewer.focus();
}var aO=document.getElementById("txLoaderGif");
aO.style.opacity=1;
au();
};
a(document).ready(function(){b.init();
});
function c(){var aO=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver;
var aP=new aO(function(aQ){aQ.forEach(function(aR){switch(aR.type){case"attributes":switch(aR.attributeName){case"style":g();
break;
}break;
}});
});
var aN={attributes:true,childList:false,characterData:false};
aP.observe(document.getElementById("txTemplateDesignerContainer").parentElement,aN);
}function av(){if(typeof TXWebResources=="undefined"){return;
}if(!TXWebResources.hasOwnProperty("connectionID")){return;
}b.sendCommand(b.Command.SetGUID,0,0,0,TXWebResources.connectionID);
}function ac(){if((typeof TXSettings==="undefined")||!TXSettings.IsMVC){return;
}b.saveDocumentQuestionEnabled=TXSettings.SaveDocumentQuestionDialogEnabled;
b.sendCommand(b.Command.SetGUID,0,0,0,TXSettings.ConnectionID);
b.sendCommand(b.Command.TXSettingsMVC,0,0,0,TXSettings);
}function p(aN){if(navigator.userLanguage){aN.culture=navigator.userLanguage;
aN.uiCulture=navigator.browserLanguage;
}else{var aO=navigator.languages?navigator.languages[0]:navigator.language;
if(aO){aN.culture=aN.uiCulture=aO;
}else{console.warn("Unable to detect browser language.");
}}}function q(){var aN={culture:"",uiCulture:""};
p(aN);
if(typeof TXWebResources!=="undefined"){if(TXWebResources.hasOwnProperty("culture")&&TXWebResources.hasOwnProperty("uiCulture")){if(TXWebResources.culture){aN.culture=TXWebResources.culture;
}if(TXWebResources.uiCulture){aN.uiCulture=TXWebResources.uiCulture;
}}}else{if(typeof TXSettings!=="undefined"){if(TXSettings.Culture){aN.culture=TXSettings.Culture;
}if(TXSettings.UICulture){aN.uiCulture=TXSettings.UICulture;
}}}return aN;
}function aM(){av();
var aN=q();
b.sendCommand(b.Command.CreateTextControl,0,0,0,aN);
b.sendCommand(b.Command.IsTouchDevice,b.isTouchDevice?1:0);
ac();
}function x(){g();
}function g(){var aN=document.getElementById("txTemplateDesignerContainer").parentElement;
var aQ,aP;
if(aN.tagName=="BODY"){aQ=window.innerWidth;
aP=window.innerHeight;
}else{aQ=aN.offsetWidth;
aP=aN.offsetHeight;
}if((aQ!=b.clientSize.Width)||(aP!=b.clientSize.Height)){var aO=new CustomEvent("txContainerResized");
document.dispatchEvent(aO);
}}b.blockUserInput=function(){var aN=document.getElementById("txTemplateDesignerContainer");
var aO=document.createElement("DIV");
aO.style.position="absolute";
aO.style.left=aO.style.top="0px";
aO.style.width=aO.style.height="100%";
aO.style.background="rgba(0, 0, 0, 0.1)";
aO.style.zIndex="9998";
aN.appendChild(aO);
};
function m(aO,aP,aN,aQ){aO.style.transition="opacity "+(aQ/1000)+"s";
setTimeout(function(){aO.style.opacity=0;
setTimeout(function(){aP.removeChild(aO);
},aQ);
},aN);
}b.showMsgDiv=function(aQ,aP){b.textViewer.hideCaret();
var aN=document.getElementById("txTemplateDesignerContainer");
var aO=document.createElement("DIV");
aO.id="txErrMsgDiv";
aO.classList.add("unselectable");
aO.style.zIndex="9999";
aQ=aQ.replace(/\r?\n/g,"<br />");
aO.innerHTML=aQ;
aN.appendChild(aO);
aO.style.marginTop=-(aO.clientHeight/2)+"px";
aO.style.marginLeft=-(aO.clientWidth/2)+"px";
if(aP){m(aO,aN,1000,1000);
}};
b.showErrMsgDiv=function(){b.showMsgDiv(b.variousMessages.webSocketErrMsg.text);
};
function aF(){b.blockUserInput();
b.showErrMsgDiv();
}function aK(aN){b.socket=null;
setTimeout(aF,1000);
}function aI(aN){aK();
}function aL(aN){var aP=""+aN.data;
var aO=JSON.parse(aP);
aa(aO);
}function aa(aP){if(!aP.hasOwnProperty("ID")){console.error("Message has no ID");
return;
}if(!aP.hasOwnProperty("Body")){console.error("Message has no message body");
return;
}switch(aP.ID){case d.FontList:N(aP.Body);
break;
case d.FileList:M(aP.Body);
break;
case d.StyleList:an(aP.Body);
break;
case d.Image:R(aP.Body);
break;
case d.PrintResult:ad(aP.Body);
break;
case d.FontSizes:O(aP.Body);
break;
case d.InputFormat:T(aP.Body);
break;
case d.DocumentSizeChanged:I(aP.Body);
break;
case d.Zoomed:at(aP.Body);
break;
case d.InputPositionChanged:U(aP.Body);
break;
case d.TextViewLocation:ao(aP.Body);
break;
case d.TextMessage:var aQ=b.txDialog?b.txDialog.getActiveViewer():b.textViewer;
b.documentSavedEventHandlers=[];
b.jQueryAlert(aP.Body.caption,aP.Body.message,aQ);
break;
case d.DBScheme:F(aP.Body);
break;
case d.SetCursor:aj(aP.Body);
break;
case d.DocumentTargets:J(aP.Body);
break;
case d.Item:W(aP.Body);
break;
case d.DialogResources:G(aP.Body);
break;
case d.SetAppMode:ai(aP.Body);
break;
case d.ShowDialog:al(aP.Body);
break;
case d.FieldDisplayModeChanged:L(aP.Body);
break;
case d.SetRibbonButtonState:ak(aP.Body);
break;
case d.WaitDialog:aq(aP.Body);
break;
case d.SelectMasterTable:ag(aP.Body);
break;
case d.MergeFieldHighlightingChanged:Z(aP.Body);
break;
case d.MergeBlockHighlightingChanged:Y(aP.Body);
break;
case d.CaretStateChanged:B(aP.Body);
break;
case d.CloseDialog:C(aP.Body);
break;
case d.ImageRegions:S(aP.Body);
break;
case d.MoveAndUpdate:ab(aP.Body);
break;
case d.ContextMenuData:E(aP.Body);
break;
case d.ConsoleLog:D(aP.Body);
break;
case d.DrawShape:K(aP.Body);
break;
case d.FieldPropertiesDialog:var aN=new CustomEvent("showFieldPropsDialog");
document.dispatchEvent(aN);
break;
case d.HyperlinkClicked:Q(aP.Body);
break;
case d.Pong:aN=new CustomEvent("pongMessageReceived");
document.dispatchEvent(aN);
break;
case d.UnknownProtocol:ap();
break;
case d.StringResources:am(aP.Body);
break;
case d.ProofingSettings:ae(aP.Body);
break;
case d.ItemActivationStateChangedEvent:V(aP.Body);
break;
case d.HTMLDialogState:P(aP.Body);
break;
case d.DocumentDirtyChanged:b.documentDirty=aP.Body.documentDirty;
break;
case d.DocumentSaved:var aO=aP.Body.message;
if(aO&&aO.length){b.showMsgDiv(aO,true);
}b.documentDirty=false;
aN=new CustomEvent("documentSaved");
document.dispatchEvent(aN);
break;
case d.EnableSaveDocumentQuestion:b.saveDocumentQuestionEnabled=aP.Body.enabled;
break;
case d.SetTextViewActivationState:aw(aP.Body.activationState);
break;
case d.EditMode:b.setEditMode(aP.Body.editMode);
break;
case d.ImageResources:b.imageResources=aP.Body;
break;
case d.MenuContent:X(aP.Body);
break;
case d.WSDisconnectReason:ar(aP.Body);
break;
case d.ServerEvent:ah(aP.Body);
break;
case d.DocumentData:H(aP.Body);
break;
case d.SelectionData:af(aP.Body);
break;
}}function aw(aN){switch(aN){case b.ActivationState.Activated:b.textViewer.focus();
break;
case b.ActivationState.Deactivated:b.textViewer.blur();
break;
}}function R(aO){var aN=new CustomEvent("imageReceived",{detail:aO});
document.dispatchEvent(aN);
}function N(aO){var aN=new CustomEvent("fontListReceived",{detail:{fontNames:aO.fontNames}});
document.dispatchEvent(aN);
}function h(aO){var aN=new CustomEvent("uiFlagsUpdated",{detail:aO});
document.dispatchEvent(aN);
}function M(aO){var aN=new CustomEvent("fileListReceived",{detail:aO});
document.dispatchEvent(aN);
}function an(aO){var aN=new CustomEvent("styleListReceived",{detail:{styleNames:aO.styleNames}});
document.dispatchEvent(aN);
}function ad(aO){var aN=new CustomEvent("printResultReceived",{detail:aO});
document.dispatchEvent(aN);
}function O(aO){var aN=new CustomEvent("fontSizesReceived",{detail:{fontSizes:aO.fontSizes}});
document.dispatchEvent(aN);
}function T(aO){var aN=new CustomEvent("inputFormatReceived",{detail:aO});
document.dispatchEvent(aN);
}function I(aO){var aN=new CustomEvent("documentSizeChanged",{detail:aO});
document.dispatchEvent(aN);
}function at(aO){var aN=new CustomEvent("txZoomed",{detail:aO});
document.dispatchEvent(aN);
}function U(aO){var aN=new CustomEvent("inputPositionChanged",{detail:aO});
document.dispatchEvent(aN);
h(aO.uiFlags);
}function ao(aO){var aN=new CustomEvent("textViewLocationChanged",{detail:aO});
document.dispatchEvent(aN);
h(aO.uiFlags);
}function F(aO){var aN=new CustomEvent("dbSchemeReceived",{detail:aO});
document.dispatchEvent(aN);
}function aj(aO){var aN=new CustomEvent("componentCursorChanged",{detail:aO});
document.dispatchEvent(aN);
}function J(aO){var aN=new CustomEvent("documentTargetsReceived",{detail:{targets:aO.targets}});
document.dispatchEvent(aN);
}function W(aO){var aN=new CustomEvent("txItemReceived",{detail:aO});
document.dispatchEvent(aN);
switch(aO.itemType){case b.ItemType.FieldAdapter:aN=new CustomEvent("fieldDataReceived",{detail:aO.item});
document.dispatchEvent(aN);
break;
case b.ItemType.TextField:aN=new CustomEvent("textFieldDataReceived",{detail:aO});
document.dispatchEvent(aN);
break;
}}function G(aO){var aN=new CustomEvent("dialogResourcesReceived",{detail:aO});
document.dispatchEvent(aN);
}function ai(aO){var aN=new CustomEvent("appModeChanged",{detail:aO});
document.dispatchEvent(aN);
}function al(aN){switch(aN.dialogCategory){case b.DialogCategory.HTMLDialog:aA(aN);
break;
case b.DialogCategory.TXDialog:if(!b.txDialog){b.txDialog=new b.TxDialog(aN.initialImage,aN.caption,aN.dialogType);
b.txDialog.showModal();
}else{b.txDialog.showChildDialog(aN.initialImage,aN.caption);
}break;
}}function aA(aO){var aN;
switch(aO.dialogType){case b.HTMLDialogType.InputBoxDialog:aB(aO);
break;
case b.HTMLDialogType.MaxPreviewRowsDialog:aC(aO);
break;
case b.HTMLDialogType.ChildDialog:if(b.txDialog){b.txDialog.showChildDialog(aO.initialImage,aO.caption);
}else{b.jQueryAlert("Error Message","Can not open child dialog without having any TXTextControl dialog open.");
}break;
case b.HTMLDialogType.EditDataRelationsDialog:ay(aO.relations);
break;
case b.HTMLDialogType.EditMergeBlocksDialog:az(aO.blocks);
break;
case b.HTMLDialogType.OptionsDialog:aD(aO.options);
break;
case b.HTMLDialogType.ChartSettingsDialog:ax(aO.properties);
break;
case b.HTMLDialogType.InsertMergeBlockDialog:aN=new b.InsertMergeBlockDialog(aO.name,b.dbScheme);
aN.showModal();
break;
case b.HTMLDialogType.SaveDocumentAsDialog:aE(aO.fileName,aO.streamType);
break;
case b.HTMLDialogType.SpellCheckDialog:aN=new b.SpellCheckDialog(aO);
aN.showModal();
break;
case b.HTMLDialogType.LoadDictionaryDialog:aN=new b.LoadDictionaryDialog(aO);
aN.showModal();
break;
}}function L(aO){var aN=new CustomEvent("fieldDisplayModeChanged",{detail:aO});
document.dispatchEvent(aN);
}function ak(aO){var aN=new CustomEvent("ribbonButtonStateMessageReceived",{detail:aO});
document.dispatchEvent(aN);
}function aq(aO){var aN=new CustomEvent("waitDialogMessageReceived",{detail:aO});
document.dispatchEvent(aN);
}function ag(aO){var aN=new CustomEvent("masterTableSelected",{detail:aO});
document.dispatchEvent(aN);
}function Z(aO){var aN=new CustomEvent("mergeFieldHighlightingChanged",{detail:aO});
document.dispatchEvent(aN);
}function Y(aO){var aN=new CustomEvent("mergeBlockHighlightingChanged",{detail:aO});
document.dispatchEvent(aN);
}function B(aO){var aP=aO.target;
switch(aP){case b.ComponentType.TxDialog:var aN=new CustomEvent("dialogCaretStateChanged",{detail:aO});
document.dispatchEvent(aN);
break;
case b.ComponentType.TextView:var aN=new CustomEvent("textViewCaretStateChanged",{detail:aO});
document.dispatchEvent(aN);
break;
}}function C(aO){var aN=new CustomEvent("txDialogClosed",{detail:aO});
document.dispatchEvent(aN);
}function S(aO){var aN=new CustomEvent("imageRegionsUpdated",{detail:aO});
document.dispatchEvent(aN);
}function ab(aO){var aN=new CustomEvent("viewContentMovedAndUpdated",{detail:aO});
document.dispatchEvent(aN);
}function E(aO){var aN=new CustomEvent("contextMenuDataReceived",{detail:aO});
document.dispatchEvent(aN);
}function D(aN){var aO=aN.text;
switch(aN.type){case b.ConsoleLogType.Log:console.log(aO);
break;
case b.ConsoleLogType.Debug:console.debug(aO);
break;
case b.ConsoleLogType.Info:console.info(aO);
break;
case b.ConsoleLogType.Warn:console.warn(aO);
break;
case b.ConsoleLogType.Error:console.error(aO);
break;
}}function K(aO){var aN=new CustomEvent("drawShapeMessageReceived",{detail:aO});
document.dispatchEvent(aN);
}function Q(aO){var aN=new CustomEvent("hyperlinkClicked",{detail:aO.link});
document.dispatchEvent(aN);
}function ap(){}function am(aN){var aO=aN.resources;
switch(aN.type){case aG.VariousMessages:b.variousMessages=aO;
break;
case aG.RibbonStrings:b.ribbonStringResources=aO;
b.initRibbon();
break;
}}function ae(aN){if(aN.isSpellCheckingEnabled){a("#btnSpelling").removeClass("ui-state-disabled");
a("#btnLoadDictionary").removeClass("ui-state-disabled");
a("#tglBtnEnableSpellCheck").addClass("ribbon-button-selected");
}else{a("#btnSpelling").addClass("ui-state-disabled");
a("#btnLoadDictionary").addClass("ui-state-disabled");
a("#tglBtnEnableSpellCheck").removeClass("ribbon-button-selected");
}if(aN.isLangDetectEnabled){a("#tglBtnEnableLangDetect").addClass("ribbon-button-selected");
}else{a("#tglBtnEnableLangDetect").removeClass("ribbon-button-selected");
}if(aN.isHyphenationEnabled){a("#tglBtnEnableHyphenation").addClass("ribbon-button-selected");
}else{a("#tglBtnEnableHyphenation").removeClass("ribbon-button-selected");
}}function V(aO){var aN=null;
switch(aO.itemType){case b.ItemType.HeaderFooter:switch(aO.activationState){case b.ItemActivationState.Activated:aN=new CustomEvent("headerFooterActivated");
break;
case b.ItemActivationState.Deactivated:aN=new CustomEvent("headerFooterDeactivated");
break;
}break;
}if(aN){document.dispatchEvent(aN);
}}function P(aO){switch(aO.dialogType){case b.HTMLDialogType.SpellCheckDialog:var aN=new CustomEvent("spellCheckDialogStateUpdated",{detail:aO.state});
document.dispatchEvent(aN);
break;
}}function X(aO){var aN;
switch(aO.menuType){case b.MenuType.InsertShapes:b.insertShapesMenuContent=aO.menuItems;
break;
}}function ar(aN){var aO="";
switch(aN.reason){case aJ.CouldNotConnectToService:aO="The web server could not connect to the\r\nTX Text Control service for unknown reasons.";
break;
case aJ.ServiceNotInstalled:aO="The web server could not connect to the TX Text Control service\r\nbecause the service is not installed.";
break;
case aJ.ServiceNotRunning:aO="The web server could not connect to the TX Text Control service\r\nbecause the service is not running.";
break;
}if(aO){b.variousMessages.webSocketErrMsg.text=aO;
}console.error(aN.excType+": "+aN.excMsg);
}function ah(aN){switch(aN.eventType){case b.ServerEventType.DocumentLoaded:n(aN.eventData);
break;
}}function n(aO){var aN={fileName:aO.FileName};
b.fireEvent(b.EventName.documentLoaded,aN);
}function H(aR){var aO=b.saveDocumentCallbacks;
b.saveDocumentCallbacks=[];
if(aR.excMsg){throw Error(aR.excMsg);
}for(var aQ=0;
aQ<aO.length;
++aQ){var aN=aO[aQ];
try{aN({data:aR.data,streamType:aR.streamType});
}catch(aP){}}}function af(aR){var aO=b.saveSelectionCallbacks;
b.saveSelectionCallbacks=[];
if(aR.excMsg){throw Error(aR.excMsg);
}for(var aQ=0;
aQ<aO.length;
++aQ){var aN=aO[aQ];
try{aN({data:aR.data,streamType:aR.streamType});
}catch(aP){}}}b.fileSaveQuestion=function(aP){aP=aP||function(){};
if(!b.saveDocumentQuestionEnabled){aP();
return;
}var aT=b.txDialog?b.txDialog.getActiveViewer():b.textViewer;
var aO=b.variousMessages.fileSaveQuestionDlg.caption;
var aS=b.variousMessages.fileSaveQuestionDlg.text;
var aU=b.variousMessages.fileSaveQuestionDlg.yesBtnTxt;
var aQ=b.variousMessages.fileSaveQuestionDlg.noBtnTxt;
var aN=b.variousMessages.fileSaveQuestionDlg.cancelBtnTxt;
b.documentSavedEventHandlers=[];
var aR=function(){b.sendCommand(b.Command.Save);
b.documentSavedEventHandlers.push(aP);
};
a('<div style="font-size: 10pt; min-width: 250px">'+aS+"</div>").dialog({modal:true,resizable:false,title:aO,width:"auto",height:130,buttons:{Yes:{text:aU,click:function(){a(this).dialog("destroy").remove();
aR();
if(aT&&!b.isTouchDevice){aT.focus();
}}},No:{text:aQ,click:function(){a(this).dialog("destroy").remove();
aP();
if(aT&&!b.isTouchDevice){aT.focus();
}}},Cancel:{text:aN,click:function(){a(this).dialog("destroy").remove();
if(aT&&!b.isTouchDevice){aT.focus();
}}}},close:function(){a(this).dialog("destroy").remove();
if(aT&&!b.isTouchDevice){aT.focus();
}}});
};
function aB(aN){var aO=new b.InputBoxDialog(aN.title,aN.text);
aO.showModal();
}function aC(aN){var aO=new b.MaxPreviewRowsDialog(aN.value);
aO.showModal();
}function ay(aO){var aN=new b.EditDataRelationsDialog(aO);
aN.showModal();
}function az(aN){var aO=new b.EditMergeBlocksDialog(aN);
aO.showModal();
}function aD(aO){var aN=new b.OptionsDialog(aO);
aN.showModal();
}function ax(aO){var aN=new b.ChartSettingsDialog(aO);
aN.showModal();
}function aE(aO,aP){var aN=new b.SaveDocumentAsDialog(aO,aP);
aN.showModal();
}function o(aN){if(b.isTouchDevice){return;
}var aO=document.getElementById("txTemplateDesignerContainer");
if((aN==aO)||(aO.contains(aN))){if((aN.tagName!=="SELECT")&&(aN.tagName!=="INPUT")){b.textViewer.focus();
}}}function u(aN){var aO=document.getElementsByClassName("scrollbar-wrapper");
for(var aP=0;
aP<aO.length;
++aP){if(aO[aP].contains(aN)){o(aN);
break;
}}}function j(aN){u(aN.target);
t.Left=(aN.which==1);
t.Middle=(aN.which==2);
t.Right=(aN.which==3);
}function k(aN){if(aN.which==1){t.Left=false;
}if(aN.which==2){t.Middle=false;
}if(aN.which==3){t.Right=false;
}if(!t.Left&&!t.Middle&&!t.Right){b.mouseOwner=null;
}}function i(aN){o(aN.target);
}function z(){}function l(){for(var aO=0;
aO<b.documentSavedEventHandlers.length;
++aO){var aN=b.documentSavedEventHandlers[aO];
aN();
}b.documentSavedEventHandlers=[];
}function A(aN){aN.preventDefault();
}b.webSocketDisconnect=function(){if(!b.socket){return;
}if(b.isSocketConnected()){b.socket.removeEventListener("error",aK);
b.socket.removeEventListener("close",aI);
b.socket.close();
}b.socket=null;
};
function v(aN){if(b.isTouchDevice&&b.variousMessages.onBeforeUnloadMsg){return b.variousMessages.onBeforeUnloadMsg;
}}function w(aN){b.sendCommand(b.Command.Close);
b.webSocketDisconnect();
}b.jQueryAlert=function(aN,aO,aP){aN=aN||"";
aO=aO||"";
aO=aO.replace(/\r?\n/g,"<br />");
aP=typeof aP!=="undefined"?aP:null;
a('<div style="font-size: 10pt; min-width: 250px">'+aO+"</div>").dialog({modal:true,resizable:false,title:aN,width:"auto",buttons:{OK:function(){a(this).dialog("destroy").remove();
if(aP&&!b.isTouchDevice){aP.focus();
}},},close:function(){a(this).dialog("destroy").remove();
if(aP&&!b.isTouchDevice){aP.focus();
}}});
};
return aH;
}(TXTextControl||{},j$1_10_2));
if(typeof randomIntFromInterval!=="function"){randomIntFromInterval=function(b,a){return Math.floor(Math.random()*(a-b+1)+b);
};
}!Array.prototype.find&&(Array.prototype.find=function(a){for(var b=0;
b<this.length;
++b){if(a(this[b],b,this)){return this[b];
}}return undefined;
});
!Array.prototype.contains&&(Array.prototype.contains=function(a){return this.find(a)!==undefined;
});
if(typeof CustomEvent!=="function"){(function(){function a(b,d){d=d||{bubbles:false,cancelable:false,detail:undefined};
var c=document.createEvent("CustomEvent");
c.initCustomEvent(b,d.bubbles,d.cancelable,d.detail);
return c;
}a.prototype=window.CustomEvent.prototype;
window.CustomEvent=a;
})();
}if(typeof cloneObject!=="function"){cloneObject=function(a){return JSON.parse(JSON.stringify(a));
};
}var TXTextControl=(function(W,a){var b=W._private=W._private||{};
var l=null;
b.ApplicationMode={Normal:0,MailMergePreview:1,};
var t={Disabled:0,Enabled:1,Hidden:2};
b.EditMode={Edit:1,ReadAndSelect:2,ReadOnly:3};
b.MenuType={InsertShapes:1};
b.ribbonStringResources={};
var n="";
b.appMode=b.ApplicationMode.Normal;
var o=0;
var m=null;
b.isRibbonVisible=true;
b.ribbonTabsLoaded=false;
b.enableAffectedByEditModeWhenTabsLoaded=false;
b.editModeCur=b.EditMode.Edit;
b.ribbonBtnStateMsgBuf=[];
function p(){var Y=function(){b.sendCommand(b.Command.NewFile);
b.switchTabs(a("#tabDefault"));
a("#fileMnuItemSave").addClass("ui-state-disabled");
};
if(b.documentDirty){b.fileSaveQuestion(Y);
}else{Y();
}}b.initRibbon=function(){b.fileMenu=a("#fileMenu").menu().hide();
a("#fileMenu").on("menuselect",q);
a("ul.tabs a").click(function(){return r(a(this));
});
b.switchTabs(a("#tabDefault"));
a("#tabTableLayout").hide();
a("#tabObjectFormat").hide();
a("#tabShapeFormat").hide();
document.addEventListener("appModeChanged",g);
document.addEventListener("ribbonButtonStateMessageReceived",u);
document.addEventListener("waitDialogMessageReceived",X);
a("#txTemplateDesignerContainer .txRibbonScrollArrow").click(s);
a("#txTemplateDesignerContainer .txTriangle").click(s);
a("#txBtnRibbonHide").click(x);
k();
};
function q(Y,Z){switch(Z.item.context.id){case"fileMnuItemOpen":b.openFile();
break;
case"fileMnuItemSave":y();
break;
case"fileMnuItemSaveAs":z();
break;
case"fileMnuItemNew":p();
break;
case"fileMnuItemPrintToPDF":b.print();
break;
case"fileMnuItemOptions":V();
break;
}}b.openFile=function(Z){var Z=Z||b.FileType.Document;
var Y=function(){var aa=new b.OpenFileDialog(b.Command.OpenFile,Z);
aa.showModal();
};
if((Z==b.FileType.Document)&&b.documentDirty){b.fileSaveQuestion(Y);
}else{Y();
}};
function y(){b.sendCommand(b.Command.Save);
}function z(){b.sendCommand(b.Command.ShowDialog,b.DialogCategory.HTMLDialog,b.HTMLDialogType.SaveDocumentAsDialog);
}function r(Y){if(Y.attr("id")=="tabFile"){U(Y);
return false;
}else{b.switchTabs(Y);
}}function U(Z){b.hideAllOtherMenus();
var Y=document.getElementById("fileMenu");
b.calcMenuWidths(Y);
b.fileMenu.show().position({my:"left top",at:"left bottom",of:Z});
a(document).one("click",function(){b.fileMenu.hide();
});
}function V(){b.sendCommand(b.Command.ShowDialog,b.DialogCategory.HTMLDialog,b.HTMLDialogType.OptionsDialog);
}function j(Z){var Y=document.getElementById("txRibbonTabContentContainer");
if(Y.clientWidth>32){return Y.clientWidth;
}return 0;
}b.updateRibbonTabContentOffset=function(){var Z=j(n);
if((o<0)&&(Z+o)<b.clientSize.Width){var Y=document.getElementById("txRibbonTabContentContainer");
var aa=Math.min(0,(b.clientSize.Width-Z));
b.setVendor(Y,"transform","translate("+aa+"px, 0px)");
o=aa;
}};
b.updateRibbonScrollArrows=function(){var ae=j(n);
var aa=document.getElementById("txRibbonScrollButtonRight");
var Y=document.getElementById("txRibbonScrollButtonLeft");
var ad=aa.clientWidth;
var Z=b.clientSize.Width-ad;
aa.style.left=Z+"px";
var ab=(o<0);
var ac=(b.clientSize.Width<(ae+o));
Y.style.opacity=ab?null:0;
aa.style.opacity=ac?null:0;
};
b.updateRibbonHideButtonPos=function(){var Y=document.getElementById("txBtnRibbonHide");
var aa=Y.clientWidth;
var Z=b.clientSize.Width-aa-5;
Y.style.left=Z+"px";
};
b.setVendor=function(Z,aa,ab){var Y=aa.charAt(0).toUpperCase()+aa.substring(1);
Z.style[aa]=ab;
Z.style["webkit"+Y]=ab;
Z.style["Moz"+Y]=ab;
Z.style["ms"+Y]=ab;
Z.style["o"+Y]=ab;
};
b.resetRibbonTabContentPos=function(){o=0;
var Y=document.getElementById("txRibbonTabContentContainer");
b.setVendor(Y,"transform",null);
b.updateRibbonScrollArrows();
};
function B(aa){var Y=null;
switch(aa){case"ribbonTabTableLayout":Y="#14C100";
break;
case"ribbonTabObjectFormat":Y="#E67FFE";
break;
case"ribbonTabShapeFormat":Y="#FFA000";
break;
}var Z=document.querySelector("#txRibbonContentArea");
Z.style.borderTop=(Y!=null)?"1px solid "+Y:"";
}b.switchTabs=function(Z){b.showRibbonBar(true);
a("div.tab-content").css("display","none");
a("ul.tabs a").removeClass("selected");
var Y=Z.attr("rel");
a("#"+Y).css("display","inline-block");
Z.addClass("selected");
B(Y);
n=Y;
b.resetRibbonTabContentPos();
};
function i(){a("div.ribbon-dropdown-button-tiny").each(function(){var Y=document.createElement("p");
Y.textContent="▼";
a(this).append(Y);
});
}function k(){var Z="";
if((typeof TXSettings!=="undefined")&&TXSettings.IsMVC){Z=b.getTXFileDir();
}var Y={home:Z+"Ribbon/RibbonTabHome.html",insert:Z+"Ribbon/RibbonTabInsert.html",pageLayout:Z+"Ribbon/RibbonTabPageLayout.html",reporting:Z+"Ribbon/RibbonTabMailings.html",view:Z+"Ribbon/RibbonTabView.html",tableLayout:Z+"Ribbon/RibbonTabTableLayout.html",objectFormat:Z+"Ribbon/RibbonTabObjectFormat.html",shapeFormat:Z+"Ribbon/RibbonTabShapeFormat.html"};
a("#ribbonTabHome").load(Y.home,function(){b.attachHomeTabEventHandlers();
a("#ribbonTabInsert").load(Y.insert,function(){b.attachInsertTabEventHandlers();
a("#ribbonTabPageLayout").load(Y.pageLayout,function(){b.attachPageLayoutTabEventHandlers();
a("#ribbonTabMailings").load(Y.reporting,function(){b.attachMailingsTabEventHandlers();
a("#ribbonTabView").load(Y.view,function(){b.attachViewTabEventHandlers();
a("#ribbonTabTableLayout").load(Y.tableLayout,function(){b.attachTableLayoutTabEventHandlers();
a("#ribbonTabObjectFormat").load(Y.objectFormat,function(){b.attachObjectFormatTabEventHandlers();
a("#ribbonTabShapeFormat").load(Y.shapeFormat,function(){b.attachShapeFormatTabEventHandlers();
b.changeImageSources();
i();
e();
b.setRibbonStrings();
});
});
});
});
});
});
});
});
}function e(){b.applyShapesMenuContent();
}function g(Y){b.setAppMode(Y.detail.appMode);
}var c=["#ribbonGroupClipboard .ribbon-group-content","#ribbonGroupFont .ribbon-group-content","#ribbonGroupParagraph .ribbon-group-content","#drpDnBtnStyles","#ribbonGroupEditing .ribbon-group-content","#ribbonGroupPages .ribbon-group-content","#ribbonGroupTables .ribbon-group-content","#ribbonGroupIllustrations .ribbon-group-content","#ribbonGroupLinks .ribbon-group-content","#ribbonGroupHeadersAndFooters .ribbon-group-content","#ribbonGroupText .ribbon-group-content","#ribbonGroupSymbols .ribbon-group-content","#ribbonGroupPageSetup .ribbon-group-content","#ribbonGroupMergeField .ribbon-group-content","#ribbonGroupMergeBlock .ribbon-group-content","#ribbonGroupView .ribbon-group-content","#ribbonGroupMailMergeFinish .ribbon-group-content","#ribbonGroupProofing .ribbon-group-content","#btnTableProperties","#ribbonGroupTblLayoutRowsCols .ribbon-group-content","#ribbonGroupTblLayoutMerge .ribbon-group-content","#ribbonGroupTblLayoutAlignment .ribbon-group-content","#drpDnBtnObjectProperties","#ribbonGroupObjectArrange .ribbon-group-content"];
function h(Y){c.forEach(function(aa){var Z=document.querySelector(aa);
if(Z){if(Y){if(Z.getAttribute("data-disabled-by-edit-mode-event")){Z.classList.remove("ui-state-disabled");
Z.removeAttribute("data-disabled-by-edit-mode-event");
}}else{if(!Z.classList.contains("ui-state-disabled")){Z.classList.add("ui-state-disabled");
Z.setAttribute("data-disabled-by-edit-mode-event",true);
}}}});
}b.setEditMode=function(Z){b.editModeCur=Z;
if(!b.ribbonTabsLoaded){b.enableAffectedByEditModeWhenTabsLoaded=true;
}else{var Y=(Z==b.EditMode.Edit);
h(Y);
}};
b.clearInsertMergeBlockMenu=function(){var Y=document.getElementById("insertMergeBlockDropDown");
var Z=[];
Z.push(document.getElementById("mnuItemInsertMergeBlock"));
Z.push(document.getElementById("mnuItemHighlightMergeBlocks"));
Z.forEach(function(aa){Y.removeChild(aa);
});
Y.innerHTML="";
Z.forEach(function(aa){Y.appendChild(aa);
});
};
function f(Z){var Y=Z.buttonNames,aa=Z.buttonState;
Y.forEach(function(ab){switch(aa){case t.Disabled:switch(ab){case"drpDnBtnInsertMergeBlock":b.clearInsertMergeBlockMenu();
break;
default:a("#"+ab).show();
a("#"+ab).addClass("ui-state-disabled");
break;
}break;
case t.Enabled:a("#"+ab).show();
a("#"+ab).removeClass("ui-state-disabled");
break;
case t.Hidden:a("#"+ab).hide();
break;
}});
}function u(Y){var Z=Y.detail;
if(!b.ribbonTabsLoaded){b.ribbonBtnStateMsgBuf.push(Z);
return;
}f(Z);
}function d(){b.ribbonBtnStateMsgBuf.forEach(function(Y){f(Y);
});
b.ribbonBtnStateMsgBuf=[];
}function X(Y){var aa=Y.detail;
var ab=aa.show,ac=aa.title,Z=aa.message;
if(ab&&!l){l=new b.WaitDialog(ac,Z);
l.showModal();
}else{if(!ab&&l){l.close(a("#waitDialog"));
l=null;
}}}function w(ac){if(ac.style.opacity!==""){return;
}var Y=document.getElementById("txRibbonTabContentContainer");
var Z=Y.clientWidth;
var ab=(Z+o)-b.clientSize.Width;
var aa=-Math.min(ab,b.clientSize.Width);
b.setVendor(Y,"transform","translate("+(o+aa)+"px, 0px)");
o+=aa;
b.updateRibbonScrollArrows();
}function v(ac){if(ac.style.opacity!==""){return;
}var Y=document.getElementById("txRibbonTabContentContainer");
var Z=Y.clientWidth;
var ab=-o;
var aa=Math.min(ab,b.clientSize.Width);
b.setVendor(Y,"transform","translate("+(o+aa)+"px, 0px)");
o+=aa;
b.updateRibbonScrollArrows();
}function s(Y){switch(Y.target.id){case"txRibbonScrollButtonRight":w(Y.target);
break;
case"txBlackTriangleR":if(Y.target.parentElement.id=="txRibbonScrollButtonRight"){w(Y.target.parentElement);
}break;
case"txRibbonScrollButtonLeft":v(Y.target);
break;
case"txBlackTriangleL":if(Y.target.parentElement.id=="txRibbonScrollButtonLeft"){v(Y.target.parentElement);
}break;
}}function x(Y){if(b.isRibbonVisible){b.showRibbonBar(false);
}else{b.showRibbonBar(true);
}}b.setAppMode=function(Y){b.appMode=Y;
var Z=a("*[data-applicationmodes]");
Z.each(function(){var aa=a(this),ac=aa.attr("data-tab-type"),ab=aa.attr("data-applicationmodes").split(/[\s,]+/);
if(ab.contains(function(ad){return(parseInt(ad,10)==Y);
})&&(ac!=="contextual")){aa.show();
}else{aa.hide();
}});
switch(Y){case b.ApplicationMode.MailMergePreview:a("#tglBtnPreviewMergeResults").addClass("ribbon-button-selected");
break;
case b.ApplicationMode.Normal:a("#tglBtnPreviewMergeResults").removeClass("ribbon-button-selected");
break;
}b.resetRibbonTabContentPos();
b.updateRibbonScrollArrows();
};
function C(ab,ac){var Z=document.getElementById(ab);
if(!Z){console.error('Could not find menu item "'+ab+'".');
return;
}var Y=Z.getElementsByClassName("large-menu-item-caption-container");
if(!Y.length){console.error("Menu item caption container div not found.");
return;
}var aa=document.createElement("P");
aa.textContent=ac;
Y[0].appendChild(aa);
}function M(Y,ac,ad){var Z=document.getElementById(Y);
if(!Z){console.error('Could not find button "'+Y+'".');
return;
}if(ad){Z.title=ad;
}var ab=Z.querySelector("span.ribbon-button-label-text");
if(ab){ab.innerHTML=ac;
}else{var aa=Z.querySelector("p.ribbon-button-label");
if(!aa){console.error("Ribbon button label element not found. ("+Y+")");
return;
}aa.innerHTML=ac;
}}function J(aa,ab){var Z=document.getElementById(aa);
if(!Z){console.error('Could not find menu item "'+aa+'".');
return;
}var Y=Z.querySelector(".menu-item-category-header h1");
if(!Y){console.error("Ribbon menu section header element not found ("+aa+")");
return;
}Y.textContent=ab;
}function O(aa,ab){var Y=document.getElementById(aa);
if(!Y){console.error('Could not find ribbon group "'+aa+'".');
return;
}var Z=Y.querySelector("p.ribbon-group-label");
if(!Z){console.error("Ribbon group label element not found. ("+aa+")");
return;
}Z.textContent=ab;
}function N(Y,aa){var Z=document.getElementById(Y);
if(!Z){console.error('Could not find button "'+Y+'".');
return;
}Z.setAttribute("title",aa);
}function I(ab,Y){var Z=document.getElementById(ab);
if(!Z){console.error('Could not find menu item "'+ab+'".');
return;
}var aa=Z.querySelector(".large-menu-item-caption-container p, .small-menu-item-caption-container p, .menu-item-caption-container-numbered-list p, .menu-item-caption-container-42px p");
if(!aa){console.error("List menu item caption element not found. ("+ab+")");
return;
}aa.textContent=Y;
}function G(ac,ab,ad){var Z=document.getElementById(ac);
if(!Z){console.error('Could not find menu item "'+ac+'".');
return;
}if(ab){var Y=Z.querySelector(".large-menu-item-long-caption-container h1");
Y.textContent=ab;
}if(ad){var aa=Z.querySelector(".large-menu-item-long-caption-container p");
aa.innerHTML=ad;
}}function F(Y,aa){var Z=document.querySelector("label[for="+Y+"]");
if(!Z){console.error('Could not find label for element "'+Y+'".');
return;
}if(!Z){console.error("Label for element "+Y+" not found.");
return;
}Z.textContent=aa;
}function R(Z,aa){var Y=document.querySelector("#"+Z+" a");
if(!Y){console.error('Could not find menu item "'+Z+'".');
return;
}if(!Y){console.error("Menu item "+Z+" not found.");
return;
}Y.textContent=aa;
}function D(Y){O("ribbonGroupClipboard",Y.RIBBON_TAB_HOME_GRP_CLIPB_TITLE);
M("drpDnBtnPaste",Y.RIBBON_TAB_HOME_GRP_CLIPB_BTN_PASTE);
G("mnuItemServerPaste",Y.RIBBON_TAB_HOME_GRP_CLIPB_PASTE_MNU_ITM_SERVER_HEAD,Y.RIBBON_TAB_HOME_GRP_CLIPB_PASTE_MNU_ITM_SERVER_DESC);
G("mnuItemClientPaste",Y.RIBBON_TAB_HOME_GRP_CLIPB_PASTE_MNU_ITM_CLIENT_HEAD,Y.RIBBON_TAB_HOME_GRP_CLIPB_PASTE_MNU_ITM_CLIENT_DESC);
M("btnCut",Y.RIBBON_TAB_HOME_GRP_CLIPB_BTN_CUT);
M("btnCopy",Y.RIBBON_TAB_HOME_GRP_CLIPB_BTN_COPY);
O("ribbonGroupFont",Y.RIBBON_TAB_HOME_GRP_FONT_TITLE);
N("btnFontGrow",Y.RIBBON_TAB_HOME_GRP_FONT_BTN_GROW);
N("btnFontShrink",Y.RIBBON_TAB_HOME_GRP_FONT_BTN_SHRINK);
N("tglBtnBold",Y.RIBBON_TAB_HOME_GRP_FONT_BTN_BOLD);
N("tglBtnItalic",Y.RIBBON_TAB_HOME_GRP_FONT_BTN_ITALIC);
N("drpDnBtnUnderlineStyles",Y.RIBBON_TAB_HOME_GRP_FONT_BTN_UNDERLINE);
I("mnuItmULStyleSingle",Y.RIBBON_TAB_HOME_GRP_FONT_UNDERLINE_MNU_ITM_SINGLE);
I("mnuItmULStyleDoubled",Y.RIBBON_TAB_HOME_GRP_FONT_UNDERLINE_MNU_ITM_DOUBLED);
I("mnuItmULStyleSingleWO",Y.RIBBON_TAB_HOME_GRP_FONT_UNDERLINE_MNU_ITM_SINGLE_WORDS);
I("mnuItmULStyleDoubledWO",Y.RIBBON_TAB_HOME_GRP_FONT_UNDERLINE_MNU_ITM_DOUBLED_WORDS);
N("tglBtnStrikethrough",Y.RIBBON_TAB_HOME_GRP_FONT_BTN_STRIKETHROUGH);
N("tglBtnSubscript",Y.RIBBON_TAB_HOME_GRP_FONT_BTN_SUBSCRIPT);
N("tglBtnSuperscript",Y.RIBBON_TAB_HOME_GRP_FONT_BTN_SUPERSCRIPT);
N("btnHighlightColor",Y.RIBBON_TAB_HOME_GRP_FONT_BTN_HIGHLIGHT_COLOR);
N("btnFontColor",Y.RIBBON_TAB_HOME_GRP_FONT_BTN_COLOR);
N("btnCharacterSettings",Y.RIBBON_TAB_HOME_GRP_FONT_BTN_CHAR_FMT);
O("ribbonGroupParagraph",Y.RIBBON_TAB_HOME_GRP_PARA_TITLE);
N("drpDnBtnBulletList",Y.RIBBON_TAB_HOME_GRP_PARA_BTN_LST_BULLET);
I("mnuItemBulletListDisc",Y.RIBBON_TAB_HOME_GRP_PARA_LST_BULLET_MNU_ITM_DISC);
I("mnuItemBulletListDash",Y.RIBBON_TAB_HOME_GRP_PARA_LST_BULLET_MNU_ITM_DASH);
I("mnuItemBulletListAsterisk",Y.RIBBON_TAB_HOME_GRP_PARA_LST_BULLET_MNU_ITM_ASTERISK);
I("mnuItemBulletListDiamond",Y.RIBBON_TAB_HOME_GRP_PARA_LST_BULLET_MNU_ITM_DIAMOND);
I("mnuItemBulletListArrow",Y.RIBBON_TAB_HOME_GRP_PARA_LST_BULLET_MNU_ITM_ARROW);
I("mnuItemListFormatBullet",Y.RIBBON_TAB_HOME_GRP_PARA_LST_MNU_ITM_FMT_LST);
N("drpDnBtnNumberedList",Y.RIBBON_TAB_HOME_GRP_PARA_BTN_LST_NUMBERED);
I("mnuItemNumberedList_123",Y.RIBBON_TAB_HOME_GRP_PARA_LST_NUMBERED_MNU_ITM_123);
I("mnuItemNumberedList_abc",Y.RIBBON_TAB_HOME_GRP_PARA_LST_NUMBERED_MNU_ITM_ABC);
I("mnuItemNumberedList_ABC",Y.RIBBON_TAB_HOME_GRP_PARA_LST_NUMBERED_MNU_ITM_ABC_CAPS);
I("mnuItemNumberedList_III",Y.RIBBON_TAB_HOME_GRP_PARA_LST_NUMBERED_MNU_ITM_ROMAN);
I("mnuItemNumberedList_iii",Y.RIBBON_TAB_HOME_GRP_PARA_LST_NUMBERED_MNU_ITM_ROMAN_SMALL);
I("mnuItemFormatListNumbered",Y.RIBBON_TAB_HOME_GRP_PARA_LST_MNU_ITM_FMT_LST);
N("drpDnBtnStructuredList",Y.RIBBON_TAB_HOME_GRP_PARA_BTN_LST_STRUCT);
I("mnuItemStructuredList_123",Y.RIBBON_TAB_HOME_GRP_PARA_LST_NUMBERED_MNU_ITM_123);
I("mnuItemStructuredList_abc",Y.RIBBON_TAB_HOME_GRP_PARA_LST_NUMBERED_MNU_ITM_ABC);
I("mnuItemStructuredList_ABC",Y.RIBBON_TAB_HOME_GRP_PARA_LST_NUMBERED_MNU_ITM_ABC_CAPS);
I("mnuItemStructuredList_III",Y.RIBBON_TAB_HOME_GRP_PARA_LST_NUMBERED_MNU_ITM_ROMAN);
I("mnuItemStructuredList_iii",Y.RIBBON_TAB_HOME_GRP_PARA_LST_NUMBERED_MNU_ITM_ROMAN_SMALL);
I("mnuItemFormatListStructured",Y.RIBBON_TAB_HOME_GRP_PARA_LST_MNU_ITM_FMT_LST);
N("btnIndentDecrease",Y.RIBBON_TAB_HOME_GRP_PARA_BTN_IND_DEC);
N("btnIndentIncrease",Y.RIBBON_TAB_HOME_GRP_PARA_BTN_IND_INC);
N("tglBtnTextDirLTR",Y.RIBBON_TAB_HOME_GRP_PARA_BTN_LTR);
N("tglBtnTextDirRTL",Y.RIBBON_TAB_HOME_GRP_PARA_BTN_RTL);
N("btnTabs",Y.RIBBON_TAB_HOME_GRP_PARA_BTN_TABS);
N("tglBtnControlChars",Y.RIBBON_TAB_HOME_GRP_PARA_BTN_CTRL_CHARS);
N("tglBtnAlignLeft",Y.RIBBON_TAB_HOME_GRP_PARA_BTN_ALIGN_LEFT);
N("tglBtnAlignCenter",Y.RIBBON_TAB_HOME_GRP_PARA_BTN_ALIGN_CENTER);
N("tglBtnAlignRight",Y.RIBBON_TAB_HOME_GRP_PARA_BTN_ALIGN_RIGHT);
N("tglBtnAlignJust",Y.RIBBON_TAB_HOME_GRP_PARA_BTN_ALIGN_JUST);
N("drpDnBtnLineSpacing",Y.RIBBON_TAB_HOME_GRP_PARA_BTN_LINE_SPACE);
I("mnuItemLineSpacing_1_0",Y.RIBBON_TAB_HOME_GRP_PARA_LINE_SPACE_MNU_ITM_1_0);
I("mnuItemLineSpacing_1_15",Y.RIBBON_TAB_HOME_GRP_PARA_LINE_SPACE_MNU_ITM_1_15);
I("mnuItemLineSpacing_1_5",Y.RIBBON_TAB_HOME_GRP_PARA_LINE_SPACE_MNU_ITM_1_5);
I("mnuItemLineSpacing_2_0",Y.RIBBON_TAB_HOME_GRP_PARA_LINE_SPACE_MNU_ITM_2_0);
I("mnuItemLineSpacing_2_5",Y.RIBBON_TAB_HOME_GRP_PARA_LINE_SPACE_MNU_ITM_2_5);
I("mnuItemLineSpacing_3_0",Y.RIBBON_TAB_HOME_GRP_PARA_LINE_SPACE_MNU_ITM_3_0);
N("drpDnBtnBorders",Y.RIBBON_TAB_HOME_GRP_PARA_BTN_BORDERS);
I("mnuItemBorderLeft",Y.RIBBON_TAB_HOME_GRP_PARA_BORDERS_MNU_ITM_LEFT);
I("mnuItemBorderTop",Y.RIBBON_TAB_HOME_GRP_PARA_BORDERS_MNU_ITM_TOP);
I("mnuItemBorderRight",Y.RIBBON_TAB_HOME_GRP_PARA_BORDERS_MNU_ITM_RIGHT);
I("mnuItemBorderBottom",Y.RIBBON_TAB_HOME_GRP_PARA_BORDERS_MNU_ITM_BOT);
I("mnuItemBorderOutside",Y.RIBBON_TAB_HOME_GRP_PARA_BORDERS_MNU_ITM_OUTSIDE);
I("mnuItemBorderAll",Y.RIBBON_TAB_HOME_GRP_PARA_BORDERS_MNU_ITM_ALL);
I("mnuItemBorderInsideHor",Y.RIBBON_TAB_HOME_GRP_PARA_BORDERS_MNU_ITM_INS_HOR);
I("mnuItemBorderInsideVert",Y.RIBBON_TAB_HOME_GRP_PARA_BORDERS_MNU_ITM_INS_VERT);
N("btnParSettings",Y.RIBBON_TAB_HOME_GRP_PARA_BTN_PARA_FMT);
O("ribbonGroupStyles",Y.RIBBON_TAB_HOME_GRP_STYLES_TITLE);
M("drpDnBtnStyles",Y.RIBBON_TAB_HOME_GRP_STYLES_BTN_STYLES);
G("mnuItemManageStyles",Y.RIBBON_TAB_HOME_GRP_STYLES_STYLES_MNU_ITM_MANAGE_HEAD,Y.RIBBON_TAB_HOME_GRP_STYLES_STYLES_MNU_ITM_MANAGE_DESC);
O("ribbonGroupEditing",Y.RIBBON_TAB_HOME_GRP_EDIT_TITLE);
M("btnUndo",Y.RIBBON_TAB_HOME_GRP_EDIT_BTN_UNDO);
M("btnRedo",Y.RIBBON_TAB_HOME_GRP_EDIT_BTN_REDO);
M("btnFind",Y.RIBBON_TAB_HOME_GRP_EDIT_BTN_FIND);
M("btnReplace",Y.RIBBON_TAB_HOME_GRP_EDIT_BTN_REPLACE);
M("btnSelectAll",Y.RIBBON_TAB_HOME_GRP_EDIT_BTN_SEL_ALL);
}function A(Y){G("mnuItemInsertQRCode",null,Y.RIBBON_TAB_INSERT_GRP_ILLUST_BARCODE_MNU_QRCODE);
G("mnuItemInsertAztecCode",null,Y.RIBBON_TAB_INSERT_GRP_ILLUST_BARCODE_MNU_AZTECCODE);
G("mnuItemInsertDatamatrix",null,Y.RIBBON_TAB_INSERT_GRP_ILLUST_BARCODE_MNU_DATAMATRIX);
G("mnuItemInsertPDF417",null,Y.RIBBON_TAB_INSERT_GRP_ILLUST_BARCODE_MNU_PDF417);
G("mnuItemInsertMicroPDF",null,Y.RIBBON_TAB_INSERT_GRP_ILLUST_BARCODE_MNU_MICROPDF);
G("mnuItemInsertMaxicode",null,Y.RIBBON_TAB_INSERT_GRP_ILLUST_BARCODE_MNU_MAXICODE);
J("mnuItemInsertCode128",Y.RIBBON_TAB_INSERT_GRP_ILLUST_BARCODE_MNU_HDR_1D);
G("mnuItemInsertCode128",null,Y.RIBBON_TAB_INSERT_GRP_ILLUST_BARCODE_MNU_CODE128);
G("mnuItemInsertEAN13",null,Y.RIBBON_TAB_INSERT_GRP_ILLUST_BARCODE_MNU_EAN13);
G("mnuItemInsertUPCA",null,Y.RIBBON_TAB_INSERT_GRP_ILLUST_BARCODE_MNU_UPCA);
G("mnuItemInsertEAN8",null,Y.RIBBON_TAB_INSERT_GRP_ILLUST_BARCODE_MNU_EAN8);
G("mnuItemInsertInterleaved2of5",null,Y.RIBBON_TAB_INSERT_GRP_ILLUST_BARCODE_MNU_INTERL2OF5);
G("mnuItemInsertPostnet",null,Y.RIBBON_TAB_INSERT_GRP_ILLUST_BARCODE_MNU_POSTNET);
G("mnuItemInsertCode39",null,Y.RIBBON_TAB_INSERT_GRP_ILLUST_BARCODE_MNU_CODE39);
G("mnuItemInsertIntelligentMail",null,Y.RIBBON_TAB_INSERT_GRP_ILLUST_BARCODE_MNU_INTELMAIL);
G("mnuItemInsertCodabar",null,Y.RIBBON_TAB_INSERT_GRP_ILLUST_BARCODE_MNU_CODABAR);
G("mnuItemInsertFourState",null,Y.RIBBON_TAB_INSERT_GRP_ILLUST_BARCODE_MNU_FOURSTATE);
G("mnuItemInsertCode11",null,Y.RIBBON_TAB_INSERT_GRP_ILLUST_BARCODE_MNU_CODE11);
G("mnuItemInsertCode93",null,Y.RIBBON_TAB_INSERT_GRP_ILLUST_BARCODE_MNU_CODE93);
G("mnuItemInsertPLANET",null,Y.RIBBON_TAB_INSERT_GRP_ILLUST_BARCODE_MNU_PLANET);
G("mnuItemInsertRoyalMail",null,Y.RIBBON_TAB_INSERT_GRP_ILLUST_BARCODE_MNU_ROYMAIL);
}function E(Y){O("ribbonGroupPages",Y.RIBBON_TAB_INSERT_GRP_PAGES_TITLE);
M("btnBlankPage",Y.RIBBON_TAB_INSERT_GRP_PAGES_BTN_BLANK_PAGE);
M("btnPageBreak",Y.RIBBON_TAB_INSERT_GRP_PAGES_BTN_PAGE_BREAK);
O("ribbonGroupTables",Y.RIBBON_TAB_INSERT_GRP_TABLES_TITLE);
M("btnInsertTable",Y.RIBBON_TAB_INSERT_GRP_TABLES_BTN_TABLE);
O("ribbonGroupIllustrations",Y.RIBBON_TAB_INSERT_GRP_ILLUST_TITLE);
M("drpDnBtnInsertImage",Y.RIBBON_TAB_INSERT_GRP_ILLUST_BTN_IMAGE);
G("mnuItemInsertImage",Y.RIBBON_TAB_INSERT_GRP_ILLUST_IMAGE_MNU_ITM_IMAGE_HEAD,Y.RIBBON_TAB_INSERT_GRP_ILLUST_IMAGE_MNU_ITM_IMAGE_DESC);
G("mnuItemInsertImagePlacehld",Y.RIBBON_TAB_INSERT_GRP_ILLUST_IMAGE_MNU_ITM_IMG_PLCHLD_HEAD,Y.RIBBON_TAB_INSERT_GRP_ILLUST_IMAGE_MNU_ITM_IMG_PLCHLD_DESC);
M("drpDnBtnInsertShape",Y.RIBBON_TAB_INSERT_GRP_ILLUST_BTN_SHAPES);
M("btnInsertChart",Y.RIBBON_TAB_INSERT_GRP_ILLUST_BTN_CHART);
M("drpDnBtnInsertBarcode",Y.RIBBON_TAB_INSERT_GRP_ILLUST_BTN_BARCODE);
J("mnuItemInsertQRCode",Y.RIBBON_TAB_INSERT_GRP_ILLUST_BARCODE_MNU_HDR_2D);
A(Y);
O("ribbonGroupLinks",Y.RIBBON_TAB_INSERT_GRP_LINKS_TITLE);
M("drpDnBtnInsertHyperlink",Y.RIBBON_TAB_INSERT_GRP_LINKS_BTN_HYPLNK);
G("mnuItemInsertHyperlink",Y.RIBBON_TAB_INSERT_GRP_LINKS_HYPLNK_MNU_ITM_INS_HEAD,Y.RIBBON_TAB_INSERT_GRP_LINKS_HYPLNK_MNU_ITM_INS_DESC);
G("mnuItemEditHyperlink",Y.RIBBON_TAB_INSERT_GRP_LINKS_HYPLNK_MNU_ITM_EDIT_HEAD,Y.RIBBON_TAB_INSERT_GRP_LINKS_HYPLNK_MNU_ITM_EDIT_DESC);
G("mnuItemDeleteHyperlink",Y.RIBBON_TAB_INSERT_GRP_LINKS_HYPLNK_MNU_ITM_DELETE_HEAD,Y.RIBBON_TAB_INSERT_GRP_LINKS_HYPLNK_MNU_ITM_DELETE_DESC);
M("drpDnBtnInsertBookmark",Y.RIBBON_TAB_INSERT_GRP_LINKS_BTN_BOOKMRK);
G("mnuItemInsertBookmark",Y.RIBBON_TAB_INSERT_GRP_LINKS_BKMRK_MNU_ITM_INS_HEAD,Y.RIBBON_TAB_INSERT_GRP_LINKS_BKMRK_MNU_ITM_INS_DESC);
G("mnuItemDeleteBookmark",Y.RIBBON_TAB_INSERT_GRP_LINKS_BKMRK_MNU_ITM_DEL_HEAD,Y.RIBBON_TAB_INSERT_GRP_LINKS_BKMRK_MNU_ITM_DEL_DESC);
G("mnuItemEditBookmark",Y.RIBBON_TAB_INSERT_GRP_LINKS_BKMRK_MNU_ITM_EDIT_HEAD,Y.RIBBON_TAB_INSERT_GRP_LINKS_BKMRK_MNU_ITM_EDIT_DESC);
G("mnuItemShowBookmarkMarkers",Y.RIBBON_TAB_INSERT_GRP_LINKS_BKMRK_MNU_ITM_SHOW_MRK_HEAD,Y.RIBBON_TAB_INSERT_GRP_LINKS_BKMRK_MNU_ITM_SHOW_MRK_DESC);
M("drpDnBtnInsertHeader",Y.RIBBON_TAB_INSERT_GRP_HDRFTR_BTN_HEADER);
O("ribbonGroupHeadersAndFooters",Y.RIBBON_TAB_INSERT_GRP_HDRFTR_TITLE);
G("mnuItemEditHeader",Y.RIBBON_TAB_INSERT_GRP_HDRFTR_HEADER_MNU_ITM_EDIT_HEAD,Y.RIBBON_TAB_INSERT_GRP_HDRFTR_HEADER_MNU_ITM_EDIT_DESC);
G("mnuItemRemoveHeader",Y.RIBBON_TAB_INSERT_GRP_HDRFTR_HEADER_MNU_ITM_DEL_HEAD,Y.RIBBON_TAB_INSERT_GRP_HDRFTR_HEADER_MNU_ITM_DEL_DESC);
M("drpDnBtnInsertFooter",Y.RIBBON_TAB_INSERT_GRP_HDRFTR_BTN_FOOTER);
G("mnuItemEditFooter",Y.RIBBON_TAB_INSERT_GRP_HDRFTR_FOOTER_MNU_ITM_EDIT_HEAD,Y.RIBBON_TAB_INSERT_GRP_HDRFTR_FOOTER_MNU_ITM_EDIT_DESC);
G("mnuItemRemoveFooter",Y.RIBBON_TAB_INSERT_GRP_HDRFTR_FOOTER_MNU_ITM_DEL_HEAD,Y.RIBBON_TAB_INSERT_GRP_HDRFTR_FOOTER_MNU_ITM_DEL_DESC);
M("drpDnBtnInsertPageNum",Y.RIBBON_TAB_INSERT_GRP_HDRFTR_BTN_PG_NUM);
G("mnuItemInsertPageNum",Y.RIBBON_TAB_INSERT_GRP_HDRFTR_PG_NUM_MNU_ITM_INS_HEAD,Y.RIBBON_TAB_INSERT_GRP_HDRFTR_PG_NUM_MNU_ITM_INS_DESC);
G("mnuItemPageNumRemove",Y.RIBBON_TAB_INSERT_GRP_HDRFTR_PG_NUM_MNU_ITM_DEL_HEAD,Y.RIBBON_TAB_INSERT_GRP_HDRFTR_PG_NUM_MNU_ITM_DEL_DESC);
O("ribbonGroupText",Y.RIBBON_TAB_INSERT_GRP_TEXT_TITLE);
M("drpDnBtnInsertTextFrame",Y.RIBBON_TAB_INSERT_GRP_TEXT_BTN_TEXT_FRAME);
G("mnuItemInsertTextFrame",Y.RIBBON_TAB_INSERT_GRP_TEXT_TEXTFRAME_MNU_ITM_INS_HEAD,Y.RIBBON_TAB_INSERT_GRP_TEXT_TEXTFRAME_MNU_ITM_INS_DESC);
G("mnuItemShowTextFrameMarkerLines",Y.RIBBON_TAB_INSERT_GRP_TEXT_TEXTFRAME_MNU_ITM_SHOW_MRK_HEAD,Y.RIBBON_TAB_INSERT_GRP_TEXT_TEXTFRAME_MNU_ITM_SHOW_MRK_DESC);
M("btnInsertFile",Y.RIBBON_TAB_INSERT_GRP_TEXT_BTN_FILE);
O("ribbonGroupSymbols",Y.RIBBON_TAB_INSERT_GRP_SYMB_TITLE);
M("drpDnBtnInsertSymbol",Y.RIBBON_TAB_INSERT_GRP_SYMB_BTN_SYMBOL);
I("mnuItemMoreSymbols",Y.RIBBON_TAB_INSERT_GRP_SYMB_MNU_ITM_MORE_SYMBOLS);
}function L(Y){O("ribbonGroupPageSetup",Y.RIBBON_TAB_PAGE_LAYOUT_GRP_SETUP_TITLE);
M("btnPageSettings",Y.RIBBON_TAB_PAGE_LAYOUT_GRP_SETUP_BTN_MRG_PAP);
M("drpDnBtnPageOrientation",Y.RIBBON_TAB_PAGE_LAYOUT_GRP_SETUP_BTN_ORIENT);
G("mnuItemPortrait",Y.RIBBON_TAB_PAGE_LAYOUT_GRP_SETUP_ORIENT_MNU_ITM_PORT_HEAD,Y.RIBBON_TAB_PAGE_LAYOUT_GRP_SETUP_ORIENT_MNU_ITM_PORT_DESC);
G("mnuItemLandscape",Y.RIBBON_TAB_PAGE_LAYOUT_GRP_SETUP_ORIENT_MNU_ITM_LANDSC_HEAD,Y.RIBBON_TAB_PAGE_LAYOUT_GRP_SETUP_ORIENT_MNU_ITM_LANDSC_DESC);
M("drpDnBtnPageColumns",Y.RIBBON_TAB_PAGE_LAYOUT_GRP_SETUP_BTN_COLS);
G("mnuItemOneColumn",Y.RIBBON_TAB_PAGE_LAYOUT_GRP_SETUP_COLS_MNU_ITM_ONE_HEAD,Y.RIBBON_TAB_PAGE_LAYOUT_GRP_SETUP_COLS_MNU_ITM_ONE_DESC);
G("mnuItemTwoColumns",Y.RIBBON_TAB_PAGE_LAYOUT_GRP_SETUP_COLS_MNU_ITM_TWO_HEAD,Y.RIBBON_TAB_PAGE_LAYOUT_GRP_SETUP_COLS_MNU_ITM_TWO_DESC);
G("mnuItemThreeColumns",Y.RIBBON_TAB_PAGE_LAYOUT_GRP_SETUP_COLS_MNU_ITM_THREE_HEAD,Y.RIBBON_TAB_PAGE_LAYOUT_GRP_SETUP_COLS_MNU_ITM_THREE_DESC);
G("mnuItemMoreColumns",Y.RIBBON_TAB_PAGE_LAYOUT_GRP_SETUP_COLS_MNU_ITM_MORE_HEAD,Y.RIBBON_TAB_PAGE_LAYOUT_GRP_SETUP_COLS_MNU_ITM_MORE_DESC);
M("drpDnBtnPageBreaks",Y.RIBBON_TAB_PAGE_LAYOUT_GRP_SETUP_BTN_BREAKS);
J("mnuItemPageBreakPage",Y.RIBBON_TAB_PAGE_LAYOUT_GRP_SETUP_BREAKS_MNU_HDR_PAGE_BREAKS);
I("mnuItemPageBreakPage",Y.RIBBON_TAB_PAGE_LAYOUT_GRP_SETUP_BREAKS_MNU_ITM_PAGE);
I("mnuItemPageBreakColumn",Y.RIBBON_TAB_PAGE_LAYOUT_GRP_SETUP_BREAKS_MNU_ITM_COL);
I("mnuItemPageBreakTextWrap",Y.RIBBON_TAB_PAGE_LAYOUT_GRP_SETUP_BREAKS_MNU_ITM_TXT_WRAP);
J("mnuItemSectionBreakPage",Y.RIBBON_TAB_PAGE_LAYOUT_GRP_SETUP_BREAKS_MNU_HDR_SECT_BREAKS);
I("mnuItemSectionBreakPage",Y.RIBBON_TAB_PAGE_LAYOUT_GRP_SETUP_BREAKS_MNU_ITM_NEXT_PAGE);
I("mnuItemSectionBreakCont",Y.RIBBON_TAB_PAGE_LAYOUT_GRP_SETUP_BREAKS_MNU_ITM_CONT);
M("btnsPageBorders",Y.RIBBON_TAB_PAGE_LAYOUT_GRP_SETUP_BTN_PAGE_BRDS);
}function H(Y){O("ribbonGroupDataSource",Y.RIBBON_TAB_MAILINGS_GRP_DATA_SRC_TITLE);
M("btnLoadDBScheme",Y.RIBBON_TAB_MAILINGS_GRP_DATA_SRC_BTN_LOAD_DB);
M("drpDnBtnSelectMasterTable",Y.RIBBON_TAB_MAILINGS_GRP_DATA_SRC_BTN_SEL_MSTR_TBL);
M("btnEditDataRelations",Y.RIBBON_TAB_MAILINGS_GRP_DATA_SRC_BTN_EDIT_DATA_RELS);
O("ribbonGroupMergeField",Y.RIBBON_TAB_MAILINGS_GRP_MRG_FLD_TITLE);
M("drpDnBtnInsertMergeField",Y.RIBBON_TAB_MAILINGS_GRP_MRG_FLD_BTN_INS,Y.RIBBON_TAB_MAILINGS_GRP_MRG_FLD_BTN_INS_TOOLTIP);
G("mnuItemInsertMergeField",Y.RIBBON_TAB_MAILINGS_GRP_MRG_FLD_MNU_ITM_CUSTOM_HEAD,Y.RIBBON_TAB_MAILINGS_GRP_MRG_FLD_MNU_ITM_CUSTOM_DESC);
G("mnuItemHighlightMergeFields",Y.RIBBON_TAB_MAILINGS_GRP_MRG_FLD_MNU_ITM_HIGHLIGHT_HEAD,Y.RIBBON_TAB_MAILINGS_GRP_MRG_FLD_MNU_ITM_HIGHLIGHT_DESC);
M("drpDnBtnInsertSpecialField",Y.RIBBON_TAB_MAILINGS_GRP_MRG_FLD_BTN_INS_SPEC);
G("mnuItemInsertIFField",Y.RIBBON_TAB_MAILINGS_GRP_MRG_FLD_SPEC_MNU_ITM_IF_HEAD,Y.RIBBON_TAB_MAILINGS_GRP_MRG_FLD_SPEC_MNU_ITM_IF_DESC);
G("mnuItemInsertInclTxtField",Y.RIBBON_TAB_MAILINGS_GRP_MRG_FLD_SPEC_MNU_ITM_INCLTXT_HEAD,Y.RIBBON_TAB_MAILINGS_GRP_MRG_FLD_SPEC_MNU_ITM_INCLTXT_DESC);
G("mnuItemInsertDateField",Y.RIBBON_TAB_MAILINGS_GRP_MRG_FLD_SPEC_MNU_ITM_DATE_HEAD,Y.RIBBON_TAB_MAILINGS_GRP_MRG_FLD_SPEC_MNU_ITM_DATE_DESC);
G("mnuItemInsertNextField",Y.RIBBON_TAB_MAILINGS_GRP_MRG_FLD_SPEC_MNU_ITM_NEXT_HEAD,Y.RIBBON_TAB_MAILINGS_GRP_MRG_FLD_SPEC_MNU_ITM_NEXT_DESC);
G("mnuItemInsertNextIfField",Y.RIBBON_TAB_MAILINGS_GRP_MRG_FLD_SPEC_MNU_ITM_NEXTIF_HEAD,Y.RIBBON_TAB_MAILINGS_GRP_MRG_FLD_SPEC_MNU_ITM_NEXTIF_DESC);
M("btnFieldProperties",Y.RIBBON_TAB_MAILINGS_GRP_MRG_FLD_BTN_PROPS);
M("btnDeleteField",Y.RIBBON_TAB_MAILINGS_GRP_MRG_FLD_BTN_DEL);
O("ribbonGroupMergeBlock",Y.RIBBON_TAB_MAILINGS_GRP_MRG_BLOCK_TITLE);
M("drpDnBtnInsertMergeBlock",Y.RIBBON_TAB_MAILINGS_GRP_MRG_BLOCK_BTN_INS,Y.RIBBON_TAB_MAILINGS_GRP_MRG_BLOCK_BTN_INS_TOOLTIP);
G("mnuItemInsertMergeBlock",Y.RIBBON_TAB_MAILINGS_GRP_MRG_BLOCK_MNU_ITM_CUST_HEAD,Y.RIBBON_TAB_MAILINGS_GRP_MRG_BLOCK_MNU_ITM_CUST_DESC);
G("mnuItemHighlightMergeBlocks",Y.RIBBON_TAB_MAILINGS_GRP_MRG_BLOCK_MNU_ITM_HIGHLIGHT_HEAD,Y.RIBBON_TAB_MAILINGS_GRP_MRG_BLOCK_MNU_ITM_HIGHLIGHT_DESC);
M("btnEditMergeBlocks",Y.RIBBON_TAB_MAILINGS_GRP_MRG_BLOCK_BTN_EDIT);
O("ribbonGroupView",Y.RIBBON_TAB_MAILINGS_GRP_VIEW_TITLE);
M("tglBtnShowFieldCodes",Y.RIBBON_TAB_MAILINGS_GRP_VIEW_BTN_SHOW_CODES);
M("tglBtnShowFieldText",Y.RIBBON_TAB_MAILINGS_GRP_VIEW_BTN_SHOW_TEXT);
O("ribbonGroupMailMergePreview",Y.RIBBON_TAB_MAILINGS_GRP_PREV_TITLE);
M("tglBtnPreviewMergeResults",Y.RIBBON_TAB_MAILINGS_GRP_PREV_BTN_PREV);
O("ribbonGroupMailMergeFinish",Y.RIBBON_TAB_MAILINGS_GRP_FINISH_TITLE);
M("btnFinishAndMerge",Y.RIBBON_TAB_MAILINGS_GRP_FINISH_BTN_FINISH);
O("ribbonGroupPreviewNav",Y.RIBBON_TAB_MAILINGS_GRP_NAV_TITLE);
M("btnFirstRecord",Y.RIBBON_TAB_MAILINGS_GRP_NAV_BTN_FIRST);
M("btnPrevRecord",Y.RIBBON_TAB_MAILINGS_GRP_NAV_BTN_PREV);
M("btnNextRecord",Y.RIBBON_TAB_MAILINGS_GRP_NAV_BTN_NEXT);
M("btnLastRecord",Y.RIBBON_TAB_MAILINGS_GRP_NAV_BTN_LAST);
}function T(Y){O("ribbonGroupZoom",Y.RIBBON_TAB_VIEW_GRP_ZOOM_TITLE);
M("drpDnBtnZoom",Y.RIBBON_TAB_VIEW_GRP_ZOOM_BTN_ZOOM);
M("btnZoom100",Y.RIBBON_TAB_VIEW_GRP_ZOOM_BTN_ZOOM_100);
M("btnZoomPageWidth",Y.RIBBON_TAB_VIEW_GRP_ZOOM_BTN_ZOOM_PAGE_WIDTH);
M("btnZoomPageHeight",Y.RIBBON_TAB_VIEW_GRP_ZOOM_BTN_ZOOM_PAGE_HEIGHT);
O("ribbonGroupShow",Y.RIBBON_TAB_VIEW_GRP_SHOW_TITLE);
F("chkRulerHor",Y.RIBBON_TAB_VIEW_GRP_SHOW_CHK_HOR_RULER);
F("chkRulerVert",Y.RIBBON_TAB_VIEW_GRP_SHOW_CHK_VERT_RULER);
F("chkStatusBar",Y.RIBBON_TAB_VIEW_GRP_SHOW_CHK_STATUSBAR);
O("ribbonGroupProofing",Y.RIBBON_TAB_VIEW_GRP_PROOF_TITLE);
M("btnSpelling",Y.RIBBON_TAB_VIEW_GRP_PROOF_BTN_SPELLING);
M("tglBtnEnableSpellCheck",Y.RIBBON_TAB_VIEW_GRP_PROOF_BTN_ENABLE_SPELL_CHECK);
M("tglBtnEnableLangDetect",Y.RIBBON_TAB_VIEW_GRP_PROOF_BTN_ENABLE_LANG_DETECT);
M("btnLoadDictionary",Y.RIBBON_TAB_VIEW_GRP_PROOF_BTN_LOAD_DICT);
M("tglBtnEnableHyphenation",Y.RIBBON_TAB_VIEW_GRP_PROOF_BTN_ENABLE_HYPH);
M("btnSetLanguage",Y.RIBBON_TAB_VIEW_GRP_PROOF_BTN_SET_LANG);
}function S(Y){O("ribbonGroupTblLayoutTable",Y.RIBBON_TAB_TBL_LAYOUT_GRP_TABLE_TITLE);
M("drpDnBtnTableSelect",Y.RIBBON_TAB_TBL_LAYOUT_GRP_TABLE_BTN_SEL);
G("mnuItemSelectTableCell",Y.RIBBON_TAB_TBL_LAYOUT_GRP_TABLE_SEL_MNU_ITM_CELL_HEAD,Y.RIBBON_TAB_TBL_LAYOUT_GRP_TABLE_SEL_MNU_ITM_CELL_DESC);
G("mnuItemSelectTableColumn",Y.RIBBON_TAB_TBL_LAYOUT_GRP_TABLE_SEL_MNU_ITM_COL_HEAD,Y.RIBBON_TAB_TBL_LAYOUT_GRP_TABLE_SEL_MNU_ITM_COL_DESC);
G("mnuItemSelectTableRow",Y.RIBBON_TAB_TBL_LAYOUT_GRP_TABLE_SEL_MNU_ITM_ROW_HEAD,Y.RIBBON_TAB_TBL_LAYOUT_GRP_TABLE_SEL_MNU_ITM_ROW_DESC);
G("mnuItemSelectTable",Y.RIBBON_TAB_TBL_LAYOUT_GRP_TABLE_SEL_MNU_ITM_TABLE_HEAD,Y.RIBBON_TAB_TBL_LAYOUT_GRP_TABLE_SEL_MNU_ITM_TABLE_DESC);
M("tglBtnViewGridLines",Y.RIBBON_TAB_TBL_LAYOUT_GRP_TABLE_BTN_VIEW_GRIDLINES);
M("btnTableProperties",Y.RIBBON_TAB_TBL_LAYOUT_GRP_TABLE_BTN_PROPS);
O("ribbonGroupTblLayoutRowsCols",Y.RIBBON_TAB_TBL_LAYOUT_GRP_ROWCOL_TITLE);
M("drpDnBtnTableDelete",Y.RIBBON_TAB_TBL_LAYOUT_GRP_ROWCOL_BTN_DEL);
G("mnuItemDeleteTableCells",Y.RIBBON_TAB_TBL_LAYOUT_GRP_ROWCOL_DEL_MNU_ITM_CELLS_HEAD,Y.RIBBON_TAB_TBL_LAYOUT_GRP_ROWCOL_DEL_MNU_ITM_CELLS_DESC);
R("mnuItemMoveCellsToLeft",Y.RIBBON_TAB_TBL_LAYOUT_GRP_ROWCOL_DEL_CELL_MNU_ITM_MOVE_LEFT);
R("mnuItemDeleteWholeRow",Y.RIBBON_TAB_TBL_LAYOUT_GRP_ROWCOL_DEL_CELL_MNU_ITM_DEL_ROW);
R("mnuItemDeleteWholeColumn",Y.RIBBON_TAB_TBL_LAYOUT_GRP_ROWCOL_DEL_CELL_MNU_ITM_DEL_COL);
G("mnuItemDeleteTableColumns",Y.RIBBON_TAB_TBL_LAYOUT_GRP_ROWCOL_DEL_MNU_ITM_COLS_HEAD,Y.RIBBON_TAB_TBL_LAYOUT_GRP_ROWCOL_DEL_MNU_ITM_COLS_DESC);
G("mnuItemDeleteTableRows",Y.RIBBON_TAB_TBL_LAYOUT_GRP_ROWCOL_DEL_MNU_ITM_ROWS_HEAD,Y.RIBBON_TAB_TBL_LAYOUT_GRP_ROWCOL_DEL_MNU_ITM_ROWS_DESC);
G("mnuItemDeleteTable",Y.RIBBON_TAB_TBL_LAYOUT_GRP_ROWCOL_DEL_MNU_ITM_TABLE_HEAD,Y.RIBBON_TAB_TBL_LAYOUT_GRP_ROWCOL_DEL_MNU_ITM_TABLE_DESC);
M("btnInsTblRowAbove",Y.RIBBON_TAB_TBL_LAYOUT_GRP_ROWCOL_BTN_INS_ABOVE);
M("btnInsTblRowBelow",Y.RIBBON_TAB_TBL_LAYOUT_GRP_ROWCOL_BTN_INS_BELOW);
M("btnInsTblColLeft",Y.RIBBON_TAB_TBL_LAYOUT_GRP_ROWCOL_BTN_INS_LEFT);
M("btnInsTblColRight",Y.RIBBON_TAB_TBL_LAYOUT_GRP_ROWCOL_BTN_INS_RIGHT);
O("ribbonGroupTblLayoutMerge",Y.RIBBON_TAB_TBL_LAYOUT_GRP_MERGE_TITLE);
M("btnMergeCells",Y.RIBBON_TAB_TBL_LAYOUT_GRP_MERGE_BTN_MERGE_CELLS);
M("btnSplitCells",Y.RIBBON_TAB_TBL_LAYOUT_GRP_MERGE_BTN_SPLIT_CELLS);
M("drpDnBtnSplitTable",Y.RIBBON_TAB_TBL_LAYOUT_GRP_MERGE_BTN_SPLIT_TBL);
G("mnuItemTableSplitAbove",Y.RIBBON_TAB_TBL_LAYOUT_GRP_MERGE_SPLIT_TABLE_MNU_ITM_ABOVE_HEAD,Y.RIBBON_TAB_TBL_LAYOUT_GRP_MERGE_SPLIT_TABLE_MNU_ITM_ABOVE_DESC);
G("mnuItemTableSplitBelow",Y.RIBBON_TAB_TBL_LAYOUT_GRP_MERGE_SPLIT_TABLE_MNU_ITM_BELOW_HEAD,Y.RIBBON_TAB_TBL_LAYOUT_GRP_MERGE_SPLIT_TABLE_MNU_ITM_BELOW_DESC);
O("ribbonGroupTblLayoutAlignment",Y.RIBBON_TAB_TBL_LAYOUT_GRP_ALIGN_TITLE);
N("tglBtnCellAlignTopLeft",Y.RIBBON_TAB_TBL_LAYOUT_GRP_ALIGN_BTN_TOP_LEFT);
N("tglBtnCellAlignTopCenter",Y.RIBBON_TAB_TBL_LAYOUT_GRP_ALIGN_BTN_TOP_CENTER);
N("tglBtnCellAlignTopRight",Y.RIBBON_TAB_TBL_LAYOUT_GRP_ALIGN_BTN_TOP_RIGHT);
N("tglBtnCellAlignTopJustify",Y.RIBBON_TAB_TBL_LAYOUT_GRP_ALIGN_BTN_TOP_JUST);
N("tglBtnCellAlignMiddleLeft",Y.RIBBON_TAB_TBL_LAYOUT_GRP_ALIGN_BTN_MID_LEFT);
N("tglBtnCellAlignMiddleCenter",Y.RIBBON_TAB_TBL_LAYOUT_GRP_ALIGN_BTN_MID_CENTER);
N("tglBtnCellAlignMiddleRight",Y.RIBBON_TAB_TBL_LAYOUT_GRP_ALIGN_BTN_MID_RIGHT);
N("tglBtnCellAlignMiddleJustify",Y.RIBBON_TAB_TBL_LAYOUT_GRP_ALIGN_BTN_MID_JUST);
N("tglBtnCellAlignBottomLeft",Y.RIBBON_TAB_TBL_LAYOUT_GRP_ALIGN_BTN_BOT_LEFT);
N("tglBtnCellAlignBottomCenter",Y.RIBBON_TAB_TBL_LAYOUT_GRP_ALIGN_BTN_BOT_CENTER);
N("tglBtnCellAlignBottomRight",Y.RIBBON_TAB_TBL_LAYOUT_GRP_ALIGN_BTN_BOT_RIGHT);
N("tglBtnCellAlignBottomJustify",Y.RIBBON_TAB_TBL_LAYOUT_GRP_ALIGN_BTN_BOT_JUST);
}function K(Y){O("ribbonGroupObjectFormat",Y.RIBBON_TAB_OBJ_FMT_GRP_FORMAT_TITLE);
M("drpDnBtnObjectProperties",Y.RIBBON_TAB_OBJ_FMT_GRP_FORMAT_BTN_OBJ_PROPS);
G("mnuItemObjAttrs",Y.RIBBON_TAB_OBJ_FMT_GRP_FORMAT_PROP_MNU_ITM_OBJ_ATTRS_HEAD,Y.RIBBON_TAB_OBJ_FMT_GRP_FORMAT_PROP_MNU_ITM_OBJ_ATTRS_DESC);
G("mnuItemObjName",Y.RIBBON_TAB_OBJ_FMT_GRP_FORMAT_PROP_MNU_ITM_OBJ_NAME_HEAD,Y.RIBBON_TAB_OBJ_FMT_GRP_FORMAT_PROP_MNU_ITM_OBJ_NAME_DESC);
G("mnuItemObjID",Y.RIBBON_TAB_OBJ_FMT_GRP_FORMAT_PROP_MNU_ITM_OBJ_ID_HEAD,Y.RIBBON_TAB_OBJ_FMT_GRP_FORMAT_PROP_MNU_ITM_OBJ_ID_DESC);
O("ribbonGroupObjectArrange",Y.RIBBON_TAB_OBJ_FMT_GRP_ARR_TITLE);
M("drpDnBtnObjectPosition",Y.RIBBON_TAB_OBJ_FMT_GRP_ARR_BTN_POS);
G("mnnuItemObjPosLeft",Y.RIBBON_TAB_OBJ_FMT_GRP_ARR_POS_MNU_ITM_LEFT_HEAD,Y.RIBBON_TAB_OBJ_FMT_GRP_ARR_POS_MNU_ITM_LEFT_DESC);
G("mnuItemObjPosCenter",Y.RIBBON_TAB_OBJ_FMT_GRP_ARR_POS_MNU_ITM_CENTER_HEAD,Y.RIBBON_TAB_OBJ_FMT_GRP_ARR_POS_MNU_ITM_CENTER_DESC);
G("mnuItemObjPosRight",Y.RIBBON_TAB_OBJ_FMT_GRP_ARR_POS_MNU_ITM_RIGHT_HEAD,Y.RIBBON_TAB_OBJ_FMT_GRP_ARR_POS_MNU_ITM_RIGHT_DESC);
M("drpDnBtnSendToBack",Y.RIBBON_TAB_OBJ_FMT_GRP_ARR_BTN_SEND_BACK);
G("mnuItemObjSendToBack",Y.RIBBON_TAB_OBJ_FMT_GRP_ARR_SEND_BACK_MNU_ITM_SEND_BACK_HEAD,Y.RIBBON_TAB_OBJ_FMT_GRP_ARR_SEND_BACK_MNU_ITM_SEND_BACK_DESC);
G("mnuItemObjSendBackward",Y.RIBBON_TAB_OBJ_FMT_GRP_ARR_SEND_BACK_MNU_ITM_SEND_BACKW_HEAD,Y.RIBBON_TAB_OBJ_FMT_GRP_ARR_SEND_BACK_MNU_ITM_SEND_BACKW_DESC);
G("mnuItemObjSendBehindText",Y.RIBBON_TAB_OBJ_FMT_GRP_ARR_SEND_BACK_MNU_ITM_SEND_BEH_TXT_HEAD,Y.RIBBON_TAB_OBJ_FMT_GRP_ARR_SEND_BACK_MNU_ITM_SEND_BEH_TXT_DESC);
M("drpDnBtnBringToFront",Y.RIBBON_TAB_OBJ_FMT_GRP_ARR_BTN_BRING_FRONT);
G("mnuItemObjBringToFront",Y.RIBBON_TAB_OBJ_FMT_GRP_ARR_BRING_FRONT_MNU_ITM_BRING_FRONT_HEAD,Y.RIBBON_TAB_OBJ_FMT_GRP_ARR_BRING_FRONT_MNU_ITM_BRING_FRONT_DESC);
G("mnuItemObjBringForward",Y.RIBBON_TAB_OBJ_FMT_GRP_ARR_BRING_FRONT_MNU_ITM_BRING_FORW_HEAD,Y.RIBBON_TAB_OBJ_FMT_GRP_ARR_BRING_FRONT_MNU_ITM_BRING_FORW_DESC);
G("mnuItemObjBringInFrontOfText",Y.RIBBON_TAB_OBJ_FMT_GRP_ARR_BRING_FRONT_MNU_ITM_BRING_IN_FRNT_HEAD,Y.RIBBON_TAB_OBJ_FMT_GRP_ARR_BRING_FRONT_MNU_ITM_BRING_IN_FRNT_DESC);
M("drpDnBtnWrapText",Y.RIBBON_TAB_OBJ_FMT_GRP_ARR_BTN_WRAP_TEXT);
G("mnuItemObjInLineWithText",Y.RIBBON_TAB_OBJ_FMT_GRP_ARR_WRAP_TXT_MNU_ITM_INLINE_HEAD,Y.RIBBON_TAB_OBJ_FMT_GRP_ARR_WRAP_TXT_MNU_ITM_INLINE_DESC);
G("mnuItemObjTopAndBottom",Y.RIBBON_TAB_OBJ_FMT_GRP_ARR_WRAP_TXT_MNU_ITM_TOP_BOT_HEAD,Y.RIBBON_TAB_OBJ_FMT_GRP_ARR_WRAP_TXT_MNU_ITM_TOP_BOT_DESC);
G("mnuItemObjSquare",Y.RIBBON_TAB_OBJ_FMT_GRP_ARR_WRAP_TXT_MNU_ITM_SQUARE_HEAD,Y.RIBBON_TAB_OBJ_FMT_GRP_ARR_WRAP_TXT_MNU_ITM_SQUARE_DESC);
G("mnuItemObjBehindText",Y.RIBBON_TAB_OBJ_FMT_GRP_ARR_WRAP_TXT_MNU_ITM_BEH_TXT_HEAD,Y.RIBBON_TAB_OBJ_FMT_GRP_ARR_WRAP_TXT_MNU_ITM_BEH_TXT_DESC);
G("mnuItemObjInFrontOfText",Y.RIBBON_TAB_OBJ_FMT_GRP_ARR_WRAP_TXT_MNU_ITM_IN_FRONT_HEAD,Y.RIBBON_TAB_OBJ_FMT_GRP_ARR_WRAP_TXT_MNU_ITM_IN_FRONT_DESC);
}function Q(Y){O("ribbonGroupShapeStyles",Y.RIBBON_TAB_SHAPE_FMT_GRP_STYLES_TITLE);
M("drpDnBtnShapeStyles",Y.RIBBON_TAB_SHAPE_FMT_GRP_STYLES_BTN_STYLES);
M("drpDnBtnShapeFill",Y.RIBBON_TAB_SHAPE_FMT_GRP_STYLES_BTN_FILL);
M("drpDnBtnShapeOutline",Y.RIBBON_TAB_SHAPE_FMT_GRP_STYLES_BTN_OUTLINE);
I("mnuItmShapeFillNone",Y.RIBBON_TAB_SHP_FMT_GRP_STYLES_MNU_ITM_NO_FILL);
I("mnuItmShapeOutlNone",Y.RIBBON_TAB_SHP_FMT_GRP_STYLES_MNU_ITM_NO_OUTL);
I("mnuItmShapeOutlWeight",Y.RIBBON_TAB_SHP_FMT_GRP_STYLES_MNU_ITM_WEIGHT);
I("mnuItmShapeOutlWeight025",Y.RIBBON_TAB_SHP_FMT_GRP_STYLES_MNU_ITM_WEIGHT025);
I("mnuItmShapeOutlWeight050",Y.RIBBON_TAB_SHP_FMT_GRP_STYLES_MNU_ITM_WEIGHT050);
I("mnuItmShapeOutlWeight075",Y.RIBBON_TAB_SHP_FMT_GRP_STYLES_MNU_ITM_WEIGHT075);
I("mnuItmShapeOutlWeight100",Y.RIBBON_TAB_SHP_FMT_GRP_STYLES_MNU_ITM_WEIGHT100);
I("mnuItmShapeOutlWeight150",Y.RIBBON_TAB_SHP_FMT_GRP_STYLES_MNU_ITM_WEIGHT150);
I("mnuItmShapeOutlWeight225",Y.RIBBON_TAB_SHP_FMT_GRP_STYLES_MNU_ITM_WEIGHT225);
I("mnuItmShapeOutlWeight300",Y.RIBBON_TAB_SHP_FMT_GRP_STYLES_MNU_ITM_WEIGHT300);
I("mnuItmShapeOutlWeight450",Y.RIBBON_TAB_SHP_FMT_GRP_STYLES_MNU_ITM_WEIGHT450);
I("mnuItmShapeOutlWeight600",Y.RIBBON_TAB_SHP_FMT_GRP_STYLES_MNU_ITM_WEIGHT600);
}function P(Y){D(Y);
E(Y);
L(Y);
H(Y);
T(Y);
S(Y);
K(Y);
Q(Y);
}b.setRibbonStrings=function(){var ad=b.ribbonStringResources;
for(var ac in ad){if(ad.hasOwnProperty(ac)){if(typeof ad[ac]==="string"){ad[ac]=ad[ac].replace(/\r?\n/g,"<br />");
}}}var Z=document.getElementById("tabFile");
Z.textContent=ad.RIBBON_MNU_FILE_TITLE;
Z=document.getElementById("tabDefault");
Z.textContent=ad.RIBBON_TAB_HOME_TITLE;
Z=document.getElementById("tabInsert");
Z.textContent=ad.RIBBON_TAB_INSERT_TITLE;
Z=document.getElementById("tabPageLayout");
Z.textContent=ad.RIBBON_TAB_PAGE_LAYOUT_TITLE;
Z=document.getElementById("tabMailings");
Z.textContent=ad.RIBBON_TAB_MAILINGS_TITLE;
Z=document.getElementById("tabView");
Z.textContent=ad.RIBBON_TAB_VIEW_TITLE;
Z=document.getElementById("tabTableLayout");
Z.textContent=ad.RIBBON_TAB_TBL_LAYOUT_TITLE;
Z=document.getElementById("tabObjectFormat");
Z.textContent=ad.RIBBON_TAB_OBJ_FMT_TITLE;
Z=document.getElementById("tabShapeFormat");
Z.textContent=ad.RIBBON_TAB_SHAPE_FMT_TITLE;
var ab=document.getElementById("tabFile");
ab.textContent=ad.RIBBON_MNU_FILE_TITLE;
C("fileMnuItemNew",ad.RIBBON_MNU_FILE_NEW);
C("fileMnuItemOpen",ad.RIBBON_MNU_FILE_OPEN);
C("fileMnuItemSave",ad.RIBBON_MNU_FILE_SAVE);
C("fileMnuItemSaveAs",ad.RIBBON_MNU_FILE_SAVE_AS);
C("fileMnuItemPrintToPDF",ad.RIBBON_MNU_FILE_PRINT);
C("fileMnuItemOptions",ad.RIBBON_MNU_FILE_OPTIONS);
P(ad);
delete b.ribbonStringResources;
var aa=document.getElementById("txRibbonCover");
aa.style.opacity="0";
setTimeout(function(){aa.parentElement.removeChild(aa);
},1000);
b.updateRibbonScrollArrows();
b.fireEvent(b.EventName.ribbonTabsLoaded);
b.ribbonTabsLoaded=true;
if(b.enableAffectedByEditModeWhenTabsLoaded){var Y=(b.editModeCur==b.EditMode.Edit);
h(Y);
}d();
};
b.showRibbonBar=function(Y){if(b.isRibbonVisible==Y){return;
}var aa=document.getElementById("ribbonbar");
var Z=document.querySelector("#ribbonbar ul.tabs");
if(!Y){m={menuBackground:Z.style.background,ribbonBarOverflow:aa.style.overflow,ribbonBarHeight:b.RibbonBarHeight};
Z.style.background="white";
aa.style.overflow="hidden";
aa.style.height=Z.clientHeight+"px";
b.RibbonBarHeight=Z.clientHeight;
a("#txArrowRibbonHideWrapper").addClass("down");
b.isRibbonVisible=false;
}else{if(m!=null){Z.style.background=m.menuBackground;
aa.style.overflow=m.ribbonBarOverflow;
aa.style.height=m.ribbonBarHeight+"px";
b.RibbonBarHeight=m.ribbonBarHeight;
a("#txArrowRibbonHideWrapper").removeClass("down");
b.isRibbonVisible=true;
}}b.resetRibbonTabContentPos();
b.adaptViewToContainerSize();
};
b.hideAllOtherMenus=function(){b.hideAllMenus_homeTab();
b.hideAllMenus_insertTab();
b.hideAllMenus_pageLayoutTab();
b.hideAllMenus_mailingsTab();
b.hideAllMenus_viewTab();
b.hideAllMenus_tableLayoutTab();
b.hideAllMenus_ObjectFormatTab();
b.hideAllMenus_ShapeFormatTab();
};
return W;
}(TXTextControl||{},j$1_10_2));
var TXTextControl=(function(e,a){var c=e._private=e._private||{};
c.secretAPIEnabled=false;
c.saveDocumentCallbacks=[];
c.saveSelectionCallbacks=[];
c.SelectionCommand=Object.freeze({GetStartAndLength:0,SetStartAndLength:1,Load:2,GetText:3,Save:4});
c.TextPartType=Object.freeze({Auto:0,MainText:1,HeaderFooter:2,TextFrame:3});
var d=Object.freeze({NoStreamType:"No TXTextControl stream type given.",NoDocumentData:"No document data given.",TooFewParameters:"Wrong number of parameters.",CallBackIsNoFunction:'Parameter "callback" must be of type "function".'});
var b=true;
e.streamType=Object.freeze(c.TXStreamType);
e.loadDocument=function(g,f){if(!g){throw Error(d.NoStreamType);
}if(!f){throw Error(d.NoDocumentData);
}c.sendCommand(c.Command.OpenFile,c.FileType.Document,g,1,f);
};
e.saveDocument=function(g,f){if(!g){throw Error(d.NoStreamType);
}if(!f){throw Error(d.TooFewParameters);
}if(typeof f!=="function"){throw TypeError(d.CallBackIsNoFunction);
}c.saveDocumentCallbacks.push(f);
c.sendCommand(c.Command.SaveDocumentFile,g,-1);
};
e.loadSelection=function(h,f){if(!h){throw Error(d.NoStreamType);
}if(!f){throw Error(d.NoDocumentData);
}var g={TextPartType:c.TextPartType.Auto,TextPartIndex:0,DocData:f};
c.sendCommand(c.Command.ClientSelection,c.SelectionCommand.Load,h,-1,g);
};
e.saveSelection=function(g,f){if(!g){throw Error(d.NoStreamType);
}if(!f){throw Error(d.TooFewParameters);
}if(typeof f!=="function"){throw TypeError(d.CallBackIsNoFunction);
}c.saveSelectionCallbacks.push(f);
var h={TextPartType:c.TextPartType.Auto,TextPartIndex:0};
c.sendCommand(c.Command.ClientSelection,c.SelectionCommand.Save,g,0,h);
};
Object.defineProperty(e,"isLoadingDialogEnabled",{get:function(){return b;
},set:function(f){if(typeof f!=="boolean"){return;
}b=f;
c.sendCommand(c.Command.EnableLoadWaitDialog,f?1:0);
},enumerable:true});
e.focus=function(){if(c.textViewer){c.textViewer.focus();
}};
e.resetContents=function(){c.sendCommand(c.Command.ResetContents);
};
e.showVerticalRuler=c.showVerticalRuler;
e.showHorizontalRuler=c.showHorizontalRuler;
e.showStatusBar=c.showStatusBar;
e.showRibbonBar=c.showRibbonBar;
e.enableCommands=function(f){if(c.secretAPIEnabled){return;
}e.sendCommand=c.sendCommand;
e.Command=c.Command;
e.VisualElement=c.VisualElement;
e.ItemType=c.ItemType;
e.DialogCategory=c.DialogCategory;
e.HTMLDialogType=c.HTMLDialogType;
e.TXDialogType=c.TXDialogType;
e.InputFormatProperty=c.InputFormatProperty;
e.BreakType=c.BreakType;
e.BarcodeType=c.BarcodeType;
e.FieldType=c.FieldType;
e.insertMergeField=c.insertMergeField;
e.insertMergeBlock=c.insertMergeBlock;
e.FrameInsertionMode=c.FrameInsertionMode;
e.FrameProperty=c.FrameProperty;
e.ZOrder=c.ZOrder;
e.VerticalAlignment=c.VerticalAlignment;
e.HorizontalAlignment=c.HorizontalAlignment;
e.SectionFormatDialogTab=c.SectionFormatDialogTab;
e.TableCommand=c.TableCommand;
e.TableElement=c.TableElement;
e.MailMergeNavButton=c.MailMergeNavButton;
e.ComponentType=c.ComponentType;
e.ActivationState=c.ActivationState;
e.EditMode=c.EditMode;
e.FieldDisplayMode=c.FieldDisplayMode;
e.SpellCheckCommand=c.SpellCheckCommand;
if(!f){console.warn("Undocumented TextControl API activated. Use at your own risk.");
}c.secretAPIEnabled=true;
};
return e;
}(TXTextControl||{},j$1_10_2));
